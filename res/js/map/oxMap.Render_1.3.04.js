//oxMap.1.3.03 -- all rights reserved by o'xkape WEBKARTOGRAFIE, 2013-05-04



/*

  OpenLayers.js -- OpenLayers Map Viewer Library

  Copyright (c) 2006-2012 by OpenLayers Contributors
  Published under the 2-clause BSD license.
  See http://openlayers.org/dev/license.txt for the full text of the license, and http://openlayers.org/dev/authors.txt for full list of contributors.

  Includes compressed code under the following licenses:

  (For uncompressed versions of the code used, please see the
  OpenLayers Github repository: <https://github.com/openlayers/openlayers>)

*/

/**
 * Contains XMLHttpRequest.js <http://code.google.com/p/xmlhttprequest/>
 * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 */

/**
 * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is
 * Copyright (c) 2006, Yahoo! Inc.
 * All rights reserved.
 * 
 * Redistribution and use of this software in source and binary forms, with or
 * without modification, are permitted provided that the following conditions
 * are met:
 * 
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * 
 * * Neither the name of Yahoo! Inc. nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission of Yahoo! Inc.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 * POSSIBILITY OF SUCH DAMAGE.
 */

function Error(e,t,n){var r=this,i="en";this.errorTypes={en:{"default":"An unknown error has occurred.",config:"Datas for configuration are missing. Please check whether your datas are correctly loaded.\n\n[oxMap.Config]",module:"Module [%p] do not exists.",base:"Base-Module XX.Base is missing. You can not render oxMap without a base module.\nXX is your WMS, e.g. OSM.Base",map:"A map module is missed. Currently there are the following modules [OSM].",file:"Module is unverifiable.\n\nMissing: oxMap.%p.js",wms:"The map system --%p-- is not defined.",data:"Datas which want displayed are not loaded. Please check whether your datas are correctly integrated.",event:"You have not defined any layer event. By default ONCLICK was set.",custom:"There are no settings for a corporate design map.",filter:"A filter wrapper is failed.\nYou must define a HTML-form with an identifier (ID) and tell it oxMap.Config.filter",route:"Route data are not defined.\nPlease insert route data as GeoJSON."},de:{"default":"Es ist ein unbekannter Fehler aufgetreten.",config:"Konfigurationsdaten für %p fehlen. Bitte prüfen Sie, ob die Daten korrekt geladen werden.\n\n[oxMap.Config]",module:"Das Modul [%p] existiert nicht.",base:"Das Basis-Modul XX.Base fehlt. Ohne dieses ist eine Ausgabe nicht möglich.\nXX ist das entsprechende WMS, z.B. OSM.Base",map:"Es fehlt ein Kartenmodul. Aktuelle Module sind [OSM].",file:"Modul kann nicht verarbeitet werden.\n\nDatei fehlt: oxMap.%p.js",wms:"Das Kartensystem --%p-- ist nicht definiert.",data:"Die darzustellenden Daten konnten nicht geladen werden. Bitte prüfen, ob diese eingebunden wurden.",event:"Es wurde keine Layer-Event definiert. Es wird stattdessen ONCLICK reserviert.",custom:"Die Konfigurationswerte für die Corporate Design Karte fehlen.",filter:"Der Filter wurde nicht festgelegt\nDefinieren Sie ein HTML-Form mit einer ID und teilen es der oxMap.Config.filter mit.",route:"Es wurden keine Daten für die Routenausgabe definiert.\nBitte weisen Sie Routendaten als GeoJSON zu."}};this.reportError=function(e,t){alert(r.errorTypes[i][e].replace(/%p/g,t))};this.setup=function(e,t,n){if(!e){e="00";r.errorTypes[oxMap.cfg.language]["00"]=t}if(n){if(oxMap.cfg.language){i=oxMap.cfg.language==="default"?i:oxMap.cfg.language}r.reportError(e||"default",t)}}(e,t,n)}function oxMapRender(e){if(!e){new Error("config",null,true);return false}oxMap.setup.call(e);return true}var OpenLayers={VERSION_NUMBER:"Release 2.12",singleFile:true,_getScriptLocation:function(){var e=new RegExp("(^|(.*?\\/))(OpenLayers[^\\/]*?\\.js)(\\?|$)"),t=document.getElementsByTagName("script"),n,r,i="";for(var s=0,o=t.length;s<o;s++){n=t[s].getAttribute("src");if(n){r=n.match(e);if(r){i=r[1];break}}}return function(){return i}}(),ImgPath:""};OpenLayers.Class=function(){var e=arguments.length;var t=arguments[0];var n=arguments[e-1];var r=typeof n.initialize=="function"?n.initialize:function(){t.prototype.initialize.apply(this,arguments)};if(e>1){var i=[r,t].concat(Array.prototype.slice.call(arguments).slice(1,e-1),n);OpenLayers.inherit.apply(null,i)}else{r.prototype=n}return r};OpenLayers.inherit=function(e,t){var n=function(){};n.prototype=t.prototype;e.prototype=new n;var r,i,s;for(r=2,i=arguments.length;r<i;r++){s=arguments[r];if(typeof s==="function"){s=s.prototype}OpenLayers.Util.extend(e.prototype,s)}};OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.extend=function(e,t){e=e||{};if(t){for(var n in t){var r=t[n];if(r!==undefined){e[n]=r}}var i=typeof window.Event=="function"&&t instanceof window.Event;if(!i&&t.hasOwnProperty&&t.hasOwnProperty("toString")){e.toString=t.toString}}return e};OpenLayers.String={startsWith:function(e,t){return e.indexOf(t)==0},contains:function(e,t){return e.indexOf(t)!=-1},trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(e){var t=e.split("-");var n=t[0];for(var r=1,i=t.length;r<i;r++){var s=t[r];n+=s.charAt(0).toUpperCase()+s.substring(1)}return n},format:function(e,t,n){if(!t){t=window}var r=function(e,r){var i;var s=r.split(/\.+/);for(var o=0;o<s.length;o++){if(o==0){i=t}i=i[s[o]]}if(typeof i=="function"){i=n?i.apply(null,n):i()}if(typeof i=="undefined"){return"undefined"}else{return i}};return e.replace(OpenLayers.String.tokenRegEx,r)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(e){return OpenLayers.String.numberRegEx.test(e)},numericIf:function(e){return OpenLayers.String.isNumeric(e)?parseFloat(e):e}};OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(e,t){var n=0;if(t>0){n=parseFloat(e.toPrecision(t))}return n},format:function(e,t,n,r){t=typeof t!="undefined"?t:0;n=typeof n!="undefined"?n:OpenLayers.Number.thousandsSeparator;r=typeof r!="undefined"?r:OpenLayers.Number.decimalSeparator;if(t!=null){e=parseFloat(e.toFixed(t))}var i=e.toString().split(".");if(i.length==1&&t==null){t=0}var s=i[0];if(n){var o=/(-?[0-9]+)([0-9]{3})/;while(o.test(s)){s=s.replace(o,"$1"+n+"$2")}}var u;if(t==0){u=s}else{var a=i.length>1?i[1]:"0";if(t!=null){a=a+(new Array(t-a.length+1)).join("0")}u=s+r+a}return u}};OpenLayers.Function={bind:function(e,t){var n=Array.prototype.slice.apply(arguments,[2]);return function(){var r=n.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(t,r)}},bindAsEventListener:function(e,t){return function(n){return e.call(t,n||window.event)}},False:function(){return false},True:function(){return true},Void:function(){}};OpenLayers.Array={filter:function(e,t,n){var r=[];if(Array.prototype.filter){r=e.filter(t,n)}else{var i=e.length;if(typeof t!="function"){throw new TypeError}for(var s=0;s<i;s++){if(s in e){var o=e[s];if(t.call(n,o,s,e)){r.push(o)}}}}return r}};OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(e,t,n,r){if(OpenLayers.Util.isArray(e)){r=e[3];n=e[2];t=e[1];e=e[0]}if(e!=null){this.left=OpenLayers.Util.toFloat(e)}if(t!=null){this.bottom=OpenLayers.Util.toFloat(t)}if(n!=null){this.right=OpenLayers.Util.toFloat(n)}if(r!=null){this.top=OpenLayers.Util.toFloat(r)}},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(e){var t=false;if(e!=null){t=this.left==e.left&&this.right==e.right&&this.top==e.top&&this.bottom==e.bottom}return t},toString:function(){return[this.left,this.bottom,this.right,this.top].join(",")},toArray:function(e){if(e===true){return[this.bottom,this.left,this.top,this.right]}else{return[this.left,this.bottom,this.right,this.top]}},toBBOX:function(e,t){if(e==null){e=6}var n=Math.pow(10,e);var r=Math.round(this.left*n)/n;var i=Math.round(this.bottom*n)/n;var s=Math.round(this.right*n)/n;var o=Math.round(this.top*n)/n;if(t===true){return i+","+r+","+o+","+s}else{return r+","+i+","+s+","+o}},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){if(!this.centerLonLat){this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)}return this.centerLonLat},scale:function(e,t){if(t==null){t=this.getCenterLonLat()}var n,r;if(t.CLASS_NAME=="OpenLayers.LonLat"){n=t.lon;r=t.lat}else{n=t.x;r=t.y}var i=(this.left-n)*e+n;var s=(this.bottom-r)*e+r;var o=(this.right-n)*e+n;var u=(this.top-r)*e+r;return new OpenLayers.Bounds(i,s,o,u)},add:function(e,t){if(e==null||t==null){throw new TypeError("Bounds.add cannot receive null values")}return new OpenLayers.Bounds(this.left+e,this.bottom+t,this.right+e,this.top+t)},extend:function(e){var t=null;if(e){switch(e.CLASS_NAME){case"OpenLayers.LonLat":t=new OpenLayers.Bounds(e.lon,e.lat,e.lon,e.lat);break;case"OpenLayers.Geometry.Point":t=new OpenLayers.Bounds(e.x,e.y,e.x,e.y);break;case"OpenLayers.Bounds":t=e;break}if(t){this.centerLonLat=null;if(this.left==null||t.left<this.left){this.left=t.left}if(this.bottom==null||t.bottom<this.bottom){this.bottom=t.bottom}if(this.right==null||t.right>this.right){this.right=t.right}if(this.top==null||t.top>this.top){this.top=t.top}}}},containsLonLat:function(e,t){if(typeof t==="boolean"){t={inclusive:t}}t=t||{};var n=this.contains(e.lon,e.lat,t.inclusive),r=t.worldBounds;if(r&&!n){var i=r.getWidth();var s=(r.left+r.right)/2;var o=Math.round((e.lon-s)/i);n=this.containsLonLat({lon:e.lon-o*i,lat:e.lat},{inclusive:t.inclusive})}return n},containsPixel:function(e,t){return this.contains(e.x,e.y,t)},contains:function(e,t,n){if(n==null){n=true}if(e==null||t==null){return false}e=OpenLayers.Util.toFloat(e);t=OpenLayers.Util.toFloat(t);var r=false;if(n){r=e>=this.left&&e<=this.right&&t>=this.bottom&&t<=this.top}else{r=e>this.left&&e<this.right&&t>this.bottom&&t<this.top}return r},intersectsBounds:function(e,t){if(typeof t==="boolean"){t={inclusive:t}}t=t||{};if(t.worldBounds){var n=this.wrapDateLine(t.worldBounds);e=e.wrapDateLine(t.worldBounds)}else{n=this}if(t.inclusive==null){t.inclusive=true}var r=false;var i=n.left==e.right||n.right==e.left||n.top==e.bottom||n.bottom==e.top;if(t.inclusive||!i){var s=e.bottom>=n.bottom&&e.bottom<=n.top||n.bottom>=e.bottom&&n.bottom<=e.top;var o=e.top>=n.bottom&&e.top<=n.top||n.top>e.bottom&&n.top<e.top;var u=e.left>=n.left&&e.left<=n.right||n.left>=e.left&&n.left<=e.right;var a=e.right>=n.left&&e.right<=n.right||n.right>=e.left&&n.right<=e.right;r=(s||o)&&(u||a)}if(t.worldBounds&&!r){var f=t.worldBounds;var l=f.getWidth();var c=!f.containsBounds(n);var h=!f.containsBounds(e);if(c&&!h){e=e.add(-l,0);r=n.intersectsBounds(e,{inclusive:t.inclusive})}else if(h&&!c){n=n.add(-l,0);r=e.intersectsBounds(n,{inclusive:t.inclusive})}}return r},containsBounds:function(e,t,n){if(t==null){t=false}if(n==null){n=true}var r=this.contains(e.left,e.bottom,n);var i=this.contains(e.right,e.bottom,n);var s=this.contains(e.left,e.top,n);var o=this.contains(e.right,e.top,n);return t?r||i||s||o:r&&i&&s&&o},determineQuadrant:function(e){var t="";var n=this.getCenterLonLat();t+=e.lat<n.lat?"b":"t";t+=e.lon<n.lon?"l":"r";return t},transform:function(e,t){this.centerLonLat=null;var n=OpenLayers.Projection.transform({x:this.left,y:this.bottom},e,t);var r=OpenLayers.Projection.transform({x:this.right,y:this.bottom},e,t);var i=OpenLayers.Projection.transform({x:this.left,y:this.top},e,t);var s=OpenLayers.Projection.transform({x:this.right,y:this.top},e,t);this.left=Math.min(n.x,i.x);this.bottom=Math.min(n.y,r.y);this.right=Math.max(r.x,s.x);this.top=Math.max(i.y,s.y);return this},wrapDateLine:function(e,t){t=t||{};var n=t.leftTolerance||0;var r=t.rightTolerance||0;var i=this.clone();if(e){var s=e.getWidth();while(i.left<e.left&&i.right-r<=e.left){i=i.add(s,0)}while(i.left+n>=e.right&&i.right>e.right){i=i.add(-s,0)}var o=i.left+n;if(o<e.right&&o>e.left&&i.right-r>e.right){i=i.add(-s,0)}}return i},CLASS_NAME:"OpenLayers.Bounds"});OpenLayers.Bounds.fromString=function(e,t){var n=e.split(",");return OpenLayers.Bounds.fromArray(n,t)};OpenLayers.Bounds.fromArray=function(e,t){return t===true?new OpenLayers.Bounds(e[1],e[0],e[3],e[2]):new OpenLayers.Bounds(e[0],e[1],e[2],e[3])};OpenLayers.Bounds.fromSize=function(e){return new OpenLayers.Bounds(0,e.h,e.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(e){var t="";t+=e.charAt(0)=="t"?"b":"t";t+=e.charAt(1)=="l"?"r":"l";return t};OpenLayers.Element={visible:function(e){return OpenLayers.Util.getElement(e).style.display!="none"},toggle:function(){for(var e=0,t=arguments.length;e<t;e++){var n=OpenLayers.Util.getElement(arguments[e]);var r=OpenLayers.Element.visible(n)?"none":"";n.style.display=r}},remove:function(e){e=OpenLayers.Util.getElement(e);e.parentNode.removeChild(e)},getHeight:function(e){e=OpenLayers.Util.getElement(e);return e.offsetHeight},hasClass:function(e,t){var n=e.className;return!!n&&(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(n)},addClass:function(e,t){if(!OpenLayers.Element.hasClass(e,t)){e.className+=(e.className?" ":"")+t}return e},removeClass:function(e,t){var n=e.className;if(n){e.className=OpenLayers.String.trim(n.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," "))}return e},toggleClass:function(e,t){if(OpenLayers.Element.hasClass(e,t)){OpenLayers.Element.removeClass(e,t)}else{OpenLayers.Element.addClass(e,t)}return e},getStyle:function(e,t){e=OpenLayers.Util.getElement(e);var n=null;if(e&&e.style){n=e.style[OpenLayers.String.camelize(t)];if(!n){if(document.defaultView&&document.defaultView.getComputedStyle){var r=document.defaultView.getComputedStyle(e,null);n=r?r.getPropertyValue(t):null}else if(e.currentStyle){n=e.currentStyle[OpenLayers.String.camelize(t)]}}var i=["left","top","right","bottom"];if(window.opera&&OpenLayers.Util.indexOf(i,t)!=-1&&OpenLayers.Element.getStyle(e,"position")=="static"){n="auto"}}return n=="auto"?null:n}};OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(e,t){if(OpenLayers.Util.isArray(e)){t=e[1];e=e[0]}this.lon=OpenLayers.Util.toFloat(e);this.lat=OpenLayers.Util.toFloat(t)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(e,t){if(e==null||t==null){throw new TypeError("LonLat.add cannot receive null values")}return new OpenLayers.LonLat(this.lon+OpenLayers.Util.toFloat(e),this.lat+OpenLayers.Util.toFloat(t))},equals:function(e){var t=false;if(e!=null){t=this.lon==e.lon&&this.lat==e.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(e.lon)&&isNaN(e.lat)}return t},transform:function(e,t){var n=OpenLayers.Projection.transform({x:this.lon,y:this.lat},e,t);this.lon=n.x;this.lat=n.y;return this},wrapDateLine:function(e){var t=this.clone();if(e){while(t.lon<e.left){t.lon+=e.getWidth()}while(t.lon>e.right){t.lon-=e.getWidth()}}return t},CLASS_NAME:"OpenLayers.LonLat"});OpenLayers.LonLat.fromString=function(e){var t=e.split(",");return new OpenLayers.LonLat(t[0],t[1])};OpenLayers.LonLat.fromArray=function(e){var t=OpenLayers.Util.isArray(e),n=t&&e[0],r=t&&e[1];return new OpenLayers.LonLat(n,r)};OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(e,t){this.x=parseFloat(e);this.y=parseFloat(t)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(e){var t=false;if(e!=null){t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)}return t},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},add:function(e,t){if(e==null||t==null){throw new TypeError("Pixel.add cannot receive null values")}return new OpenLayers.Pixel(this.x+e,this.y+t)},offset:function(e){var t=this.clone();if(e){t=this.add(e.x,e.y)}return t},CLASS_NAME:"OpenLayers.Pixel"});OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(e,t){this.w=parseFloat(e);this.h=parseFloat(t)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(e){var t=false;if(e!=null){t=this.w==e.w&&this.h==e.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(e.w)&&isNaN(e.h)}return t},CLASS_NAME:"OpenLayers.Size"});OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(e){alert(e)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"};(function(){var e=document.getElementsByTagName("script");for(var t=0,n=e.length;t<n;++t){if(e[t].src.indexOf("firebug.js")!=-1){if(console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}}})();OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){if(!OpenLayers.Lang.code){OpenLayers.Lang.setCode()}return OpenLayers.Lang.code},setCode:function(e){var t;if(!e){e=OpenLayers.BROWSER_NAME=="msie"?navigator.userLanguage:navigator.language}var n=e.split("-");n[0]=n[0].toLowerCase();if(typeof OpenLayers.Lang[n[0]]=="object"){t=n[0]}if(n[1]){var r=n[0]+"-"+n[1].toUpperCase();if(typeof OpenLayers.Lang[r]=="object"){t=r}}if(!t){OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+n.join("-")+" dictionary, falling back to default language");t=OpenLayers.Lang.defaultCode}OpenLayers.Lang.code=t},translate:function(e,t){var n=OpenLayers.Lang[OpenLayers.Lang.getCode()];var r=n&&n[e];if(!r){r=e}if(t){r=OpenLayers.String.format(r,t)}return r}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Util=OpenLayers.Util||{};OpenLayers.Util.getElement=function(){var e=[];for(var t=0,n=arguments.length;t<n;t++){var r=arguments[t];if(typeof r=="string"){r=document.getElementById(r)}if(arguments.length==1){return r}e.push(r)}return e};OpenLayers.Util.isElement=function(e){return!!(e&&e.nodeType===1)};OpenLayers.Util.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"};if(typeof window.$==="undefined"){window.$=OpenLayers.Util.getElement}OpenLayers.Util.removeItem=function(e,t){for(var n=e.length-1;n>=0;n--){if(e[n]==t){e.splice(n,1)}}return e};OpenLayers.Util.indexOf=function(e,t){if(typeof e.indexOf=="function"){return e.indexOf(t)}else{for(var n=0,r=e.length;n<r;n++){if(e[n]==t){return n}}return-1}};OpenLayers.Util.modifyDOMElement=function(e,t,n,r,i,s,o,u){if(t){e.id=t}if(n){e.style.left=n.x+"px";e.style.top=n.y+"px"}if(r){e.style.width=r.w+"px";e.style.height=r.h+"px"}if(i){e.style.position=i}if(s){e.style.border=s}if(o){e.style.overflow=o}if(parseFloat(u)>=0&&parseFloat(u)<1){e.style.filter="alpha(opacity="+u*100+")";e.style.opacity=u}else if(parseFloat(u)==1){e.style.filter="";e.style.opacity=""}};OpenLayers.Util.createDiv=function(e,t,n,r,i,s,o,u){var a=document.createElement("div");if(r){a.style.backgroundImage="url("+r+")"}if(!e){e=OpenLayers.Util.createUniqueID("OpenLayersDiv")}if(!i){i="absolute"}OpenLayers.Util.modifyDOMElement(a,e,t,n,i,s,o,u);return a};OpenLayers.Util.createImage=function(e,t,n,r,i,s,o,u){var a=document.createElement("img");if(!e){e=OpenLayers.Util.createUniqueID("OpenLayersDiv")}if(!i){i="relative"}OpenLayers.Util.modifyDOMElement(a,e,t,n,i,s,null,o);if(u){a.style.display="none";function f(){a.style.display="";OpenLayers.Event.stopObservingElement(a)}OpenLayers.Event.observe(a,"load",f);OpenLayers.Event.observe(a,"error",f)}a.style.alt=e;a.galleryImg="no";if(r){a.src=r}return a};OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var e=navigator.appVersion.split("MSIE");var t=parseFloat(e[1]);var n=false;try{n=!!document.body.filters}catch(r){}OpenLayers.Util.alphaHackNeeded=n&&t>=5.5&&t<7}return OpenLayers.Util.alphaHackNeeded};OpenLayers.Util.modifyAlphaImageDiv=function(e,t,n,r,i,s,o,u,a){OpenLayers.Util.modifyDOMElement(e,t,n,r,s,null,null,a);var f=e.childNodes[0];if(i){f.src=i}OpenLayers.Util.modifyDOMElement(f,e.id+"_innerImage",null,r,"relative",o);if(OpenLayers.Util.alphaHack()){if(e.style.display!="none"){e.style.display="inline-block"}if(u==null){u="scale"}e.style.filter="progid:DXImageTransform.Microsoft"+".AlphaImageLoader(src='"+f.src+"', "+"sizingMethod='"+u+"')";if(parseFloat(e.style.opacity)>=0&&parseFloat(e.style.opacity)<1){e.style.filter+=" alpha(opacity="+e.style.opacity*100+")"}f.style.filter="alpha(opacity=0)"}};OpenLayers.Util.createAlphaImageDiv=function(e,t,n,r,i,s,o,u,a){var f=OpenLayers.Util.createDiv();var l=OpenLayers.Util.createImage(null,null,null,null,null,null,null,a);l.className="olAlphaImg";f.appendChild(l);OpenLayers.Util.modifyAlphaImageDiv(f,e,t,n,r,i,s,o,u);return f};OpenLayers.Util.upperCaseObject=function(e){var t={};for(var n in e){t[n.toUpperCase()]=e[n]}return t};OpenLayers.Util.applyDefaults=function(e,t){e=e||{};var n=typeof window.Event=="function"&&t instanceof window.Event;for(var r in t){if(e[r]===undefined||!n&&t.hasOwnProperty&&t.hasOwnProperty(r)&&!e.hasOwnProperty(r)){e[r]=t[r]}}if(!n&&t&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&!e.hasOwnProperty("toString")){e.toString=t.toString}return e};OpenLayers.Util.getParameterString=function(e){var t=[];for(var n in e){var r=e[n];if(r!=null&&typeof r!="function"){var i;if(typeof r=="object"&&r.constructor==Array){var s=[];var o;for(var u=0,a=r.length;u<a;u++){o=r[u];s.push(encodeURIComponent(o===null||o===undefined?"":o))}i=s.join(",")}else{i=encodeURIComponent(r)}t.push(encodeURIComponent(n)+"="+i)}}return t.join("&")};OpenLayers.Util.urlAppend=function(e,t){var n=e;if(t){var r=(e+" ").split(/[?&]/);n+=r.pop()===" "?t:r.length?"&"+t:"?"+t}return n};OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"};OpenLayers.Util.getImageLocation=function(e){return OpenLayers.Util.getImagesLocation()+e};OpenLayers.Util.Try=function(){var e=null;for(var t=0,n=arguments.length;t<n;t++){var r=arguments[t];try{e=r();break}catch(i){}}return e};OpenLayers.Util.getXmlNodeValue=function(e){var t=null;OpenLayers.Util.Try(function(){t=e.text;if(!t){t=e.textContent}if(!t){t=e.firstChild.nodeValue}},function(){t=e.textContent});return t};OpenLayers.Util.mouseLeft=function(e,t){var n=e.relatedTarget?e.relatedTarget:e.toElement;while(n!=t&&n!=null){n=n.parentNode}return n!=t};OpenLayers.Util.DEFAULT_PRECISION=14;OpenLayers.Util.toFloat=function(e,t){if(t==null){t=OpenLayers.Util.DEFAULT_PRECISION}if(typeof e!=="number"){e=parseFloat(e)}return t===0?e:parseFloat(e.toPrecision(t))};OpenLayers.Util.rad=function(e){return e*Math.PI/180};OpenLayers.Util.deg=function(e){return e*180/Math.PI};OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563};OpenLayers.Util.distVincenty=function(e,t){var n=OpenLayers.Util.VincentyConstants;var r=n.a,i=n.b,s=n.f;var o=OpenLayers.Util.rad(t.lon-e.lon);var u=Math.atan((1-s)*Math.tan(OpenLayers.Util.rad(e.lat)));var a=Math.atan((1-s)*Math.tan(OpenLayers.Util.rad(t.lat)));var f=Math.sin(u),l=Math.cos(u);var c=Math.sin(a),h=Math.cos(a);var p=o,d=2*Math.PI;var v=20;while(Math.abs(p-d)>1e-12&&--v>0){var m=Math.sin(p),g=Math.cos(p);var y=Math.sqrt(h*m*h*m+(l*c-f*h*g)*(l*c-f*h*g));if(y==0){return 0}var b=f*c+l*h*g;var w=Math.atan2(y,b);var E=Math.asin(l*h*m/y);var S=Math.cos(E)*Math.cos(E);var x=b-2*f*c/S;var T=s/16*S*(4+s*(4-3*S));d=p;p=o+(1-T)*s*Math.sin(E)*(w+T*y*(x+T*b*(-1+2*x*x)))}if(v==0){return NaN}var N=S*(r*r-i*i)/(i*i);var C=1+N/16384*(4096+N*(-768+N*(320-175*N)));var k=N/1024*(256+N*(-128+N*(74-47*N)));var L=k*y*(x+k/4*(b*(-1+2*x*x)-k/6*x*(-3+4*y*y)*(-3+4*x*x)));var A=i*C*(w-L);var O=A.toFixed(3)/1e3;return O};OpenLayers.Util.destinationVincenty=function(e,t,n){var r=OpenLayers.Util;var i=r.VincentyConstants;var s=i.a,o=i.b,u=i.f;var a=e.lon;var f=e.lat;var l=n;var c=r.rad(t);var h=Math.sin(c);var p=Math.cos(c);var d=(1-u)*Math.tan(r.rad(f));var v=1/Math.sqrt(1+d*d),m=d*v;var g=Math.atan2(d,p);var y=v*h;var b=1-y*y;var w=b*(s*s-o*o)/(o*o);var E=1+w/16384*(4096+w*(-768+w*(320-175*w)));var S=w/1024*(256+w*(-128+w*(74-47*w)));var x=l/(o*E),T=2*Math.PI;while(Math.abs(x-T)>1e-12){var N=Math.cos(2*g+x);var C=Math.sin(x);var k=Math.cos(x);var L=S*C*(N+S/4*(k*(-1+2*N*N)-S/6*N*(-3+4*C*C)*(-3+4*N*N)));T=x;x=l/(o*E)+L}var A=m*C-v*k*p;var O=Math.atan2(m*k+v*C*p,(1-u)*Math.sqrt(y*y+A*A));var M=Math.atan2(C*h,v*k-m*C*p);var _=u/16*b*(4+u*(4-3*b));var D=M-(1-_)*u*y*(x+_*C*(N+_*k*(-1+2*N*N)));var P=Math.atan2(y,-A);return new OpenLayers.LonLat(a+r.deg(D),r.deg(O))};OpenLayers.Util.getParameters=function(e){e=e===null||e===undefined?window.location.href:e;var t="";if(OpenLayers.String.contains(e,"?")){var n=e.indexOf("?")+1;var r=OpenLayers.String.contains(e,"#")?e.indexOf("#"):e.length;t=e.substring(n,r)}var i={};var s=t.split(/[&;]/);for(var o=0,u=s.length;o<u;++o){var a=s[o].split("=");if(a[0]){var f=a[0];try{f=decodeURIComponent(f)}catch(l){f=unescape(f)}var c=(a[1]||"").replace(/\+/g," ");try{c=decodeURIComponent(c)}catch(l){c=unescape(c)}c=c.split(",");if(c.length==1){c=c[0]}i[f]=c}}return i};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(e){if(e==null){e="id_"}OpenLayers.Util.lastSeqID+=1;return e+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT["degrees"]=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT["nmi"]=1852*OpenLayers.INCHES_PER_UNIT.m;OpenLayers.METERS_PER_INCH=.0254000508001016;OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:.0254/OpenLayers.METERS_PER_INCH,MicroInch:254e-7/OpenLayers.METERS_PER_INCH,Mil:2.54e-8/OpenLayers.METERS_PER_INCH,Centimeter:.01/OpenLayers.METERS_PER_INCH,Kilometer:1e3/OpenLayers.METERS_PER_INCH,Yard:.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:.3047996/OpenLayers.METERS_PER_INCH,IndianFt75:.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:.1/OpenLayers.METERS_PER_INCH,Millimeter:.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:.20116782494375873/OpenLayers.METERS_PER_INCH,SearsLink:.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:.304812252984506/OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5e4/OpenLayers.METERS_PER_INCH,"150kilometers":15e4/OpenLayers.METERS_PER_INCH});OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT["Meter"]/1e3,cm:OpenLayers.INCHES_PER_UNIT["Meter"]/100,dm:OpenLayers.INCHES_PER_UNIT["Meter"]*100,km:OpenLayers.INCHES_PER_UNIT["Meter"]*1e3,kmi:OpenLayers.INCHES_PER_UNIT["nmi"],fath:OpenLayers.INCHES_PER_UNIT["Fathom"],ch:OpenLayers.INCHES_PER_UNIT["IntnlChain"],link:OpenLayers.INCHES_PER_UNIT["IntnlLink"],"us-in":OpenLayers.INCHES_PER_UNIT["inches"],"us-ft":OpenLayers.INCHES_PER_UNIT["Foot"],"us-yd":OpenLayers.INCHES_PER_UNIT["Yard"],"us-ch":OpenLayers.INCHES_PER_UNIT["GunterChain"],"us-mi":OpenLayers.INCHES_PER_UNIT["Mile"],"ind-yd":OpenLayers.INCHES_PER_UNIT["IndianYd37"],"ind-ft":OpenLayers.INCHES_PER_UNIT["IndianFt37"],"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(e){var t=e>1?1/e:e;return t};OpenLayers.Util.getResolutionFromScale=function(e,t){var n;if(e){if(t==null){t="degrees"}var r=OpenLayers.Util.normalizeScale(e);n=1/(r*OpenLayers.INCHES_PER_UNIT[t]*OpenLayers.DOTS_PER_INCH)}return n};OpenLayers.Util.getScaleFromResolution=function(e,t){if(t==null){t="degrees"}var n=e*OpenLayers.INCHES_PER_UNIT[t]*OpenLayers.DOTS_PER_INCH;return n};OpenLayers.Util.pagePosition=function(e){var t=[0,0];var n=OpenLayers.Util.getViewportElement();if(!e||e==window||e==n){return t}var r=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&OpenLayers.Element.getStyle(e,"position")=="absolute"&&(e.style.top==""||e.style.left=="");var i=null;var s;if(e.getBoundingClientRect){s=e.getBoundingClientRect();var o=n.scrollTop;var u=n.scrollLeft;t[0]=s.left+u;t[1]=s.top+o}else if(document.getBoxObjectFor&&!r){s=document.getBoxObjectFor(e);var a=document.getBoxObjectFor(n);t[0]=s.screenX-a.screenX;t[1]=s.screenY-a.screenY}else{t[0]=e.offsetLeft;t[1]=e.offsetTop;i=e.offsetParent;if(i!=e){while(i){t[0]+=i.offsetLeft;t[1]+=i.offsetTop;i=i.offsetParent}}var f=OpenLayers.BROWSER_NAME;if(f=="opera"||f=="safari"&&OpenLayers.Element.getStyle(e,"position")=="absolute"){t[1]-=document.body.offsetTop}i=e.offsetParent;while(i&&i!=document.body){t[0]-=i.scrollLeft;if(f!="opera"||i.tagName!="TR"){t[1]-=i.scrollTop}i=i.offsetParent}}return t};OpenLayers.Util.getViewportElement=function(){var e=arguments.callee.viewportElement;if(e==undefined){e=OpenLayers.BROWSER_NAME=="msie"&&document.compatMode!="CSS1Compat"?document.body:document.documentElement;arguments.callee.viewportElement=e}return e};OpenLayers.Util.isEquivalentUrl=function(e,t,n){n=n||{};OpenLayers.Util.applyDefaults(n,{ignoreCase:true,ignorePort80:true,ignoreHash:true});var r=OpenLayers.Util.createUrlObject(e,n);var i=OpenLayers.Util.createUrlObject(t,n);for(var s in r){if(s!=="args"){if(r[s]!=i[s]){return false}}}for(var s in r.args){if(r.args[s]!=i.args[s]){return false}delete i.args[s]}for(var s in i.args){return false}return true};OpenLayers.Util.createUrlObject=function(e,t){t=t||{};if(!/^\w+:\/\//.test(e)){var n=window.location;var r=n.port?":"+n.port:"";var i=n.protocol+"//"+n.host.split(":").shift()+r;if(e.indexOf("/")===0){e=i+e}else{var s=n.pathname.split("/");s.pop();e=i+s.join("/")+"/"+e}}if(t.ignoreCase){e=e.toLowerCase()}var o=document.createElement("a");o.href=e;var u={};u.host=o.host.split(":").shift();u.protocol=o.protocol;if(t.ignorePort80){u.port=o.port=="80"||o.port=="0"?"":o.port}else{u.port=o.port==""||o.port=="0"?"80":o.port}u.hash=t.ignoreHash||o.hash==="#"?"":o.hash;var a=o.search;if(!a){var f=e.indexOf("?");a=f!=-1?e.substr(f):""}u.args=OpenLayers.Util.getParameters(a);u.pathname=o.pathname.charAt(0)=="/"?o.pathname:"/"+o.pathname;return u};OpenLayers.Util.removeTail=function(e){var t=null;var n=e.indexOf("?");var r=e.indexOf("#");if(n==-1){t=r!=-1?e.substr(0,r):e}else{t=r!=-1?e.substr(0,Math.min(n,r)):e.substr(0,n)}return t};OpenLayers.IS_GECKO=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("webkit")==-1&&e.indexOf("gecko")!=-1}();OpenLayers.CANVAS_SUPPORTED=function(){var e=document.createElement("canvas");return!!(e.getContext&&e.getContext("2d"))}();OpenLayers.BROWSER_NAME=function(){var e="";var t=navigator.userAgent.toLowerCase();if(t.indexOf("opera")!=-1){e="opera"}else if(t.indexOf("msie")!=-1){e="msie"}else if(t.indexOf("safari")!=-1){e="safari"}else if(t.indexOf("mozilla")!=-1){if(t.indexOf("firefox")!=-1){e="firefox"}else{e="mozilla"}}return e}();OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME};OpenLayers.Util.getRenderedDimensions=function(e,t,n){var r,i;var s=document.createElement("div");s.style.visibility="hidden";var o=n&&n.containerElement?n.containerElement:document.body;var u=false;var a=null;var f=o;while(f&&f.tagName.toLowerCase()!="body"){var l=OpenLayers.Element.getStyle(f,"position");if(l=="absolute"){u=true;break}else if(l&&l!="static"){break}f=f.parentNode}if(u&&(o.clientHeight===0||o.clientWidth===0)){a=document.createElement("div");a.style.visibility="hidden";a.style.position="absolute";a.style.overflow="visible";a.style.width=document.body.clientWidth+"px";a.style.height=document.body.clientHeight+"px";a.appendChild(s)}s.style.position="absolute";if(t){if(t.w){r=t.w;s.style.width=r+"px"}else if(t.h){i=t.h;s.style.height=i+"px"}}if(n&&n.displayClass){s.className=n.displayClass}var c=document.createElement("div");c.innerHTML=e;c.style.overflow="visible";if(c.childNodes){for(var h=0,p=c.childNodes.length;h<p;h++){if(!c.childNodes[h].style)continue;c.childNodes[h].style.overflow="visible"}}s.appendChild(c);if(a){o.appendChild(a)}else{o.appendChild(s)}if(!r){r=parseInt(c.scrollWidth);s.style.width=r+"px"}if(!i){i=parseInt(c.scrollHeight)}s.removeChild(c);if(a){a.removeChild(s);o.removeChild(a)}else{o.removeChild(s)}return new OpenLayers.Size(r,i)};OpenLayers.Util.getScrollbarWidth=function(){var e=OpenLayers.Util._scrollbarWidth;if(e==null){var t=null;var n=null;var r=0;var i=0;t=document.createElement("div");t.style.position="absolute";t.style.top="-1000px";t.style.left="-1000px";t.style.width="100px";t.style.height="50px";t.style.overflow="hidden";n=document.createElement("div");n.style.width="100%";n.style.height="200px";t.appendChild(n);document.body.appendChild(t);r=n.offsetWidth;t.style.overflow="scroll";i=n.offsetWidth;document.body.removeChild(document.body.lastChild);OpenLayers.Util._scrollbarWidth=r-i;e=OpenLayers.Util._scrollbarWidth}return e};OpenLayers.Util.getFormattedLonLat=function(e,t,n){if(!n){n="dms"}e=(e+540)%360-180;var r=Math.abs(e);var i=Math.floor(r);var s=(r-i)/(1/60);var o=s;s=Math.floor(s);var u=(o-s)/(1/60);u=Math.round(u*10);u/=10;if(u>=60){u-=60;s+=1;if(s>=60){s-=60;i+=1}}if(i<10){i="0"+i}var a=i+"°";if(n.indexOf("dm")>=0){if(s<10){s="0"+s}a+=s+"'";if(n.indexOf("dms")>=0){if(u<10){u="0"+u}a+=u+'"'}}if(t=="lon"){a+=e<0?OpenLayers.i18n("W"):OpenLayers.i18n("E")}else{a+=e<0?OpenLayers.i18n("S"):OpenLayers.i18n("N")}return a};OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(e,t,n){this.layer=e;this.lonlat=t;this.data=n!=null?n:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){if(this.layer!=null&&this.layer.map!=null){if(this.popup!=null){this.layer.map.removePopup(this.popup)}}if(this.layer!=null&&this.marker!=null){this.layer.removeMarker(this.marker)}this.layer=null;this.id=null;this.lonlat=null;this.data=null;if(this.marker!=null){this.destroyMarker(this.marker);this.marker=null}if(this.popup!=null){this.destroyPopup(this.popup);this.popup=null}},onScreen:function(){var e=false;if(this.layer!=null&&this.layer.map!=null){var t=this.layer.map.getExtent();e=t.containsLonLat(this.lonlat)}return e},createMarker:function(){if(this.lonlat!=null){this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon)}return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(e){if(this.lonlat!=null){if(!this.popup){var t=this.marker?this.marker.icon:null;var n=this.popupClass?this.popupClass:OpenLayers.Popup.Anchored;this.popup=new n(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,t,e)}if(this.data.overflow!=null){this.popup.contentDiv.style.overflow=this.data.overflow}this.popup.feature=this}return this.popup},destroyPopup:function(){if(this.popup){this.popup.feature=null;this.popup.destroy();this.popup=null}},CLASS_NAME:"OpenLayers.Feature"});OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(e,t,n){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,t]);this.lonlat=null;this.geometry=e?e:null;this.state=null;this.attributes={};if(t){this.attributes=OpenLayers.Util.extend(this.attributes,t)}this.style=n?n:null},destroy:function(){if(this.layer){this.layer.removeFeatures(this);this.layer=null}this.geometry=null;this.modified=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(e){var t=false;if(this.layer&&this.layer.map){var n=this.layer.map.getExtent();if(e){var r=this.geometry.getBounds();t=n.intersectsBounds(r)}else{var i=n.toGeometry();t=i.intersects(this.geometry)}}return t},getVisibility:function(){return!(this.style&&this.style.display=="none"||!this.layer||this.layer&&this.layer.styleMap&&this.layer.styleMap.createSymbolizer(this,this.renderIntent).display=="none"||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(e,t,n){var r=false;if(this.geometry){r=this.geometry.atPoint(e,t,n)}return r},destroyPopup:function(){},move:function(e){if(!this.layer||!this.geometry.move){return undefined}var t;if(e.CLASS_NAME=="OpenLayers.LonLat"){t=this.layer.getViewPortPxFromLonLat(e)}else{t=e}var n=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat());var r=this.layer.map.getResolution();this.geometry.move(r*(t.x-n.x),r*(n.y-t.y));this.layer.drawFeature(this);return n},toState:function(e){if(e==OpenLayers.State.UPDATE){switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=e;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:break}}else if(e==OpenLayers.State.INSERT){switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=e;break}}else if(e==OpenLayers.State.DELETE){switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=e;break}}else if(e==OpenLayers.State.UNKNOWN){this.state=e}},CLASS_NAME:"OpenLayers.Feature.Vector"});OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}};OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:false,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:false,propertyStyles:null,initialize:function(e,t){OpenLayers.Util.extend(this,t);this.rules=[];if(t&&t.rules){this.addRules(t.rules)}this.setDefaultStyle(e||OpenLayers.Feature.Vector.style["default"]);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var e=0,t=this.rules.length;e<t;e++){this.rules[e].destroy();this.rules[e]=null}this.rules=null;this.defaultStyle=null},createSymbolizer:function(e){var t=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),e);var n=this.rules;var r,i;var s=[];var o=false;for(var u=0,a=n.length;u<a;u++){r=n[u];var f=r.evaluate(e);if(f){if(r instanceof OpenLayers.Rule&&r.elseFilter){s.push(r)}else{o=true;this.applySymbolizer(r,t,e)}}}if(o==false&&s.length>0){o=true;for(var u=0,a=s.length;u<a;u++){this.applySymbolizer(s[u],t,e)}}if(n.length>0&&o==false){t.display="none"}if(t.label!=null&&typeof t.label!=="string"){t.label=String(t.label)}return t},applySymbolizer:function(e,t,n){var r=n.geometry?this.getSymbolizerPrefix(n.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0];var i=e.symbolizer[r]||e.symbolizer;if(this.defaultsPerSymbolizer===true){var s=this.defaultStyle;OpenLayers.Util.applyDefaults(i,{pointRadius:s.pointRadius});if(i.stroke===true||i.graphic===true){OpenLayers.Util.applyDefaults(i,{strokeWidth:s.strokeWidth,strokeColor:s.strokeColor,strokeOpacity:s.strokeOpacity,strokeDashstyle:s.strokeDashstyle,strokeLinecap:s.strokeLinecap})}if(i.fill===true||i.graphic===true){OpenLayers.Util.applyDefaults(i,{fillColor:s.fillColor,fillOpacity:s.fillOpacity})}if(i.graphic===true){OpenLayers.Util.applyDefaults(i,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})}}return this.createLiterals(OpenLayers.Util.extend(t,i),n)},createLiterals:function(e,t){var n=OpenLayers.Util.extend({},t.attributes||t.data);OpenLayers.Util.extend(n,this.context);for(var r in this.propertyStyles){e[r]=OpenLayers.Style.createLiteral(e[r],n,t,r)}return e},findPropertyStyles:function(){var e={};var t=this.defaultStyle;this.addPropertyStyles(e,t);var n=this.rules;var r,i;for(var s=0,o=n.length;s<o;s++){r=n[s].symbolizer;for(var u in r){i=r[u];if(typeof i=="object"){this.addPropertyStyles(e,i)}else{this.addPropertyStyles(e,r);break}}}return e},addPropertyStyles:function(e,t){var n;for(var r in t){n=t[r];if(typeof n=="string"&&n.match(/\$\{\w+\}/)){e[r]=true}}return e},addRules:function(e){Array.prototype.push.apply(this.rules,e);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(e){this.defaultStyle=e;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(e){var t=OpenLayers.Style.SYMBOLIZER_PREFIXES;for(var n=0,r=t.length;n<r;n++){if(e.CLASS_NAME.indexOf(t[n])!=-1){return t[n]}}},clone:function(){var e=OpenLayers.Util.extend({},this);if(this.rules){e.rules=[];for(var t=0,n=this.rules.length;t<n;++t){e.rules.push(this.rules[t].clone())}}e.context=this.context&&OpenLayers.Util.extend({},this.context);var r=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(r,e)},CLASS_NAME:"OpenLayers.Style"});OpenLayers.Style.createLiteral=function(e,t,n,r){if(typeof e=="string"&&e.indexOf("${")!=-1){e=OpenLayers.String.format(e,t,[n,r]);e=isNaN(e)||!e?e:parseFloat(e)}return e};OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"];OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:false,size:null,resolution:null,map:null,featureDx:0,initialize:function(e,t){this.container=OpenLayers.Util.getElement(e);OpenLayers.Util.extend(this,t)},destroy:function(){this.container=null;this.extent=null;this.size=null;this.resolution=null;this.map=null},supported:function(){return false},setExtent:function(e,t){this.extent=e.clone();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var n=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/n);this.extent=e.wrapDateLine(this.map.getMaxExtent()).scale(n)}if(t){this.resolution=null}return true},setSize:function(e){this.size=e.clone();this.resolution=null},getResolution:function(){this.resolution=this.resolution||this.map.getResolution();return this.resolution},drawFeature:function(e,t){if(t==null){t=e.style}if(e.geometry){var n=e.geometry.getBounds();if(n){var r;if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){r=this.map.getMaxExtent()}if(!n.intersectsBounds(this.extent,{worldBounds:r})){t={display:"none"}}else{this.calculateFeatureDx(n,r)}var i=this.drawGeometry(e.geometry,t,e.id);if(t.display!="none"&&t.label&&i!==false){var s=e.geometry.getCentroid();if(t.labelXOffset||t.labelYOffset){var o=isNaN(t.labelXOffset)?0:t.labelXOffset;var u=isNaN(t.labelYOffset)?0:t.labelYOffset;var a=this.getResolution();s.move(o*a,u*a)}this.drawText(e.id,t,s)}else{this.removeText(e.id)}return i}}},calculateFeatureDx:function(e,t){this.featureDx=0;if(t){var n=t.getWidth(),r=(this.extent.left+this.extent.right)/2,i=(e.left+e.right)/2,s=Math.round((i-r)/n);this.featureDx=s*n}},drawGeometry:function(e,t,n){},drawText:function(e,t,n){},removeText:function(e){},clear:function(){},getFeatureIdFromEvent:function(e){},eraseFeatures:function(e){if(!OpenLayers.Util.isArray(e)){e=[e]}for(var t=0,n=e.length;t<n;++t){var r=e[t];this.eraseGeometry(r.geometry,r.id);this.removeText(r.id)}},eraseGeometry:function(e,t){},moveRoot:function(e){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(e){var t=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);if(e.stroke===false){delete t.strokeWidth;delete t.strokeColor}if(e.fill===false){delete t.fillColor}OpenLayers.Util.extend(t,e);return t},CLASS_NAME:"OpenLayers.Renderer"});OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"};OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]};OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(e){this.compare=e?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.clear()},insert:function(e){if(this.exists(e)){this.remove(e)}var t=e.id;this.determineZIndex(e);var n=-1;var r=this.order.length;var i;while(r-n>1){i=parseInt((n+r)/2);var s=this.compare(this,e,OpenLayers.Util.getElement(this.order[i]));if(s>0){n=i}else{r=i}}this.order.splice(r,0,t);this.indices[t]=this.getZIndex(e);return this.getNextElement(r)},remove:function(e){var t=e.id;var n=OpenLayers.Util.indexOf(this.order,t);if(n>=0){this.order.splice(n,1);delete this.indices[t];if(this.order.length>0){var r=this.order[this.order.length-1];this.maxZIndex=this.indices[r]}else{this.maxZIndex=0}}},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(e){return this.indices[e.id]!=null},getZIndex:function(e){return e._style.graphicZIndex},determineZIndex:function(e){var t=e._style.graphicZIndex;if(t==null){t=this.maxZIndex;e._style.graphicZIndex=t}else if(t>this.maxZIndex){this.maxZIndex=t}},getNextElement:function(e){var t=e+1;if(t<this.order.length){var n=OpenLayers.Util.getElement(this.order[t]);if(n==undefined){n=this.getNextElement(t)}return n}else{return null}},CLASS_NAME:"OpenLayers.ElementsIndexer"});OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(e,t,n){var r=e.getZIndex(t);var i=0;if(n){var s=e.getZIndex(n);i=r-s}return i},Z_ORDER_DRAWING_ORDER:function(e,t,n){var r=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,t,n);if(n&&r==0){r=1}return r},Z_ORDER_Y_ORDER:function(e,t,n){var r=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(e,t,n);if(n&&r===0){var i=n._boundsBottom-t._boundsBottom;r=i===0?1:i}return r}};OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(e,t){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot);this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);if(t&&(t.zIndexing||t.yOrdering)){this.indexer=new OpenLayers.ElementsIndexer(t.yOrdering)}},destroy:function(){this.clear();this.rendererRoot=null;this.root=null;this.xmlns=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var e;var t=this.vectorRoot;if(t){while(e=t.firstChild){t.removeChild(e)}}t=this.textRoot;if(t){while(e=t.firstChild){t.removeChild(e)}}if(this.indexer){this.indexer.clear()}},setExtent:function(e,t){var n=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments);var r=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var i,s=e.getWidth()/this.map.getExtent().getWidth(),e=e.scale(1/s),o=this.map.getMaxExtent();if(o.right>e.left&&o.right<e.right){i=true}else if(o.left>e.left&&o.left<e.right){i=false}if(i!==this.rightOfDateLine||t){n=false;this.xOffset=i===true?o.getWidth()/r:0}this.rightOfDateLine=i}return n},getNodeType:function(e,t){},drawGeometry:function(e,t,n){var r=e.CLASS_NAME;var i=true;if(r=="OpenLayers.Geometry.Collection"||r=="OpenLayers.Geometry.MultiPoint"||r=="OpenLayers.Geometry.MultiLineString"||r=="OpenLayers.Geometry.MultiPolygon"){for(var s=0,o=e.components.length;s<o;s++){i=this.drawGeometry(e.components[s],t,n)&&i}return i}i=false;var u=false;if(t.display!="none"){if(t.backgroundGraphic){this.redrawBackgroundNode(e.id,e,t,n)}else{u=true}i=this.redrawNode(e.id,e,t,n)}if(i==false){var a=document.getElementById(e.id);if(a){if(a._style.backgroundGraphic){u=true}a.parentNode.removeChild(a)}}if(u){var a=document.getElementById(e.id+this.BACKGROUND_ID_SUFFIX);if(a){a.parentNode.removeChild(a)}}return i},redrawNode:function(e,t,n,r){n=this.applyDefaultSymbolizer(n);var i=this.nodeFactory(e,this.getNodeType(t,n));i._featureId=r;i._boundsBottom=t.getBounds().bottom;i._geometryClass=t.CLASS_NAME;i._style=n;var s=this.drawGeometryNode(i,t,n);if(s===false){return false}i=s.node;if(this.indexer){var o=this.indexer.insert(i);if(o){this.vectorRoot.insertBefore(i,o)}else{this.vectorRoot.appendChild(i)}}else{if(i.parentNode!==this.vectorRoot){this.vectorRoot.appendChild(i)}}this.postDraw(i);return s.complete},redrawBackgroundNode:function(e,t,n,r){var i=OpenLayers.Util.extend({},n);i.externalGraphic=i.backgroundGraphic;i.graphicXOffset=i.backgroundXOffset;i.graphicYOffset=i.backgroundYOffset;i.graphicZIndex=i.backgroundGraphicZIndex;i.graphicWidth=i.backgroundWidth||i.graphicWidth;i.graphicHeight=i.backgroundHeight||i.graphicHeight;i.backgroundGraphic=null;i.backgroundXOffset=null;i.backgroundYOffset=null;i.backgroundGraphicZIndex=null;return this.redrawNode(e+this.BACKGROUND_ID_SUFFIX,t,i,null)},drawGeometryNode:function(e,t,n){n=n||e._style;var r={isFilled:n.fill===undefined?true:n.fill,isStroked:n.stroke===undefined?!!n.strokeWidth:n.stroke};var i;switch(t.CLASS_NAME){case"OpenLayers.Geometry.Point":if(n.graphic===false){r.isFilled=false;r.isStroked=false}i=this.drawPoint(e,t);break;case"OpenLayers.Geometry.LineString":r.isFilled=false;i=this.drawLineString(e,t);break;case"OpenLayers.Geometry.LinearRing":i=this.drawLinearRing(e,t);break;case"OpenLayers.Geometry.Polygon":i=this.drawPolygon(e,t);break;case"OpenLayers.Geometry.Rectangle":i=this.drawRectangle(e,t);break;default:break}e._options=r;if(i!=false){return{node:this.setStyle(e,n,r,t),complete:i}}else{return false}},postDraw:function(e){},drawPoint:function(e,t){},drawLineString:function(e,t){},drawLinearRing:function(e,t){},drawPolygon:function(e,t){},drawRectangle:function(e,t){},drawCircle:function(e,t){},removeText:function(e){var t=document.getElementById(e+this.LABEL_ID_SUFFIX);if(t){this.textRoot.removeChild(t)}var n=document.getElementById(e+this.LABEL_OUTLINE_SUFFIX);if(n){this.textRoot.removeChild(n)}},getFeatureIdFromEvent:function(e){var t=e.target;var n=t&&t.correspondingUseElement;var r=n?n:t||e.srcElement;return r._featureId},eraseGeometry:function(e,t){if(e.CLASS_NAME=="OpenLayers.Geometry.MultiPoint"||e.CLASS_NAME=="OpenLayers.Geometry.MultiLineString"||e.CLASS_NAME=="OpenLayers.Geometry.MultiPolygon"||e.CLASS_NAME=="OpenLayers.Geometry.Collection"){for(var n=0,r=e.components.length;n<r;n++){this.eraseGeometry(e.components[n],t)}}else{var i=OpenLayers.Util.getElement(e.id);if(i&&i.parentNode){if(i.geometry){i.geometry.destroy();i.geometry=null}i.parentNode.removeChild(i);if(this.indexer){this.indexer.remove(i)}if(i._style.backgroundGraphic){var s=e.id+this.BACKGROUND_ID_SUFFIX;var o=OpenLayers.Util.getElement(s);if(o&&o.parentNode){o.parentNode.removeChild(o)}}}}},nodeFactory:function(e,t){var n=OpenLayers.Util.getElement(e);if(n){if(!this.nodeTypeCompare(n,t)){n.parentNode.removeChild(n);n=this.nodeFactory(e,t)}}else{n=this.createNode(t,e)}return n},nodeTypeCompare:function(e,t){},createNode:function(e,t){},moveRoot:function(e){var t=this.root;if(e.root.parentNode==this.rendererRoot){t=e.root}t.parentNode.removeChild(t);e.rendererRoot.appendChild(t)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(e){return e!="circle"&&!!e},CLASS_NAME:"OpenLayers.Renderer.Elements"});OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(e){if(!this.supported()){return}if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);var t=document.createStyleSheet();var n=["shape","rect","oval","fill","stroke","imagedata","group","textbox"];for(var r=0,i=n.length;r<i;r++){t.addRule("olv\\:"+n[r],"behavior: url(#default#VML); "+"position: absolute; display: inline-block;")}}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments)},supported:function(){return!!document.namespaces},setExtent:function(e,t){var n=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var r=this.getResolution();var i=e.left/r|0;var s=e.top/r-this.size.h|0;if(t||!this.offset){this.offset={x:i,y:s};i=0;s=0}else{i=i-this.offset.x;s=s-this.offset.y}var o=i-this.xOffset+" "+s;this.root.coordorigin=o;var u=[this.root,this.vectorRoot,this.textRoot];var a;for(var f=0,l=u.length;f<l;++f){a=u[f];var c=this.size.w+" "+this.size.h;a.coordsize=c}this.root.style.flip="y";return n},setSize:function(e){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);var t=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot];var n=this.size.w+"px";var r=this.size.h+"px";var i;for(var s=0,o=t.length;s<o;++s){i=t[s];i.style.width=n;i.style.height=r}},getNodeType:function(e,t){var n=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":if(t.externalGraphic){n="olv:rect"}else if(this.isComplexSymbol(t.graphicName)){n="olv:shape"}else{n="olv:oval"}break;case"OpenLayers.Geometry.Rectangle":n="olv:rect";break;case"OpenLayers.Geometry.LineString":case"OpenLayers.Geometry.LinearRing":case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":n="olv:shape";break;default:break}return n},setStyle:function(e,t,n,r){t=t||e._style;n=n||e._options;var i=t.fillColor;if(e._geometryClass==="OpenLayers.Geometry.Point"){if(t.externalGraphic){n.isFilled=true;if(t.graphicTitle){e.title=t.graphicTitle}var s=t.graphicWidth||t.graphicHeight;var o=t.graphicHeight||t.graphicWidth;s=s?s:t.pointRadius*2;o=o?o:t.pointRadius*2;var u=this.getResolution();var a=t.graphicXOffset!=undefined?t.graphicXOffset:-(.5*s);var f=t.graphicYOffset!=undefined?t.graphicYOffset:-(.5*o);e.style.left=((r.x-this.featureDx)/u-this.offset.x+a|0)+"px";e.style.top=(r.y/u-this.offset.y-(f+o)|0)+"px";e.style.width=s+"px";e.style.height=o+"px";e.style.flip="y";i="none";n.isStroked=false}else if(this.isComplexSymbol(t.graphicName)){var l=this.importSymbol(t.graphicName);e.path=l.path;e.coordorigin=l.left+","+l.bottom;var c=l.size;e.coordsize=c+","+c;this.drawCircle(e,r,t.pointRadius);e.style.flip="y"}else{this.drawCircle(e,r,t.pointRadius)}}if(n.isFilled){e.fillcolor=i}else{e.filled="false"}var h=e.getElementsByTagName("fill");var p=h.length==0?null:h[0];if(!n.isFilled){if(p){e.removeChild(p)}}else{if(!p){p=this.createNode("olv:fill",e.id+"_fill")}p.opacity=t.fillOpacity;if(e._geometryClass==="OpenLayers.Geometry.Point"&&t.externalGraphic){if(t.graphicOpacity){p.opacity=t.graphicOpacity}p.src=t.externalGraphic;p.type="frame";if(!(t.graphicWidth&&t.graphicHeight)){p.aspect="atmost"}}if(p.parentNode!=e){e.appendChild(p)}}var d=t.rotation;if(d!==undefined||e._rotation!==undefined){e._rotation=d;if(t.externalGraphic){this.graphicRotate(e,a,f,t);p.opacity=0}else if(e._geometryClass==="OpenLayers.Geometry.Point"){e.style.rotation=d||0}}var v=e.getElementsByTagName("stroke");var m=v.length==0?null:v[0];if(!n.isStroked){e.stroked=false;if(m){m.on=false}}else{if(!m){m=this.createNode("olv:stroke",e.id+"_stroke");e.appendChild(m)}m.on=true;m.color=t.strokeColor;m.weight=t.strokeWidth+"px";m.opacity=t.strokeOpacity;m.endcap=t.strokeLinecap=="butt"?"flat":t.strokeLinecap||"round";if(t.strokeDashstyle){m.dashstyle=this.dashStyle(t)}}if(t.cursor!="inherit"&&t.cursor!=null){e.style.cursor=t.cursor}return e},graphicRotate:function(e,t,n,r){var r=r||e._style;var i=r.rotation||0;var s,o;if(!(r.graphicWidth&&r.graphicHeight)){var u=new Image;u.onreadystatechange=OpenLayers.Function.bind(function(){if(u.readyState=="complete"||u.readyState=="interactive"){s=u.width/u.height;o=Math.max(r.pointRadius*2,r.graphicWidth||0,r.graphicHeight||0);t=t*s;r.graphicWidth=o*s;r.graphicHeight=o;this.graphicRotate(e,t,n,r)}},this);u.src=r.externalGraphic;return}else{o=Math.max(r.graphicWidth,r.graphicHeight);s=r.graphicWidth/r.graphicHeight}var a=Math.round(r.graphicWidth||o*s);var f=Math.round(r.graphicHeight||o);e.style.width=a+"px";e.style.height=f+"px";var l=document.getElementById(e.id+"_image");if(!l){l=this.createNode("olv:imagedata",e.id+"_image");e.appendChild(l)}l.style.width=a+"px";l.style.height=f+"px";l.src=r.externalGraphic;l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader("+"src='', sizingMethod='scale')";var c=i*Math.PI/180;var h=Math.sin(c);var p=Math.cos(c);var d="progid:DXImageTransform.Microsoft.Matrix(M11="+p+",M12="+ -h+",M21="+h+",M22="+p+",SizingMethod='auto expand')\n";var v=r.graphicOpacity||r.fillOpacity;if(v&&v!=1){d+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+v+")\n"}e.style.filter=d;var m=new OpenLayers.Geometry.Point(-t,-n);var g=(new OpenLayers.Bounds(0,0,a,f)).toGeometry();g.rotate(r.rotation,m);var y=g.getBounds();e.style.left=Math.round(parseInt(e.style.left)+y.left)+"px";e.style.top=Math.round(parseInt(e.style.top)-y.bottom)+"px"},postDraw:function(e){e.style.visibility="visible";var t=e._style.fillColor;var n=e._style.strokeColor;if(t=="none"&&e.fillcolor!=t){e.fillcolor=t}if(n=="none"&&e.strokecolor!=n){e.strokecolor=n}},setNodeDimension:function(e,t){var n=t.getBounds();if(n){var r=this.getResolution();var i=new OpenLayers.Bounds((n.left-this.featureDx)/r-this.offset.x|0,n.bottom/r-this.offset.y|0,(n.right-this.featureDx)/r-this.offset.x|0,n.top/r-this.offset.y|0);e.style.left=i.left+"px";e.style.top=i.top+"px";e.style.width=i.getWidth()+"px";e.style.height=i.getHeight()+"px";e.coordorigin=i.left+" "+i.top;e.coordsize=i.getWidth()+" "+i.getHeight()}},dashStyle:function(e){var t=e.strokeDashstyle;switch(t){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return t;default:var n=t.split(/[ ,]/);if(n.length==2){if(1*n[0]>=2*n[1]){return"longdash"}return n[0]==1||n[1]==1?"dot":"dash"}else if(n.length==4){return 1*n[0]>=2*n[1]?"longdashdot":"dashdot"}return"solid"}},createNode:function(e,t){var n=document.createElement(e);if(t){n.id=t}n.unselectable="on";n.onselectstart=OpenLayers.Function.False;return n},nodeTypeCompare:function(e,t){var n=t;var r=n.indexOf(":");if(r!=-1){n=n.substr(r+1)}var i=e.nodeName;r=i.indexOf(":");if(r!=-1){i=i.substr(r+1)}return n==i},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(e){return this.nodeFactory(this.container.id+e,"olv:group")},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,n){if(!isNaN(t.x)&&!isNaN(t.y)){var r=this.getResolution();e.style.left=((t.x-this.featureDx)/r-this.offset.x|0)-n+"px";e.style.top=(t.y/r-this.offset.y|0)-n+"px";var i=n*2;e.style.width=i+"px";e.style.height=i+"px";return e}return false},drawLineString:function(e,t){return this.drawLine(e,t,false)},drawLinearRing:function(e,t){return this.drawLine(e,t,true)},drawLine:function(e,t,n){this.setNodeDimension(e,t);var r=this.getResolution();var i=t.components.length;var s=new Array(i);var o,u,a;for(var f=0;f<i;f++){o=t.components[f];u=(o.x-this.featureDx)/r-this.offset.x|0;a=o.y/r-this.offset.y|0;s[f]=" "+u+","+a+" l "}var l=n?" x e":" e";e.path="m"+s.join("")+l;return e},drawPolygon:function(e,t){this.setNodeDimension(e,t);var n=this.getResolution();var r=[];var i,s,o,u,a,f,l,c,h,p,d,v;for(i=0,s=t.components.length;i<s;i++){r.push("m");o=t.components[i].components;u=i===0;a=null;f=null;for(l=0,c=o.length;l<c;l++){h=o[l];d=(h.x-this.featureDx)/n-this.offset.x|0;v=h.y/n-this.offset.y|0;p=" "+d+","+v;r.push(p);if(l==0){r.push(" l")}if(!u){if(!a){a=p}else if(a!=p){if(!f){f=p}else if(f!=p){u=true}}}}r.push(u?" x ":" ")}r.push("e");e.path=r.join("");return e},drawRectangle:function(e,t){var n=this.getResolution();e.style.left=((t.x-this.featureDx)/n-this.offset.x|0)+"px";e.style.top=(t.y/n-this.offset.y|0)+"px";e.style.width=(t.width/n|0)+"px";e.style.height=(t.height/n|0)+"px";return e},drawText:function(e,t,n){var r=this.nodeFactory(e+this.LABEL_ID_SUFFIX,"olv:rect");var i=this.nodeFactory(e+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox");var s=this.getResolution();r.style.left=((n.x-this.featureDx)/s-this.offset.x|0)+"px";r.style.top=(n.y/s-this.offset.y|0)+"px";r.style.flip="y";i.innerText=t.label;if(t.cursor!="inherit"&&t.cursor!=null){i.style.cursor=t.cursor}if(t.fontColor){i.style.color=t.fontColor}if(t.fontOpacity){i.style.filter="alpha(opacity="+t.fontOpacity*100+")"}if(t.fontFamily){i.style.fontFamily=t.fontFamily}if(t.fontSize){i.style.fontSize=t.fontSize}if(t.fontWeight){i.style.fontWeight=t.fontWeight}if(t.fontStyle){i.style.fontStyle=t.fontStyle}if(t.labelSelect===true){r._featureId=e;i._featureId=e;i._geometry=n;i._geometryClass=n.CLASS_NAME}i.style.whiteSpace="nowrap";i.inset="1px,0px,0px,0px";if(!r.parentNode){r.appendChild(i);this.textRoot.appendChild(r)}var o=t.labelAlign||"cm";if(o.length==1){o+="m"}var u=i.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[o.substr(0,1)];var a=i.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[o.substr(1,1)];r.style.left=parseInt(r.style.left)-u-1+"px";r.style.top=parseInt(r.style.top)+a+"px"},moveRoot:function(e){var t=this.map.getLayer(e.container.id);if(t instanceof OpenLayers.Layer.Vector.RootContainer){t=this.map.getLayer(this.container.id)}t&&t.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);t&&t.redraw()},importSymbol:function(e){var t=this.container.id+"-"+e;var n=this.symbolCache[t];if(n){return n}var r=OpenLayers.Renderer.symbol[e];if(!r){throw new Error(e+" is not a valid symbol name")}var i=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);var s=["m"];for(var o=0;o<r.length;o=o+2){var u=r[o];var a=r[o+1];i.left=Math.min(i.left,u);i.bottom=Math.min(i.bottom,a);i.right=Math.max(i.right,u);i.top=Math.max(i.top,a);s.push(u);s.push(a);if(o==0){s.push("l")}}s.push("x e");var f=s.join(" ");var l=(i.getWidth()-i.getHeight())/2;if(l>0){i.bottom=i.bottom-l;i.top=i.top+l}else{i.left=i.left+l;i.right=i.right-l}n={path:f,size:i.getWidth(),left:i.left,bottom:i.bottom};this.symbolCache[t]=n;return n},CLASS_NAME:"OpenLayers.Renderer.VML"});OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:.5,r:1,t:0,m:.5,b:1};OpenLayers.Animation=function(e){function s(e,t,s){t=t>0?t:Number.POSITIVE_INFINITY;var o=++r;var u=+(new Date);i[o]=function(){if(i[o]&&+(new Date)-u<=t){e();if(i[o]){n(i[o],s)}}else{delete i[o]}};n(i[o],s);return o}function o(e){delete i[e]}var t=!!(e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame);var n=function(){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,n){e.setTimeout(t,16)};return function(n,r){t.apply(e,[n,r])}}();var r=0;var i={};return{isNative:t,requestFrame:n,start:s,stop:o}}(window);OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,animationId:null,playing:false,initialize:function(e){this.easing=e?e:OpenLayers.Easing.Expo.easeOut},start:function(e,t,n,r){this.playing=true;this.begin=e;this.finish=t;this.duration=n;this.callbacks=r.callbacks;this.time=0;OpenLayers.Animation.stop(this.animationId);this.animationId=null;if(this.callbacks&&this.callbacks.start){this.callbacks.start.call(this,this.begin)}this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){if(!this.playing){return}if(this.callbacks&&this.callbacks.done){this.callbacks.done.call(this,this.finish)}OpenLayers.Animation.stop(this.animationId);this.animationId=null;this.playing=false},play:function(){var e={};for(var t in this.begin){var n=this.begin[t];var r=this.finish[t];if(n==null||r==null||isNaN(n)||isNaN(r)){throw new TypeError("invalid value for Tween")}var i=r-n;e[t]=this.easing.apply(this,[this.time,n,i,this.duration])}this.time++;if(this.callbacks&&this.callbacks.eachStep){this.callbacks.eachStep.call(this,e)}if(this.time>this.duration){this.stop()}},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(e,t,n,r){return n*e/r+t},easeOut:function(e,t,n,r){return n*e/r+t},easeInOut:function(e,t,n,r){return n*e/r+t},CLASS_NAME:"OpenLayers.Easing.Linear"};OpenLayers.Easing.Expo={easeIn:function(e,t,n,r){return e==0?t:n*Math.pow(2,10*(e/r-1))+t},easeOut:function(e,t,n,r){return e==r?t+n:n*(-Math.pow(2,-10*e/r)+1)+t},easeInOut:function(e,t,n,r){if(e==0)return t;if(e==r)return t+n;if((e/=r/2)<1)return n/2*Math.pow(2,10*(e-1))+t;return n/2*(-Math.pow(2,-10*--e)+2)+t},CLASS_NAME:"OpenLayers.Easing.Expo"};OpenLayers.Easing.Quad={easeIn:function(e,t,n,r){return n*(e/=r)*e+t},easeOut:function(e,t,n,r){return-n*(e/=r)*(e-2)+t},easeInOut:function(e,t,n,r){if((e/=r/2)<1)return n/2*e*e+t;return-n/2*(--e*(e-2)-1)+t},CLASS_NAME:"OpenLayers.Easing.Quad"};OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.id=null;this.bounds=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(e){if(e){this.bounds=e.clone()}},clearBounds:function(){this.bounds=null;if(this.parent){this.parent.clearBounds()}},extendBounds:function(e){var t=this.getBounds();if(!t){this.setBounds(e)}else{this.bounds.extend(e)}},getBounds:function(){if(this.bounds==null){this.calculateBounds()}return this.bounds},calculateBounds:function(){},distanceTo:function(e,t){},getVertices:function(e){},atPoint:function(e,t,n){var r=false;var i=this.getBounds();if(i!=null&&e!=null){var s=t!=null?t:0;var o=n!=null?n:0;var u=new OpenLayers.Bounds(this.bounds.left-s,this.bounds.bottom-o,this.bounds.right+s,this.bounds.top+o);r=u.containsLonLat(e)}return r},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){var e;if(OpenLayers.Format&&OpenLayers.Format.WKT){e=OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this))}else{e=Object.prototype.toString.call(this)}return e},CLASS_NAME:"OpenLayers.Geometry"});OpenLayers.Geometry.fromWKT=function(e){var t;if(OpenLayers.Format&&OpenLayers.Format.WKT){var n=OpenLayers.Geometry.fromWKT.format;if(!n){n=new OpenLayers.Format.WKT;OpenLayers.Geometry.fromWKT.format=n}var r=n.read(e);if(r instanceof OpenLayers.Feature.Vector){t=r.geometry}else if(OpenLayers.Util.isArray(r)){var i=r.length;var s=new Array(i);for(var o=0;o<i;++o){s[o]=r[o].geometry}t=new OpenLayers.Geometry.Collection(s)}}return t};OpenLayers.Geometry.segmentsIntersect=function(e,t,n){var r=n&&n.point;var i=n&&n.tolerance;var s=false;var o=e.x1-t.x1;var u=e.y1-t.y1;var a=e.x2-e.x1;var f=e.y2-e.y1;var l=t.y2-t.y1;var c=t.x2-t.x1;var h=l*a-c*f;var p=c*u-l*o;var d=a*u-f*o;if(h==0){if(p==0&&d==0){s=true}}else{var v=p/h;var m=d/h;if(v>=0&&v<=1&&m>=0&&m<=1){if(!r){s=true}else{var g=e.x1+v*a;var y=e.y1+v*f;s=new OpenLayers.Geometry.Point(g,y)}}}if(i){var b;if(s){if(r){var w=[e,t];var E,g,y;e:for(var S=0;S<2;++S){E=w[S];for(var x=1;x<3;++x){g=E["x"+x];y=E["y"+x];b=Math.sqrt(Math.pow(g-s.x,2)+Math.pow(y-s.y,2));if(b<i){s.x=g;s.y=y;break e}}}}}else{var w=[e,t];var T,N,g,y,C,k;e:for(var S=0;S<2;++S){T=w[S];N=w[(S+1)%2];for(var x=1;x<3;++x){C={x:T["x"+x],y:T["y"+x]};k=OpenLayers.Geometry.distanceToSegment(C,N);if(k.distance<i){if(r){s=new OpenLayers.Geometry.Point(C.x,C.y)}else{s=true}break e}}}}}return s};OpenLayers.Geometry.distanceToSegment=function(e,t){var n=e.x;var r=e.y;var i=t.x1;var s=t.y1;var o=t.x2;var u=t.y2;var a=o-i;var f=u-s;var l=(a*(n-i)+f*(r-s))/(Math.pow(a,2)+Math.pow(f,2));var c,h;if(l<=0){c=i;h=s}else if(l>=1){c=o;h=u}else{c=i+l*a;h=s+l*f}return{distance:Math.sqrt(Math.pow(c-n,2)+Math.pow(h-r,2)),x:c,y:h}};OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(e){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];if(e!=null){this.addComponents(e)}},destroy:function(){this.components.length=0;this.components=null;OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){var geometry=eval("new "+this.CLASS_NAME+"()");for(var i=0,len=this.components.length;i<len;i++){geometry.addComponent(this.components[i].clone())}OpenLayers.Util.applyDefaults(geometry,this);return geometry},getComponentsString:function(){var e=[];for(var t=0,n=this.components.length;t<n;t++){e.push(this.components[t].toShortString())}return e.join(",")},calculateBounds:function(){this.bounds=null;var e=new OpenLayers.Bounds;var t=this.components;if(t){for(var n=0,r=t.length;n<r;n++){e.extend(t[n].getBounds())}}if(e.left!=null&&e.bottom!=null&&e.right!=null&&e.top!=null){this.setBounds(e)}},addComponents:function(e){if(!OpenLayers.Util.isArray(e)){e=[e]}for(var t=0,n=e.length;t<n;t++){this.addComponent(e[t])}},addComponent:function(e,t){var n=false;if(e){if(this.componentTypes==null||OpenLayers.Util.indexOf(this.componentTypes,e.CLASS_NAME)>-1){if(t!=null&&t<this.components.length){var r=this.components.slice(0,t);var i=this.components.slice(t,this.components.length);r.push(e);this.components=r.concat(i)}else{this.components.push(e)}e.parent=this;this.clearBounds();n=true}}return n},removeComponents:function(e){var t=false;if(!OpenLayers.Util.isArray(e)){e=[e]}for(var n=e.length-1;n>=0;--n){t=this.removeComponent(e[n])||t}return t},removeComponent:function(e){OpenLayers.Util.removeItem(this.components,e);this.clearBounds();return true},getLength:function(){var e=0;for(var t=0,n=this.components.length;t<n;t++){e+=this.components[t].getLength()}return e},getArea:function(){var e=0;for(var t=0,n=this.components.length;t<n;t++){e+=this.components[t].getArea()}return e},getGeodesicArea:function(e){var t=0;for(var n=0,r=this.components.length;n<r;n++){t+=this.components[n].getGeodesicArea(e)}return t},getCentroid:function(e){if(!e){return this.components.length&&this.components[0].getCentroid()}var t=this.components.length;if(!t){return false}var n=[];var r=[];var i=0;var s=Number.MAX_VALUE;var o;for(var u=0;u<t;++u){o=this.components[u];var a=o.getArea();var f=o.getCentroid(true);if(isNaN(a)||isNaN(f.x)||isNaN(f.y)){continue}n.push(a);i+=a;s=a<s&&a>0?a:s;r.push(f)}t=n.length;if(i===0){for(var u=0;u<t;++u){n[u]=1}i=n.length}else{for(var u=0;u<t;++u){n[u]/=s}i/=s}var l=0,c=0,f,a;for(var u=0;u<t;++u){f=r[u];a=n[u];l+=f.x*a;c+=f.y*a}return new OpenLayers.Geometry.Point(l/i,c/i)},getGeodesicLength:function(e){var t=0;for(var n=0,r=this.components.length;n<r;n++){t+=this.components[n].getGeodesicLength(e)}return t},move:function(e,t){for(var n=0,r=this.components.length;n<r;n++){this.components[n].move(e,t)}},rotate:function(e,t){for(var n=0,r=this.components.length;n<r;++n){this.components[n].rotate(e,t)}},resize:function(e,t,n){for(var r=0;r<this.components.length;++r){this.components[r].resize(e,t,n)}return this},distanceTo:function(e,t){var n=!(t&&t.edge===false);var r=n&&t&&t.details;var i,s,o;var u=Number.POSITIVE_INFINITY;for(var a=0,f=this.components.length;a<f;++a){i=this.components[a].distanceTo(e,t);o=r?i.distance:i;if(o<u){u=o;s=i;if(u==0){break}}}return s},equals:function(e){var t=true;if(!e||!e.CLASS_NAME||this.CLASS_NAME!=e.CLASS_NAME){t=false}else if(!OpenLayers.Util.isArray(e.components)||e.components.length!=this.components.length){t=false}else{for(var n=0,r=this.components.length;n<r;++n){if(!this.components[n].equals(e.components[n])){t=false;break}}}return t},transform:function(e,t){if(e&&t){for(var n=0,r=this.components.length;n<r;n++){var i=this.components[n];i.transform(e,t)}this.bounds=null}return this},intersects:function(e){var t=false;for(var n=0,r=this.components.length;n<r;++n){t=e.intersects(this.components[n]);if(t){break}}return t},getVertices:function(e){var t=[];for(var n=0,r=this.components.length;n<r;++n){Array.prototype.push.apply(t,this.components[n].getVertices(e))}return t},CLASS_NAME:"OpenLayers.Geometry.Collection"});OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(e,t){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(e);this.y=parseFloat(t)},clone:function(e){if(e==null){e=new OpenLayers.Geometry.Point(this.x,this.y)}OpenLayers.Util.applyDefaults(e,this);return e},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(e,t){var n=!(t&&t.edge===false);var r=n&&t&&t.details;var i,s,o,u,a,f;if(e instanceof OpenLayers.Geometry.Point){s=this.x;o=this.y;u=e.x;a=e.y;i=Math.sqrt(Math.pow(s-u,2)+Math.pow(o-a,2));f=!r?i:{x0:s,y0:o,x1:u,y1:a,distance:i}}else{f=e.distanceTo(this,t);if(r){f={x0:f.x1,y0:f.y1,x1:f.x0,y1:f.y0,distance:f.distance}}}return f},equals:function(e){var t=false;if(e!=null){t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)}return t},toShortString:function(){return this.x+", "+this.y},move:function(e,t){this.x=this.x+e;this.y=this.y+t;this.clearBounds()},rotate:function(e,t){e*=Math.PI/180;var n=this.distanceTo(t);var r=e+Math.atan2(this.y-t.y,this.x-t.x);this.x=t.x+n*Math.cos(r);this.y=t.y+n*Math.sin(r);this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(e,t,n){n=n==undefined?1:n;this.x=t.x+e*n*(this.x-t.x);this.y=t.y+e*(this.y-t.y);this.clearBounds();return this},intersects:function(e){var t=false;if(e.CLASS_NAME=="OpenLayers.Geometry.Point"){t=this.equals(e)}else{t=e.intersects(this)}return t},transform:function(e,t){if(e&&t){OpenLayers.Projection.transform(this,e,t);this.bounds=null}return this},getVertices:function(e){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"});OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(e,t){this.addComponent(e,t)},removePoint:function(e){this.removeComponent(e)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"});OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var e=0;if(this.components&&this.components.length>1){for(var t=1,n=this.components.length;t<n;t++){e+=this.components[t-1].distanceTo(this.components[t])}}return e},getGeodesicLength:function(e){var t=this;if(e){var n=new OpenLayers.Projection("EPSG:4326");if(!n.equals(e)){t=this.clone().transform(e,n)}}var r=0;if(t.components&&t.components.length>1){var i,s;for(var o=1,u=t.components.length;o<u;o++){i=t.components[o-1];s=t.components[o];r+=OpenLayers.Util.distVincenty({lon:i.x,lat:i.y},{lon:s.x,lat:s.y})}}return r*1e3},CLASS_NAME:"OpenLayers.Geometry.Curve"});OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(e){var t=this.components&&this.components.length>2;if(t){OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments)}return t},intersects:function(e){var t=false;var n=e.CLASS_NAME;if(n=="OpenLayers.Geometry.LineString"||n=="OpenLayers.Geometry.LinearRing"||n=="OpenLayers.Geometry.Point"){var r=this.getSortedSegments();var i;if(n=="OpenLayers.Geometry.Point"){i=[{x1:e.x,y1:e.y,x2:e.x,y2:e.y}]}else{i=e.getSortedSegments()}var s,o,u,a,f,l,c,h;e:for(var p=0,d=r.length;p<d;++p){s=r[p];o=s.x1;u=s.x2;a=s.y1;f=s.y2;for(var v=0,m=i.length;v<m;++v){l=i[v];if(l.x1>u){break}if(l.x2<o){continue}c=l.y1;h=l.y2;if(Math.min(c,h)>Math.max(a,f)){continue}if(Math.max(c,h)<Math.min(a,f)){continue}if(OpenLayers.Geometry.segmentsIntersect(s,l)){t=true;break e}}}}else{t=e.intersects(this)}return t},getSortedSegments:function(){function s(e,t){return e.x1-t.x1}var e=this.components.length-1;var t=new Array(e),n,r;for(var i=0;i<e;++i){n=this.components[i];r=this.components[i+1];if(n.x<r.x){t[i]={x1:n.x,y1:n.y,x2:r.x,y2:r.y}}else{t[i]={x1:r.x,y1:r.y,x2:n.x,y2:n.y}}}return t.sort(s)},splitWithSegment:function(e,t){var n=!(t&&t.edge===false);var r=t&&t.tolerance;var i=[];var s=this.getVertices();var o=[];var u=[];var a=false;var f,l,c;var h,p,d;var v={point:true,tolerance:r};var m=null;for(var g=0,y=s.length-2;g<=y;++g){f=s[g];o.push(f.clone());l=s[g+1];d={x1:f.x,y1:f.y,x2:l.x,y2:l.y};c=OpenLayers.Geometry.segmentsIntersect(e,d,v);if(c instanceof OpenLayers.Geometry.Point){if(c.x===e.x1&&c.y===e.y1||c.x===e.x2&&c.y===e.y2||c.equals(f)||c.equals(l)){p=true}else{p=false}if(p||n){if(!c.equals(u[u.length-1])){u.push(c.clone())}if(g===0){if(c.equals(f)){continue}}if(c.equals(l)){continue}a=true;if(!c.equals(f)){o.push(c)}i.push(new OpenLayers.Geometry.LineString(o));o=[c.clone()]}}}if(a){o.push(l.clone());i.push(new OpenLayers.Geometry.LineString(o))}if(u.length>0){var b=e.x1<e.x2?1:-1;var w=e.y1<e.y2?1:-1;m={lines:i,points:u.sort(function(e,t){return b*e.x-b*t.x||w*e.y-w*t.y})}}return m},split:function(e,t){var n=null;var r=t&&t.mutual;var i,s,o,u;if(e instanceof OpenLayers.Geometry.LineString){var a=this.getVertices();var f,l,c,h,p,d;var v=[];o=[];for(var m=0,g=a.length-2;m<=g;++m){f=a[m];l=a[m+1];c={x1:f.x,y1:f.y,x2:l.x,y2:l.y};u=u||[e];if(r){v.push(f.clone())}for(var y=0;y<u.length;++y){h=u[y].splitWithSegment(c,t);if(h){p=h.lines;if(p.length>0){p.unshift(y,1);Array.prototype.splice.apply(u,p);y+=p.length-2}if(r){for(var b=0,w=h.points.length;b<w;++b){d=h.points[b];if(!d.equals(f)){v.push(d);o.push(new OpenLayers.Geometry.LineString(v));if(d.equals(l)){v=[]}else{v=[d.clone()]}}}}}}}if(r&&o.length>0&&v.length>0){v.push(l.clone());o.push(new OpenLayers.Geometry.LineString(v))}}else{n=e.splitWith(this,t)}if(u&&u.length>1){s=true}else{u=[]}if(o&&o.length>1){i=true}else{o=[]}if(s||i){if(r){n=[o,u]}else{n=u}}return n},splitWith:function(e,t){return e.split(this,t)},getVertices:function(e){var t;if(e===true){t=[this.components[0],this.components[this.components.length-1]]}else if(e===false){t=this.components.slice(1,this.components.length-1)}else{t=this.components.slice()}return t},distanceTo:function(e,t){var n=!(t&&t.edge===false);var r=n&&t&&t.details;var i,s={};var o=Number.POSITIVE_INFINITY;if(e instanceof OpenLayers.Geometry.Point){var u=this.getSortedSegments();var a=e.x;var f=e.y;var l;for(var c=0,h=u.length;c<h;++c){l=u[c];i=OpenLayers.Geometry.distanceToSegment(e,l);if(i.distance<o){o=i.distance;s=i;if(o===0){break}}else{if(l.x2>a&&(f>l.y1&&f<l.y2||f<l.y1&&f>l.y2)){break}}}if(r){s={distance:s.distance,x0:s.x,y0:s.y,x1:a,y1:f}}else{s=s.distance}}else if(e instanceof OpenLayers.Geometry.LineString){var p=this.getSortedSegments();var d=e.getSortedSegments();var v,m,g,y,b;var w=d.length;var E={point:true};e:for(var c=0,h=p.length;c<h;++c){v=p[c];y=v.x1;b=v.y1;for(var S=0;S<w;++S){m=d[S];g=OpenLayers.Geometry.segmentsIntersect(v,m,E);if(g){o=0;s={distance:0,x0:g.x,y0:g.y,x1:g.x,y1:g.y};break e}else{i=OpenLayers.Geometry.distanceToSegment({x:y,y:b},m);if(i.distance<o){o=i.distance;s={distance:o,x0:y,y0:b,x1:i.x,y1:i.y}}}}}if(!r){s=s.distance}if(o!==0){if(v){i=e.distanceTo(new OpenLayers.Geometry.Point(v.x2,v.y2),t);var x=r?i.distance:i;if(x<o){if(r){s={distance:o,x0:i.x1,y0:i.y1,x1:i.x0,y1:i.y0}}else{s=x}}}}}else{s=e.distanceTo(this,t);if(r){s={distance:s.distance,x0:s.x1,y0:s.y1,x1:s.x0,y1:s.y0}}}return s},simplify:function(e){if(this&&this!==null){var t=this.getVertices();if(t.length<3){return this}var n=function(e,t){return e-t};var r=function(e,t,n,s){var o=0;var a=0;for(var f=t,l;f<n;f++){l=i(e[t],e[n],e[f]);if(l>o){o=l;a=f}}if(o>s&&a!=t){u.push(a);r(e,t,a,s);r(e,a,n,s)}};var i=function(e,t,n){var r=Math.abs(.5*(e.x*t.y+t.x*n.y+n.x*e.y-t.x*e.y-n.x*t.y-e.x*n.y));var i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));var s=r/i*2;return s};var s=0;var o=t.length-1;var u=[];u.push(s);u.push(o);while(t[s].equals(t[o])){o--;u.push(o)}r(t,s,o,e);var a=[];u.sort(n);for(var f=0;f<u.length;f++){a.push(t[u[f]])}return new OpenLayers.Geometry.LineString(a)}else{return this}},CLASS_NAME:"OpenLayers.Geometry.LineString"});OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(e,t){var n=false;var r=this.components.pop();if(t!=null||!e.equals(r)){n=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments)}var i=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[i]);return n},removeComponent:function(e){var t=this.components&&this.components.length>3;if(t){this.components.pop();OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var n=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[n])}return t},move:function(e,t){for(var n=0,r=this.components.length;n<r-1;n++){this.components[n].move(e,t)}},rotate:function(e,t){for(var n=0,r=this.components.length;n<r-1;++n){this.components[n].rotate(e,t)}},resize:function(e,t,n){for(var r=0,i=this.components.length;r<i-1;++r){this.components[r].resize(e,t,n)}return this},transform:function(e,t){if(e&&t){for(var n=0,r=this.components.length;n<r-1;n++){var i=this.components[n];i.transform(e,t)}this.bounds=null}return this},getCentroid:function(){if(this.components&&this.components.length>2){var e=0;var t=0;for(var n=0;n<this.components.length-1;n++){var r=this.components[n];var i=this.components[n+1];e+=(r.x+i.x)*(r.x*i.y-i.x*r.y);t+=(r.y+i.y)*(r.x*i.y-i.x*r.y)}var s=-1*this.getArea();var o=e/(6*s);var u=t/(6*s);return new OpenLayers.Geometry.Point(o,u)}else{return null}},getArea:function(){var e=0;if(this.components&&this.components.length>2){var t=0;for(var n=0,r=this.components.length;n<r-1;n++){var i=this.components[n];var s=this.components[n+1];t+=(i.x+s.x)*(s.y-i.y)}e=-t/2}return e},getGeodesicArea:function(e){var t=this;if(e){var n=new OpenLayers.Projection("EPSG:4326");if(!n.equals(e)){t=this.clone().transform(e,n)}}var r=0;var i=t.components&&t.components.length;if(i>2){var s,o;for(var u=0;u<i-1;u++){s=t.components[u];o=t.components[u+1];r+=OpenLayers.Util.rad(o.x-s.x)*(2+Math.sin(OpenLayers.Util.rad(s.y))+Math.sin(OpenLayers.Util.rad(o.y)))}r=r*6378137*6378137/2}return r},containsPoint:function(e){function s(e,t,n,r,i){return(e-i)*((r-t)/(i-n))+r}var t=OpenLayers.Number.limitSigDigs;var n=14;var r=t(e.x,n);var i=t(e.y,n);var o=this.components.length-1;var u,a,f,l,c,h,p,d;var v=0;for(var m=0;m<o;++m){u=this.components[m];f=t(u.x,n);l=t(u.y,n);a=this.components[m+1];c=t(a.x,n);h=t(a.y,n);if(l==h){if(i==l){if(f<=c&&r>=f&&r<=c||f>=c&&r<=f&&r>=c){v=-1;break}}continue}p=t(s(i,f,l,c,h),n);if(p==r){if(l<h&&i>=l&&i<=h||l>h&&i<=l&&i>=h){v=-1;break}}if(p<=r){continue}if(f!=c&&(p<Math.min(f,c)||p>Math.max(f,c))){continue}if(l<h&&i>=l&&i<h||l>h&&i<l&&i>=h){++v}}var g=v==-1?1:!!(v&1);return g},intersects:function(e){var t=false;if(e.CLASS_NAME=="OpenLayers.Geometry.Point"){t=this.containsPoint(e)}else if(e.CLASS_NAME=="OpenLayers.Geometry.LineString"){t=e.intersects(this)}else if(e.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){t=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[e])}else{for(var n=0,r=e.components.length;n<r;++n){t=e.components[n].intersects(this);if(t){break}}}return t},getVertices:function(e){return e===true?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"});OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var e=0;if(this.components&&this.components.length>0){e+=Math.abs(this.components[0].getArea());for(var t=1,n=this.components.length;t<n;t++){e-=Math.abs(this.components[t].getArea())}}return e},getGeodesicArea:function(e){var t=0;if(this.components&&this.components.length>0){t+=Math.abs(this.components[0].getGeodesicArea(e));for(var n=1,r=this.components.length;n<r;n++){t-=Math.abs(this.components[n].getGeodesicArea(e))}}return t},containsPoint:function(e){var t=this.components.length;var n=false;if(t>0){n=this.components[0].containsPoint(e);if(n!==1){if(n&&t>1){var r;for(var i=1;i<t;++i){r=this.components[i].containsPoint(e);if(r){if(r===1){n=1}else{n=false}break}}}}}return n},intersects:function(e){var t=false;var n,r;if(e.CLASS_NAME=="OpenLayers.Geometry.Point"){t=this.containsPoint(e)}else if(e.CLASS_NAME=="OpenLayers.Geometry.LineString"||e.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){for(n=0,r=this.components.length;n<r;++n){t=e.intersects(this.components[n]);if(t){break}}if(!t){for(n=0,r=e.components.length;n<r;++n){t=this.containsPoint(e.components[n]);if(t){break}}}}else{for(n=0,r=e.components.length;n<r;++n){t=this.intersects(e.components[n]);if(t){break}}}if(!t&&e.CLASS_NAME=="OpenLayers.Geometry.Polygon"){var i=this.components[0];for(n=0,r=i.components.length;n<r;++n){t=e.containsPoint(i.components[n]);if(t){break}}}return t},distanceTo:function(e,t){var n=!(t&&t.edge===false);var r;if(!n&&this.intersects(e)){r=0}else{r=OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[e,t])}return r},CLASS_NAME:"OpenLayers.Geometry.Polygon"});OpenLayers.Geometry.Polygon.createRegularPolygon=function(e,t,n,r){var i=Math.PI*(1/n-1/2);if(r){i+=r/180*Math.PI}var s,o,u;var a=[];for(var f=0;f<n;++f){s=i+f*2*Math.PI/n;o=e.x+t*Math.cos(s);u=e.y+t*Math.sin(s);a.push(new OpenLayers.Geometry.Point(o,u))}var l=new OpenLayers.Geometry.LinearRing(a);return new OpenLayers.Geometry.Polygon([l])};OpenLayers.Event={observers:false,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(e){return e.target||e.srcElement},isSingleTouch:function(e){return e.touches&&e.touches.length==1},isMultiTouch:function(e){return e.touches&&e.touches.length>1},isLeftClick:function(e){return e.which&&e.which==1||e.button&&e.button==1},isRightClick:function(e){return e.which&&e.which==3||e.button&&e.button==2},stop:function(e,t){if(!t){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}}if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}},findElement:function(e,t){var n=OpenLayers.Event.element(e);while(n.parentNode&&(!n.tagName||n.tagName.toUpperCase()!=t.toUpperCase())){n=n.parentNode}return n},observe:function(e,t,n,r){var i=OpenLayers.Util.getElement(e);r=r||false;if(t=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||i.attachEvent)){t="keydown"}if(!this.observers){this.observers={}}if(!i._eventCacheID){var s="eventCacheID_";if(i.id){s=i.id+"_"+s}i._eventCacheID=OpenLayers.Util.createUniqueID(s)}var o=i._eventCacheID;if(!this.observers[o]){this.observers[o]=[]}this.observers[o].push({element:i,name:t,observer:n,useCapture:r});if(i.addEventListener){i.addEventListener(t,n,r)}else if(i.attachEvent){i.attachEvent("on"+t,n)}},stopObservingElement:function(e){var t=OpenLayers.Util.getElement(e);var n=t._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[n])},_removeElementObservers:function(e){if(e){for(var t=e.length-1;t>=0;t--){var n=e[t];var r=new Array(n.element,n.name,n.observer,n.useCapture);var i=OpenLayers.Event.stopObserving.apply(this,r)}}},stopObserving:function(e,t,n,r){r=r||false;var i=OpenLayers.Util.getElement(e);var s=i._eventCacheID;if(t=="keypress"){if(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||i.detachEvent){t="keydown"}}var o=false;var u=OpenLayers.Event.observers[s];if(u){var a=0;while(!o&&a<u.length){var f=u[a];if(f.name==t&&f.observer==n&&f.useCapture==r){u.splice(a,1);if(u.length==0){delete OpenLayers.Event.observers[s]}o=true;break}a++}}if(o){if(i.removeEventListener){i.removeEventListener(t,n,r)}else if(i&&i.detachEvent){i.detachEvent("on"+t,n)}}return o},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var e in OpenLayers.Event.observers){var t=OpenLayers.Event.observers[e];OpenLayers.Event._removeElementObservers.apply(this,[t])}OpenLayers.Event.observers=false}},CLASS_NAME:"OpenLayers.Event"};OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,false);OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown"],listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:false,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(e,t,n,r,i){OpenLayers.Util.extend(this,i);this.object=e;this.fallThrough=r;this.listeners={};this.extensions={};this.extensionCount={};if(t!=null){this.attachToElement(t)}},destroy:function(){for(var e in this.extensions){if(typeof this.extensions[e]!=="boolean"){this.extensions[e].destroy()}}this.extensions=null;if(this.element){OpenLayers.Event.stopObservingElement(this.element);if(this.element.hasScrollEvent){OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)}}this.element=null;this.listeners=null;this.object=null;this.fallThrough=null;this.eventHandler=null},addEventType:function(e){},attachToElement:function(e){if(this.element){OpenLayers.Event.stopObservingElement(this.element)}else{this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this);this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this)}this.element=e;for(var t=0,n=this.BROWSER_EVENTS.length;t<n;t++){OpenLayers.Event.observe(e,this.BROWSER_EVENTS[t],this.eventHandler)}OpenLayers.Event.observe(e,"dragstart",OpenLayers.Event.stop)},on:function(e){for(var t in e){if(t!="scope"&&e.hasOwnProperty(t)){this.register(t,e.scope,e[t])}}},register:function(e,t,n,r){if(e in OpenLayers.Events&&!this.extensions[e]){this.extensions[e]=new OpenLayers.Events[e](this)}if(n!=null){if(t==null){t=this.object}var i=this.listeners[e];if(!i){i=[];this.listeners[e]=i;this.extensionCount[e]=0}var s={obj:t,func:n};if(r){i.splice(this.extensionCount[e],0,s);if(typeof r==="object"&&r.extension){this.extensionCount[e]++}}else{i.push(s)}}},registerPriority:function(e,t,n){this.register(e,t,n,true)},un:function(e){for(var t in e){if(t!="scope"&&e.hasOwnProperty(t)){this.unregister(t,e.scope,e[t])}}},unregister:function(e,t,n){if(t==null){t=this.object}var r=this.listeners[e];if(r!=null){for(var i=0,s=r.length;i<s;i++){if(r[i].obj==t&&r[i].func==n){r.splice(i,1);break}}}},remove:function(e){if(this.listeners[e]!=null){this.listeners[e]=[]}},triggerEvent:function(e,t){var n=this.listeners[e];if(!n||n.length==0){return undefined}if(t==null){t={}}t.object=this.object;t.element=this.element;if(!t.type){t.type=e}n=n.slice();var r;for(var i=0,s=n.length;i<s;i++){var o=n[i];r=o.func.apply(o.obj,[t]);if(r!=undefined&&r==false){break}}if(!this.fallThrough){OpenLayers.Event.stop(t,true)}return r},handleBrowserEvent:function(e){var t=e.type,n=this.listeners[t];if(!n||n.length==0){return}var r=e.touches;if(r&&r[0]){var i=0;var s=0;var o=r.length;var u;for(var a=0;a<o;++a){u=r[a];i+=u.clientX;s+=u.clientY}e.clientX=i/o;e.clientY=s/o}if(this.includeXY){e.xy=this.getMousePosition(e)}this.triggerEvent(t,e)},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;var e=document.body;if(e&&!((e.scrollTop!=0||e.scrollLeft!=0)&&navigator.userAgent.match(/iPhone/i))){this.element.offsets=null}},getMousePosition:function(e){if(!this.includeXY){this.clearMouseCache()}else if(!this.element.hasScrollEvent){OpenLayers.Event.observe(window,"scroll",this.clearMouseListener);this.element.hasScrollEvent=true}if(!this.element.scrolls){var t=OpenLayers.Util.getViewportElement();this.element.scrolls=[t.scrollLeft,t.scrollTop]}if(!this.element.lefttop){this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]}if(!this.element.offsets){this.element.offsets=OpenLayers.Util.pagePosition(this.element)}return new OpenLayers.Pixel(e.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],e.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"});OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(e,t){OpenLayers.Util.extend(this,t);this.projCode=e;if(window.Proj4js){this.proj=new Proj4js.Proj(e)}},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(e){var t=e,n=false;if(t){if(!(t instanceof OpenLayers.Projection)){t=new OpenLayers.Projection(t)}if(window.Proj4js&&this.proj.defData&&t.proj.defData){n=this.proj.defData.replace(this.titleRegEx,"")==t.proj.defData.replace(this.titleRegEx,"")}else if(t.getCode){var r=this.getCode(),i=t.getCode();n=r==i||!!OpenLayers.Projection.transforms[r]&&OpenLayers.Projection.transforms[r][i]===OpenLayers.Projection.nullTransform}}return n},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={};OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:true},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-20037508.34,-20037508.34,20037508.34,20037508.34]}};OpenLayers.Projection.addTransform=function(e,t,n){if(n===OpenLayers.Projection.nullTransform){var r=OpenLayers.Projection.defaults[e];if(r&&!OpenLayers.Projection.defaults[t]){OpenLayers.Projection.defaults[t]=r}}if(!OpenLayers.Projection.transforms[e]){OpenLayers.Projection.transforms[e]={}}OpenLayers.Projection.transforms[e][t]=n};OpenLayers.Projection.transform=function(e,t,n){if(t&&n){if(!(t instanceof OpenLayers.Projection)){t=new OpenLayers.Projection(t)}if(!(n instanceof OpenLayers.Projection)){n=new OpenLayers.Projection(n)}if(t.proj&&n.proj){e=Proj4js.transform(t.proj,n.proj,e)}else{var r=t.getCode();var i=n.getCode();var s=OpenLayers.Projection.transforms;if(s[r]&&s[r][i]){s[r][i](e)}}}return e};OpenLayers.Projection.nullTransform=function(e){return e};(function(){function t(t){t.x=180*t.x/e;t.y=180/Math.PI*(2*Math.atan(Math.exp(t.y/e*Math.PI))-Math.PI/2);return t}function n(t){t.x=t.x*e/180;t.y=Math.log(Math.tan((90+t.y)*Math.PI/360))/Math.PI*e;return t}function r(e,r){var i=OpenLayers.Projection.addTransform;var s=OpenLayers.Projection.nullTransform;var o,u,a,f,l;for(o=0,u=r.length;o<u;++o){a=r[o];i(e,a,n);i(a,e,t);for(l=o+1;l<u;++l){f=r[l];i(a,f,s);i(f,a,s)}}}var e=20037508.34;var i=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],s=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"],o;for(o=i.length-1;o>=0;--o){r(i[o],s)}for(o=s.length-1;o>=0;--o){r(s[o],i)}})();OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1e3},id:null,fractionalZoom:false,events:null,allOverlays:false,div:null,dragging:false,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:true,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,minPx:null,maxPx:null,initialize:function(e,t){if(arguments.length===1&&typeof e==="object"){t=e;e=t&&t.div}this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css";this.options=OpenLayers.Util.extend({},t);OpenLayers.Util.extend(this,t);var n=this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection;OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[n]);if(this.maxExtent&&!(this.maxExtent instanceof OpenLayers.Bounds)){this.maxExtent=new OpenLayers.Bounds(this.maxExtent)}if(this.minExtent&&!(this.minExtent instanceof OpenLayers.Bounds)){this.minExtent=new OpenLayers.Bounds(this.minExtent)}if(this.restrictedExtent&&!(this.restrictedExtent instanceof OpenLayers.Bounds)){this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent)}if(this.center&&!(this.center instanceof OpenLayers.LonLat)){this.center=new OpenLayers.LonLat(this.center)}this.layers=[];this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(e);if(!this.div){this.div=document.createElement("div");this.div.style.height="1px";this.div.style.width="1px"}OpenLayers.Element.addClass(this.div,"olMap");var r=this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(r,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:true});r=this.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(r);this.layerContainerDiv.style.width="100px";this.layerContainerDiv.style.height="100px";this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE["Popup"]-1;this.viewPortDiv.appendChild(this.layerContainerDiv);this.updateSize();if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}if(parseFloat(navigator.appVersion.split("MSIE")[1])<9){this.events.register("resize",this,this.updateSize)}else{this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this);OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy)}if(this.theme){var i=true;var s=document.getElementsByTagName("link");for(var o=0,u=s.length;o<u;++o){if(OpenLayers.Util.isEquivalentUrl(s.item(o).href,this.theme)){i=false;break}}if(i){var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",this.theme);document.getElementsByTagName("head")[0].appendChild(a)}}if(this.controls==null){this.controls=[];if(OpenLayers.Control!=null){if(OpenLayers.Control.Navigation){this.controls.push(new OpenLayers.Control.Navigation)}else if(OpenLayers.Control.TouchNavigation){this.controls.push(new OpenLayers.Control.TouchNavigation)}if(OpenLayers.Control.Zoom){this.controls.push(new OpenLayers.Control.Zoom)}else if(OpenLayers.Control.PanZoom){this.controls.push(new OpenLayers.Control.PanZoom)}if(OpenLayers.Control.ArgParser){this.controls.push(new OpenLayers.Control.ArgParser)}if(OpenLayers.Control.Attribution){this.controls.push(new OpenLayers.Control.Attribution)}}}for(var o=0,u=this.controls.length;o<u;o++){this.addControlToMap(this.controls[o])}this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,"unload",this.unloadDestroy);if(t&&t.layers){delete this.center;this.addLayers(t.layers);if(t.center&&!this.getCenter()){this.setCenter(t.center,t.zoom)}}},getViewport:function(){return this.viewPortDiv},render:function(e){this.div=OpenLayers.Util.getElement(e);OpenLayers.Element.addClass(this.div,"olMap");this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy){return false}if(this.panTween){this.panTween.stop();this.panTween=null}OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;if(this.updateSizeDestroy){OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy)}else{this.events.unregister("resize",this,this.updateSize)}this.paddingForPopups=null;if(this.controls!=null){for(var e=this.controls.length-1;e>=0;--e){this.controls[e].destroy()}this.controls=null}if(this.layers!=null){for(var e=this.layers.length-1;e>=0;--e){this.layers[e].destroy(false)}this.layers=null}if(this.viewPortDiv){this.div.removeChild(this.viewPortDiv)}this.viewPortDiv=null;if(this.eventListeners){this.events.un(this.eventListeners);this.eventListeners=null}this.events.destroy();this.events=null;this.options=null},setOptions:function(e){var t=this.minPx&&e.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,e);t&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:true})},getTileSize:function(){return this.tileSize},getBy:function(e,t,n){var r=typeof n.test=="function";var i=OpenLayers.Array.filter(this[e],function(e){return e[t]==n||r&&n.test(e[t])});return i},getLayersBy:function(e,t){return this.getBy("layers",e,t)},getLayersByName:function(e){return this.getLayersBy("name",e)},getLayersByClass:function(e){return this.getLayersBy("CLASS_NAME",e)},getControlsBy:function(e,t){return this.getBy("controls",e,t)},getControlsByClass:function(e){return this.getControlsBy("CLASS_NAME",e)},getLayer:function(e){var t=null;for(var n=0,r=this.layers.length;n<r;n++){var i=this.layers[n];if(i.id==e){t=i;break}}return t},setLayerZIndex:function(e,t){e.setZIndex(this.Z_INDEX_BASE[e.isBaseLayer?"BaseLayer":"Overlay"]+t*5)},resetLayersZIndex:function(){for(var e=0,t=this.layers.length;e<t;e++){var n=this.layers[e];this.setLayerZIndex(n,e)}},addLayer:function(e){for(var t=0,n=this.layers.length;t<n;t++){if(this.layers[t]==e){return false}}if(this.events.triggerEvent("preaddlayer",{layer:e})===false){return false}if(this.allOverlays){e.isBaseLayer=false}e.div.className="olLayerDiv";e.div.style.overflow="";this.setLayerZIndex(e,this.layers.length);if(e.isFixed){this.viewPortDiv.appendChild(e.div)}else{this.layerContainerDiv.appendChild(e.div)}this.layers.push(e);e.setMap(this);if(e.isBaseLayer||this.allOverlays&&!this.baseLayer){if(this.baseLayer==null){this.setBaseLayer(e)}else{e.setVisibility(false)}}else{e.redraw()}this.events.triggerEvent("addlayer",{layer:e});e.events.triggerEvent("added",{map:this,layer:e});e.afterAdd();return true},addLayers:function(e){for(var t=0,n=e.length;t<n;t++){this.addLayer(e[t])}},removeLayer:function(e,t){if(this.events.triggerEvent("preremovelayer",{layer:e})===false){return}if(t==null){t=true}if(e.isFixed){this.viewPortDiv.removeChild(e.div)}else{this.layerContainerDiv.removeChild(e.div)}OpenLayers.Util.removeItem(this.layers,e);e.removeMap(this);e.map=null;if(this.baseLayer==e){this.baseLayer=null;if(t){for(var n=0,r=this.layers.length;n<r;n++){var i=this.layers[n];if(i.isBaseLayer||this.allOverlays){this.setBaseLayer(i);break}}}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:e});e.events.triggerEvent("removed",{map:this,layer:e})},getNumLayers:function(){return this.layers.length},getLayerIndex:function(e){return OpenLayers.Util.indexOf(this.layers,e)},setLayerIndex:function(e,t){var n=this.getLayerIndex(e);if(t<0){t=0}else if(t>this.layers.length){t=this.layers.length}if(n!=t){this.layers.splice(n,1);this.layers.splice(t,0,e);for(var r=0,i=this.layers.length;r<i;r++){this.setLayerZIndex(this.layers[r],r)}this.events.triggerEvent("changelayer",{layer:e,property:"order"});if(this.allOverlays){if(t===0){this.setBaseLayer(e)}else if(this.baseLayer!==this.layers[0]){this.setBaseLayer(this.layers[0])}}}},raiseLayer:function(e,t){var n=this.getLayerIndex(e)+t;this.setLayerIndex(e,n)},setBaseLayer:function(e){if(e!=this.baseLayer){if(OpenLayers.Util.indexOf(this.layers,e)!=-1){var t=this.getCachedCenter();var n=OpenLayers.Util.getResolutionFromScale(this.getScale(),e.units);if(this.baseLayer!=null&&!this.allOverlays){this.baseLayer.setVisibility(false)}this.baseLayer=e;if(!this.allOverlays||this.baseLayer.visibility){this.baseLayer.setVisibility(true);if(this.baseLayer.inRange===false){this.baseLayer.redraw()}}if(t!=null){var r=this.getZoomForResolution(n||this.resolution,true);this.setCenter(t,r,false,true)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}}},addControl:function(e,t){this.controls.push(e);this.addControlToMap(e,t)},addControls:function(e,t){var n=arguments.length===1?[]:t;for(var r=0,i=e.length;r<i;r++){var s=e[r];var o=n[r]?n[r]:null;this.addControl(s,o)}},addControlToMap:function(e,t){e.outsideViewport=e.div!=null;if(this.displayProjection&&!e.displayProjection){e.displayProjection=this.displayProjection}e.setMap(this);var n=e.draw(t);if(n){if(!e.outsideViewport){n.style.zIndex=this.Z_INDEX_BASE["Control"]+this.controls.length;this.viewPortDiv.appendChild(n)}}if(e.autoActivate){e.activate()}},getControl:function(e){var t=null;for(var n=0,r=this.controls.length;n<r;n++){var i=this.controls[n];if(i.id==e){t=i;break}}return t},removeControl:function(e){if(e&&e==this.getControl(e.id)){if(e.div&&e.div.parentNode==this.viewPortDiv){this.viewPortDiv.removeChild(e.div)}OpenLayers.Util.removeItem(this.controls,e)}},addPopup:function(e,t){if(t){for(var n=this.popups.length-1;n>=0;--n){this.removePopup(this.popups[n])}}e.map=this;this.popups.push(e);var r=e.draw();if(r){r.style.zIndex=this.Z_INDEX_BASE["Popup"]+this.popups.length;this.layerContainerDiv.appendChild(r)}},removePopup:function(e){OpenLayers.Util.removeItem(this.popups,e);if(e.div){try{this.layerContainerDiv.removeChild(e.div)}catch(t){}}e.map=null},getSize:function(){var e=null;if(this.size!=null){e=this.size.clone()}return e},updateSize:function(){var e=this.getCurrentSize();if(e&&!isNaN(e.h)&&!isNaN(e.w)){this.events.clearMouseCache();var t=this.getSize();if(t==null){this.size=t=e}if(!e.equals(t)){this.size=e;for(var n=0,r=this.layers.length;n<r;n++){this.layers[n].onMapResize()}var i=this.getCachedCenter();if(this.baseLayer!=null&&i!=null){var s=this.getZoom();this.zoom=null;this.setCenter(i,s)}}}},getCurrentSize:function(){var e=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(e.w==0&&e.h==0||isNaN(e.w)&&isNaN(e.h)){e.w=this.div.offsetWidth;e.h=this.div.offsetHeight}if(e.w==0&&e.h==0||isNaN(e.w)&&isNaN(e.h)){e.w=parseInt(this.div.style.width);e.h=parseInt(this.div.style.height)}return e},calculateBounds:function(e,t){var n=null;if(e==null){e=this.getCachedCenter()}if(t==null){t=this.getResolution()}if(e!=null&&t!=null){var r=this.size.w*t/2;var i=this.size.h*t/2;n=new OpenLayers.Bounds(e.lon-r,e.lat-i,e.lon+r,e.lat+i)}return n},getCenter:function(){var e=null;var t=this.getCachedCenter();if(t){e=t.clone()}return e},getCachedCenter:function(){if(!this.center&&this.size){this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2})}return this.center},getZoom:function(){return this.zoom},pan:function(e,t,n){n=OpenLayers.Util.applyDefaults(n,{animate:true,dragging:false});if(n.dragging){if(e!=0||t!=0){this.moveByPx(e,t)}}else{var r=this.getViewPortPxFromLonLat(this.getCachedCenter());var i=r.add(e,t);if(this.dragging||!i.equals(r)){var s=this.getLonLatFromViewPortPx(i);if(n.animate){this.panTo(s)}else{this.moveTo(s);if(this.dragging){this.dragging=false;this.events.triggerEvent("moveend")}}}}},panTo:function(e){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(e)){if(!this.panTween){this.panTween=new OpenLayers.Tween(this.panMethod)}var t=this.getCachedCenter();if(e.equals(t)){return}var n=this.getPixelFromLonLat(t);var r=this.getPixelFromLonLat(e);var i={x:r.x-n.x,y:r.y-n.y};var s={x:0,y:0};this.panTween.start({x:0,y:0},i,this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(e){var t=e.x-s.x,n=e.y-s.y;this.moveByPx(t,n);s.x=Math.round(e.x);s.y=Math.round(e.y)},this),done:OpenLayers.Function.bind(function(t){this.moveTo(e);this.dragging=false;this.events.triggerEvent("moveend")},this)}})}else{this.setCenter(e)}},setCenter:function(e,t,n,r){this.panTween&&this.panTween.stop();this.moveTo(e,t,{dragging:n,forceZoomChange:r})},moveByPx:function(e,t){var n=this.size.w/2;var r=this.size.h/2;var i=n+e;var s=r+t;var o=this.baseLayer.wrapDateLine;var u=0;var a=0;if(this.restrictedExtent){u=n;a=r;o=false}e=o||i<=this.maxPx.x-u&&i>=this.minPx.x+u?Math.round(e):0;t=s<=this.maxPx.y-a&&s>=this.minPx.y+a?Math.round(t):0;if(e||t){if(!this.dragging){this.dragging=true;this.events.triggerEvent("movestart")}this.center=null;if(e){this.layerContainerDiv.style.left=parseInt(this.layerContainerDiv.style.left)-e+"px";this.minPx.x-=e;this.maxPx.x-=e}if(t){this.layerContainerDiv.style.top=parseInt(this.layerContainerDiv.style.top)-t+"px";this.minPx.y-=t;this.maxPx.y-=t}var f,l,c;for(l=0,c=this.layers.length;l<c;++l){f=this.layers[l];if(f.visibility&&(f===this.baseLayer||f.inRange)){f.moveByPx(e,t);f.events.triggerEvent("move")}}this.events.triggerEvent("move")}},adjustZoom:function(e){var t,n=this.baseLayer.resolutions,r=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(e)>r){for(var i=e|0,s=n.length;i<s;++i){if(n[i]<=r){e=i;break}}}return e},moveTo:function(e,t,n){if(e!=null&&!(e instanceof OpenLayers.LonLat)){e=new OpenLayers.LonLat(e)}if(!n){n={}}if(t!=null){t=parseFloat(t);if(!this.fractionalZoom){t=Math.round(t)}}if(this.baseLayer.wrapDateLine){var r=t;t=this.adjustZoom(t);if(t!==r){e=this.getCenter()}}var i=n.dragging||this.dragging;var s=n.forceZoomChange;if(!this.getCachedCenter()&&!this.isValidLonLat(e)){e=this.maxExtent.getCenterLonLat();this.center=e.clone()}if(this.restrictedExtent!=null){if(e==null){e=this.center}if(t==null){t=this.getZoom()}var o=this.getResolutionForZoom(t);var u=this.calculateBounds(e,o);if(!this.restrictedExtent.containsBounds(u)){var a=this.restrictedExtent.getCenterLonLat();if(u.getWidth()>this.restrictedExtent.getWidth()){e=new OpenLayers.LonLat(a.lon,e.lat)}else if(u.left<this.restrictedExtent.left){e=e.add(this.restrictedExtent.left-u.left,0)}else if(u.right>this.restrictedExtent.right){e=e.add(this.restrictedExtent.right-u.right,0)}if(u.getHeight()>this.restrictedExtent.getHeight()){e=new OpenLayers.LonLat(e.lon,a.lat)}else if(u.bottom<this.restrictedExtent.bottom){e=e.add(0,this.restrictedExtent.bottom-u.bottom)}else if(u.top>this.restrictedExtent.top){e=e.add(0,this.restrictedExtent.top-u.top)}}}var f=s||this.isValidZoomLevel(t)&&t!=this.getZoom();var l=this.isValidLonLat(e)&&!e.equals(this.center);if(f||l||i){i||this.events.triggerEvent("movestart");if(l){if(!f&&this.center){this.centerLayerContainer(e)}this.center=e.clone()}var c=f?this.getResolutionForZoom(t):this.getResolution();if(f||this.layerContainerOrigin==null){this.layerContainerOrigin=this.getCachedCenter();this.layerContainerDiv.style.left="0px";this.layerContainerDiv.style.top="0px";var h=this.getMaxExtent({restricted:true});var p=h.getCenterLonLat();var d=this.center.lon-p.lon;var v=p.lat-this.center.lat;var m=Math.round(h.getWidth()/c);var g=Math.round(h.getHeight()/c);this.minPx={x:(this.size.w-m)/2-d/c,y:(this.size.h-g)/2-v/c};this.maxPx={x:this.minPx.x+Math.round(h.getWidth()/c),y:this.minPx.y+Math.round(h.getHeight()/c)}}if(f){this.zoom=t;this.resolution=c}var y=this.getExtent();if(this.baseLayer.visibility){this.baseLayer.moveTo(y,f,n.dragging);n.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:f})}y=this.baseLayer.getExtent();for(var b=this.layers.length-1;b>=0;--b){var w=this.layers[b];if(w!==this.baseLayer&&!w.isBaseLayer){var E=w.calculateInRange();if(w.inRange!=E){w.inRange=E;if(!E){w.display(false)}this.events.triggerEvent("changelayer",{layer:w,property:"visibility"})}if(E&&w.visibility){w.moveTo(y,f,n.dragging);n.dragging||w.events.triggerEvent("moveend",{zoomChanged:f})}}}this.events.triggerEvent("move");i||this.events.triggerEvent("moveend");if(f){for(var b=0,S=this.popups.length;b<S;b++){this.popups[b].updatePosition()}this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(e){var t=this.getViewPortPxFromLonLat(this.layerContainerOrigin);var n=this.getViewPortPxFromLonLat(e);if(t!=null&&n!=null){var r=parseInt(this.layerContainerDiv.style.left);var i=parseInt(this.layerContainerDiv.style.top);var s=Math.round(t.x-n.x);var o=Math.round(t.y-n.y);this.layerContainerDiv.style.left=s+"px";this.layerContainerDiv.style.top=o+"px";var u=r-s;var a=i-o;this.minPx.x-=u;this.maxPx.x-=u;this.minPx.y-=a;this.maxPx.y-=a}},isValidZoomLevel:function(e){return e!=null&&e>=0&&e<this.getNumZoomLevels()},isValidLonLat:function(e){var t=false;if(e!=null){var n=this.getMaxExtent();var r=this.baseLayer.wrapDateLine&&n;t=n.containsLonLat(e,{worldBounds:r})}return t},getProjection:function(){var e=this.getProjectionObject();return e?e.getCode():null},getProjectionObject:function(){var e=null;if(this.baseLayer!=null){e=this.baseLayer.projection}return e},getMaxResolution:function(){var e=null;if(this.baseLayer!=null){e=this.baseLayer.maxResolution}return e},getMaxExtent:function(e){var t=null;if(e&&e.restricted&&this.restrictedExtent){t=this.restrictedExtent}else if(this.baseLayer!=null){t=this.baseLayer.maxExtent}return t},getNumZoomLevels:function(){var e=null;if(this.baseLayer!=null){e=this.baseLayer.numZoomLevels}return e},getExtent:function(){var e=null;if(this.baseLayer!=null){e=this.baseLayer.getExtent()}return e},getResolution:function(){var e=null;if(this.baseLayer!=null){e=this.baseLayer.getResolution()}else if(this.allOverlays===true&&this.layers.length>0){e=this.layers[0].getResolution()}return e},getUnits:function(){var e=null;if(this.baseLayer!=null){e=this.baseLayer.units}return e},getScale:function(){var e=null;if(this.baseLayer!=null){var t=this.getResolution();var n=this.baseLayer.units;e=OpenLayers.Util.getScaleFromResolution(t,n)}return e},getZoomForExtent:function(e,t){var n=null;if(this.baseLayer!=null){n=this.baseLayer.getZoomForExtent(e,t)}return n},getResolutionForZoom:function(e){var t=null;if(this.baseLayer){t=this.baseLayer.getResolutionForZoom(e)}return t},getZoomForResolution:function(e,t){var n=null;if(this.baseLayer!=null){n=this.baseLayer.getZoomForResolution(e,t)}return n},zoomTo:function(e){if(this.isValidZoomLevel(e)){this.setCenter(null,e)}},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(e,t){if(!(e instanceof OpenLayers.Bounds)){e=new OpenLayers.Bounds(e)}var n=e.getCenterLonLat();if(this.baseLayer.wrapDateLine){var r=this.getMaxExtent();e=e.clone();while(e.right<e.left){e.right+=r.getWidth()}n=e.getCenterLonLat().wrapDateLine(r)}this.setCenter(n,this.getZoomForExtent(e,t))},zoomToMaxExtent:function(e){var t=e?e.restricted:true;var n=this.getMaxExtent({restricted:t});this.zoomToExtent(n)},zoomToScale:function(e,t){var n=OpenLayers.Util.getResolutionFromScale(e,this.baseLayer.units);var r=this.size.w*n/2;var i=this.size.h*n/2;var s=this.getCachedCenter();var o=new OpenLayers.Bounds(s.lon-r,s.lat-i,s.lon+r,s.lat+i);this.zoomToExtent(o,t)},getLonLatFromViewPortPx:function(e){var t=null;if(this.baseLayer!=null){t=this.baseLayer.getLonLatFromViewPortPx(e)}return t},getViewPortPxFromLonLat:function(e){var t=null;if(this.baseLayer!=null){t=this.baseLayer.getViewPortPxFromLonLat(e)}return t},getLonLatFromPixel:function(e){return this.getLonLatFromViewPortPx(e)},getPixelFromLonLat:function(e){var t=this.getViewPortPxFromLonLat(e);t.x=Math.round(t.x);t.y=Math.round(t.y);return t},getGeodesicPixelSize:function(e){var t=e?this.getLonLatFromPixel(e):this.getCachedCenter()||new OpenLayers.LonLat(0,0);var n=this.getResolution();var r=t.add(-n/2,0);var i=t.add(n/2,0);var s=t.add(0,-n/2);var o=t.add(0,n/2);var u=new OpenLayers.Projection("EPSG:4326");var a=this.getProjectionObject()||u;if(!a.equals(u)){r.transform(a,u);i.transform(a,u);s.transform(a,u);o.transform(a,u)}return new OpenLayers.Size(OpenLayers.Util.distVincenty(r,i),OpenLayers.Util.distVincenty(s,o))},getViewPortPxFromLayerPx:function(e){var t=null;if(e!=null){var n=parseInt(this.layerContainerDiv.style.left);var r=parseInt(this.layerContainerDiv.style.top);t=e.add(n,r)}return t},getLayerPxFromViewPortPx:function(e){var t=null;if(e!=null){var n=-parseInt(this.layerContainerDiv.style.left);var r=-parseInt(this.layerContainerDiv.style.top);t=e.add(n,r);if(isNaN(t.x)||isNaN(t.y)){t=null}}return t},getLonLatFromLayerPx:function(e){e=this.getViewPortPxFromLayerPx(e);return this.getLonLatFromViewPortPx(e)},getLayerPxFromLonLat:function(e){var t=this.getPixelFromLonLat(e);return this.getLayerPxFromViewPortPx(t)},CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:["scales","resolutions","maxScale","minScale","maxResolution","minResolution","numZoomLevels","maxZoomLevel"],events:null,map:null,isBaseLayer:false,alpha:false,displayInLayerSwitcher:true,visibility:true,attribution:null,inRange:false,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:false,wrapDateLine:false,metadata:null,initialize:function(e,t){this.metadata={};this.addOptions(t);this.name=e;if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_");this.div=OpenLayers.Util.createDiv(this.id);this.div.style.width="100%";this.div.style.height="100%";this.div.dir="ltr";this.events=new OpenLayers.Events(this,this.div);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}}},destroy:function(e){if(e==null){e=true}if(this.map!=null){this.map.removeLayer(this,e)}this.projection=null;this.map=null;this.name=null;this.div=null;this.options=null;if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy()}this.eventListeners=null;this.events=null},clone:function(e){if(e==null){e=new OpenLayers.Layer(this.name,this.getOptions())}OpenLayers.Util.applyDefaults(e,this);e.map=null;return e},getOptions:function(){var e={};for(var t in this.options){e[t]=this[t]}return e},setName:function(e){if(e!=this.name){this.name=e;if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"name"})}}},addOptions:function(e,t){if(this.options==null){this.options={}}if(e){if(typeof e.projection=="string"){e.projection=new OpenLayers.Projection(e.projection)}if(e.projection){OpenLayers.Util.applyDefaults(e,OpenLayers.Projection.defaults[e.projection.getCode()])}if(e.maxExtent&&!(e.maxExtent instanceof OpenLayers.Bounds)){e.maxExtent=new OpenLayers.Bounds(e.maxExtent)}if(e.minExtent&&!(e.minExtent instanceof OpenLayers.Bounds)){e.minExtent=new OpenLayers.Bounds(e.minExtent)}}OpenLayers.Util.extend(this.options,e);OpenLayers.Util.extend(this,e);if(this.projection&&this.projection.getUnits()){this.units=this.projection.getUnits()}if(this.map){var n=this.map.getResolution();var r=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]);for(var i in e){if(e.hasOwnProperty(i)&&OpenLayers.Util.indexOf(r,i)>=0){this.initResolutions();if(t&&this.map.baseLayer===this){this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(n),false,true);this.map.events.triggerEvent("changebaselayer",{layer:this})}break}}}},onMapResize:function(){},redraw:function(){var e=false;if(this.map){this.inRange=this.calculateInRange();var t=this.getExtent();if(t&&this.inRange&&this.visibility){var n=true;this.moveTo(t,n,false);this.events.triggerEvent("moveend",{zoomChanged:n});e=true}}return e},moveTo:function(e,t,n){var r=this.visibility;if(!this.isBaseLayer){r=r&&this.inRange}this.display(r)},moveByPx:function(e,t){},setMap:function(e){if(this.map==null){this.map=e;this.maxExtent=this.maxExtent||this.map.maxExtent;this.minExtent=this.minExtent||this.map.minExtent;this.projection=this.projection||this.map.projection;if(typeof this.projection=="string"){this.projection=new OpenLayers.Projection(this.projection)}this.units=this.projection.getUnits()||this.units||this.map.units;this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();var t=this.visibility&&this.inRange;this.div.style.display=t?"":"none"}this.setTileSize()}},afterAdd:function(){},removeMap:function(e){},getImageSize:function(e){return this.imageSize||this.tileSize},setTileSize:function(e){var t=e?e:this.tileSize?this.tileSize:this.map.getTileSize();this.tileSize=t;if(this.gutter){this.imageSize=new OpenLayers.Size(t.w+2*this.gutter,t.h+2*this.gutter)}},getVisibility:function(){return this.visibility},setVisibility:function(e){if(e!=this.visibility){this.visibility=e;this.display(e);this.redraw();if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"})}this.events.triggerEvent("visibilitychanged")}},display:function(e){if(e!=(this.div.style.display!="none")){this.div.style.display=e&&this.calculateInRange()?"block":"none"}},calculateInRange:function(){var e=false;if(this.alwaysInRange){e=true}else{if(this.map){var t=this.map.getResolution();e=t>=this.minResolution&&t<=this.maxResolution}}return e},setIsBaseLayer:function(e){if(e!=this.isBaseLayer){this.isBaseLayer=e;if(this.map!=null){this.map.events.triggerEvent("changebaselayer",{layer:this})}}},initResolutions:function(){var e,t,n;var r={},i=true;for(e=0,t=this.RESOLUTION_PROPERTIES.length;e<t;e++){n=this.RESOLUTION_PROPERTIES[e];r[n]=this.options[n];if(i&&this.options[n]){i=false}}if(this.alwaysInRange==null){this.alwaysInRange=i}if(r.resolutions==null){r.resolutions=this.resolutionsFromScales(r.scales)}if(r.resolutions==null){r.resolutions=this.calculateResolutions(r)}if(r.resolutions==null){for(e=0,t=this.RESOLUTION_PROPERTIES.length;e<t;e++){n=this.RESOLUTION_PROPERTIES[e];r[n]=this.options[n]!=null?this.options[n]:this.map[n]}if(r.resolutions==null){r.resolutions=this.resolutionsFromScales(r.scales)}if(r.resolutions==null){r.resolutions=this.calculateResolutions(r)}}var s;if(this.options.maxResolution&&this.options.maxResolution!=="auto"){s=this.options.maxResolution}if(this.options.minScale){s=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units)}var o;if(this.options.minResolution&&this.options.minResolution!=="auto"){o=this.options.minResolution}if(this.options.maxScale){o=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units)}if(r.resolutions){r.resolutions.sort(function(e,t){return t-e});if(!s){s=r.resolutions[0]}if(!o){var u=r.resolutions.length-1;o=r.resolutions[u]}}this.resolutions=r.resolutions;if(this.resolutions){t=this.resolutions.length;this.scales=new Array(t);for(e=0;e<t;e++){this.scales[e]=OpenLayers.Util.getScaleFromResolution(this.resolutions[e],this.units)}this.numZoomLevels=t}this.minResolution=o;if(o){this.maxScale=OpenLayers.Util.getScaleFromResolution(o,this.units)}this.maxResolution=s;if(s){this.minScale=OpenLayers.Util.getScaleFromResolution(s,this.units)}},resolutionsFromScales:function(e){if(e==null){return}var t,n,r;r=e.length;t=new Array(r);for(n=0;n<r;n++){t[n]=OpenLayers.Util.getResolutionFromScale(e[n],this.units)}return t},calculateResolutions:function(e){var t,n,r;var i=e.maxResolution;if(e.minScale!=null){i=OpenLayers.Util.getResolutionFromScale(e.minScale,this.units)}else if(i=="auto"&&this.maxExtent!=null){t=this.map.getSize();n=this.maxExtent.getWidth()/t.w;r=this.maxExtent.getHeight()/t.h;i=Math.max(n,r)}var s=e.minResolution;if(e.maxScale!=null){s=OpenLayers.Util.getResolutionFromScale(e.maxScale,this.units)}else if(e.minResolution=="auto"&&this.minExtent!=null){t=this.map.getSize();n=this.minExtent.getWidth()/t.w;r=this.minExtent.getHeight()/t.h;s=Math.max(n,r)}if(typeof i!=="number"&&typeof s!=="number"&&this.maxExtent!=null){var o=this.map.getTileSize();i=Math.max(this.maxExtent.getWidth()/o.w,this.maxExtent.getHeight()/o.h)}var u=e.maxZoomLevel;var a=e.numZoomLevels;if(typeof s==="number"&&typeof i==="number"&&a===undefined){var f=i/s;a=Math.floor(Math.log(f)/Math.log(2))+1}else if(a===undefined&&u!=null){a=u+1}if(typeof a!=="number"||a<=0||typeof i!=="number"&&typeof s!=="number"){return}var l=new Array(a);var c=2;if(typeof s=="number"&&typeof i=="number"){c=Math.pow(i/s,1/(a-1))}var h;if(typeof i==="number"){for(h=0;h<a;h++){l[h]=i/Math.pow(c,h)}}else{for(h=0;h<a;h++){l[a-1-h]=s*Math.pow(c,h)}}return l},getResolution:function(){var e=this.map.getZoom();return this.getResolutionForZoom(e)},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(e,t){var n=this.map.getSize();var r=Math.max(e.getWidth()/n.w,e.getHeight()/n.h);return this.getZoomForResolution(r,t)},getDataExtent:function(){},getResolutionForZoom:function(e){e=Math.max(0,Math.min(e,this.resolutions.length-1));var t;if(this.map.fractionalZoom){var n=Math.floor(e);var r=Math.ceil(e);t=this.resolutions[n]-(e-n)*(this.resolutions[n]-this.resolutions[r])}else{t=this.resolutions[Math.round(e)]}return t},getZoomForResolution:function(e,t){var n,r,i;if(this.map.fractionalZoom){var s=0;var o=this.resolutions.length-1;var u=this.resolutions[s];var a=this.resolutions[o];var f;for(r=0,i=this.resolutions.length;r<i;++r){f=this.resolutions[r];if(f>=e){u=f;s=r}if(f<=e){a=f;o=r;break}}var l=u-a;if(l>0){n=s+(u-e)/l}else{n=s}}else{var c;var h=Number.POSITIVE_INFINITY;for(r=0,i=this.resolutions.length;r<i;r++){if(t){c=Math.abs(this.resolutions[r]-e);if(c>h){break}h=c}else{if(this.resolutions[r]<e){break}}}n=Math.max(0,r-1)}return n},getLonLatFromViewPortPx:function(e){var t=null;var n=this.map;if(e!=null&&n.minPx){var r=n.getResolution();var i=n.getMaxExtent({restricted:true});var s=(e.x-n.minPx.x)*r+i.left;var o=(n.minPx.y-e.y)*r+i.top;t=new OpenLayers.LonLat(s,o);if(this.wrapDateLine){t=t.wrapDateLine(this.maxExtent)}}return t},getViewPortPxFromLonLat:function(e,t){var n=null;if(e!=null){t=t||this.map.getResolution();var r=this.map.calculateBounds(null,t);n=new OpenLayers.Pixel(1/t*(e.lon-r.left),1/t*(r.top-e.lat))}return n},setOpacity:function(e){if(e!=this.opacity){this.opacity=e;var t=this.div.childNodes;for(var n=0,r=t.length;n<r;++n){var i=t[n].firstChild||t[n];var s=t[n].lastChild;if(s&&s.nodeName.toLowerCase()==="iframe"){i=s.parentNode}OpenLayers.Util.modifyDOMElement(i,null,null,null,null,null,null,e)}if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(e){this.div.style.zIndex=e},adjustBounds:function(e){if(this.gutter){var t=this.gutter*this.map.getResolution();e=new OpenLayers.Bounds(e.left-t,e.bottom-t,e.right+t,e.top+t)}if(this.wrapDateLine){var n={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()};e=e.wrapDateLine(this.maxExtent,n)}return e},CLASS_NAME:"OpenLayers.Layer"});OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:false,initialize:function(e,t,n,r){OpenLayers.Layer.prototype.initialize.apply(this,[e,r]);this.url=t;if(!this.params){this.params=OpenLayers.Util.extend({},n)}},destroy:function(){this.url=null;this.params=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){if(e==null){e=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions())}e=OpenLayers.Layer.prototype.clone.apply(this,[e]);return e},setUrl:function(e){this.url=e},mergeNewParams:function(e){this.params=OpenLayers.Util.extend(this.params,e);var t=this.redraw();if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"params"})}return t},redraw:function(e){if(e){return this.mergeNewParams({_olSalt:Math.random()})}else{return OpenLayers.Layer.prototype.redraw.apply(this,[])}},selectUrl:function(e,t){var n=1;for(var r=0,i=e.length;r<i;r++){n*=e.charCodeAt(r)*this.URL_HASH_FACTOR;n-=Math.floor(n)}return t[Math.floor(n*t.length)]},getFullRequestString:function(e,t){var n=t||this.url;var r=OpenLayers.Util.extend({},this.params);r=OpenLayers.Util.extend(r,e);var i=OpenLayers.Util.getParameterString(r);if(OpenLayers.Util.isArray(n)){n=this.selectUrl(i,n)}var s=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(n));for(var o in r){if(o.toUpperCase()in s){delete r[o]}}i=OpenLayers.Util.getParameterString(r);return OpenLayers.Util.urlAppend(n,i)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:false,initialize:function(e,t,n,r,i,s){this.layer=e;this.position=t.clone();this.setBounds(n);this.url=r;if(i){this.size=i.clone()}this.id=OpenLayers.Util.createUniqueID("Tile_");OpenLayers.Util.extend(this,s);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}},unload:function(){if(this.isLoading){this.isLoading=false;this.events.triggerEvent("unload")}},destroy:function(){this.layer=null;this.bounds=null;this.size=null;this.position=null;if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy();this.eventListeners=null;this.events=null},draw:function(e){if(!e){this.clear()}var t=this.shouldDraw();if(t&&!e){t=this.events.triggerEvent("beforedraw")!==false}return t},shouldDraw:function(){var e=false,t=this.layer.maxExtent;if(t){var n=this.layer.map;var r=n.baseLayer.wrapDateLine&&n.getMaxExtent();if(this.bounds.intersectsBounds(t,{inclusive:false,worldBounds:r})){e=true}}return e||this.layer.displayOutsideMaxExtent},setBounds:function(e){e=e.clone();if(this.layer.map.baseLayer.wrapDateLine){var t=this.layer.map.getMaxExtent(),n=this.layer.map.getResolution();e=e.wrapDateLine(t,{leftTolerance:n,rightTolerance:n})}this.bounds=e},moveTo:function(e,t,n){if(n==null){n=true}this.setBounds(e);this.position=t.clone();if(n){this.draw()}},clear:function(e){},CLASS_NAME:"OpenLayers.Tile"});OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(e,t,n,r,i,s){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=r;this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack();if(this.maxGetUrlLength!=null||this.layer.gutter||this.layerAlphaHack){this.frame=document.createElement("div");this.frame.style.position="absolute";this.frame.style.overflow="hidden"}if(this.maxGetUrlLength!=null){OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)}},destroy:function(){if(this.imgDiv){this.clear();this.imgDiv=null;this.frame=null}this.asyncRequestId=null;OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var e=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(e){if(this.layer!=this.layer.map.baseLayer&&this.layer.reproject){this.bounds=this.getBoundsFromBaseLayer(this.position)}if(this.isLoading){this._loadEvent="reload"}else{this.isLoading=true;this._loadEvent="loadstart"}this.positionTile();this.renderTile()}else{this.unload()}return e},renderTile:function(){this.layer.div.appendChild(this.getTile());if(this.layer.async){var e=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(t){if(e==this.asyncRequestId){this.url=t;this.initImage()}},this)}else{this.url=this.layer.getURL(this.bounds);this.initImage()}},positionTile:function(){var e=this.getTile().style,t=this.frame?this.size:this.layer.getImageSize(this.bounds);e.left=this.position.x+"%";e.top=this.position.y+"%";e.width=t.w+"%";e.height=t.h+"%"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var e=this.imgDiv;if(e){OpenLayers.Event.stopObservingElement(e);var t=this.getTile();if(t.parentNode===this.layer.div){this.layer.div.removeChild(t)}this.setImgSrc();if(this.layerAlphaHack===true){e.style.filter=""}OpenLayers.Element.removeClass(e,"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=document.createElement("img");this.imgDiv.className="olTileImage";this.imgDiv.galleryImg="no";var e=this.imgDiv.style;if(this.frame){var t=0,n=0;if(this.layer.gutter){t=this.layer.gutter/this.layer.tileSize.w*100;n=this.layer.gutter/this.layer.tileSize.h*100}e.left=-t+"%";e.top=-n+"%";e.width=2*t+100+"%";e.height=2*n+100+"%"}e.visibility="hidden";e.opacity=0;if(this.layer.opacity<1){e.filter="alpha(opacity="+this.layer.opacity*100+")"}e.position="absolute";if(this.layerAlphaHack){e.paddingTop=e.height;e.height="0";e.width="100%"}if(this.frame){this.frame.appendChild(this.imgDiv)}}return this.imgDiv},initImage:function(){this.events.triggerEvent(this._loadEvent);var e=this.getImage();if(this.url&&e.getAttribute("src")==this.url){this.onImageLoad()}else{var t=OpenLayers.Function.bind(function(){OpenLayers.Event.stopObservingElement(e);OpenLayers.Event.observe(e,"load",OpenLayers.Function.bind(this.onImageLoad,this));OpenLayers.Event.observe(e,"error",OpenLayers.Function.bind(this.onImageError,this));this.imageReloadAttempts=0;this.setImgSrc(this.url)},this);if(e.getAttribute("src")==this.blankImageUrl){t()}else{OpenLayers.Event.observe(e,"load",t);OpenLayers.Event.observe(e,"error",t);if(this.crossOriginKeyword){e.removeAttribute("crossorigin")}e.src=this.blankImageUrl}}},setImgSrc:function(e){var t=this.imgDiv;t.style.visibility="hidden";t.style.opacity=0;if(e){if(this.crossOriginKeyword){if(e.substr(0,5)!=="data:"){t.setAttribute("crossorigin",this.crossOriginKeyword)}else{t.removeAttribute("crossorigin")}}t.src=e}},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(!this.imgDiv||this.isLoading){return}var e;if(this.frame){e=this.frame.cloneNode(false);e.appendChild(this.imgDiv)}else{e=this.imgDiv}this.imgDiv=null;return e},onImageLoad:function(){var e=this.imgDiv;OpenLayers.Event.stopObservingElement(e);e.style.visibility="inherit";e.style.opacity=this.layer.opacity;this.isLoading=false;this.canvasContext=null;this.events.triggerEvent("loadend");if(parseFloat(navigator.appVersion.split("MSIE")[1])<7&&this.layer&&this.layer.div){var t=document.createElement("span");t.style.display="none";var n=this.layer.div;n.appendChild(t);window.setTimeout(function(){t.parentNode===n&&t.parentNode.removeChild(t)},0)}if(this.layerAlphaHack===true){e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e.src+"', sizingMethod='scale')"}},onImageError:function(){var e=this.imgDiv;if(e.src!=null){this.imageReloadAttempts++;if(this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS){this.setImgSrc(this.layer.getURL(this.bounds))}else{OpenLayers.Element.addClass(e,"olImageLoadError");this.events.triggerEvent("loaderror");this.onImageLoad()}}},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var e=document.createElement("canvas");e.width=this.size.w;e.height=this.size.h;this.canvasContext=e.getContext("2d");this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"});OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:false,ratio:1.5,buffer:0,transitionEffect:null,numLoadingTiles:0,tileLoadingDelay:85,serverResolutions:null,moveTimerId:null,deferMoveGriddedTiles:null,tileQueueId:null,tileQueue:null,loading:false,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,initialize:function(e,t,n,r){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.grid=[];this.tileQueue=[];if(this.removeBackBufferDelay===null){this.removeBackBufferDelay=this.singleTile?0:2500}if(this.className===null){this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid"}if(!OpenLayers.Animation.isNative){this.deferMoveGriddedTiles=OpenLayers.Function.bind(function(){this.moveGriddedTiles(true);this.moveTimerId=null},this)}},setMap:function(e){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,e);OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(e){if(this.moveTimerId!==null){window.clearTimeout(this.moveTimerId);this.moveTimerId=null}this.clearTileQueue();if(this.backBufferTimerId!==null){window.clearTimeout(this.backBufferTimerId);this.backBufferTimerId=null}},destroy:function(){this.removeBackBuffer();this.clearGrid();this.grid=null;this.tileSize=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){this.clearTileQueue();if(this.grid){for(var e=0,t=this.grid.length;e<t;e++){var n=this.grid[e];for(var r=0,i=n.length;r<i;r++){var s=n[r];this.destroyTile(s)}}this.grid=[];this.gridResolution=null}},clone:function(e){if(e==null){e=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions())}e=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[e]);if(this.tileSize!=null){e.tileSize=this.tileSize.clone()}e.grid=[];e.gridResolution=null;e.backBuffer=null;e.backBufferTimerId=null;e.tileQueue=[];e.tileQueueId=null;e.loading=false;e.moveTimerId=null;return e},moveTo:function(e,t,n){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);e=e||this.map.getExtent();if(e!=null){var r=!this.grid.length||t;var i=this.getTilesBounds();var s=this.map.getResolution();var o=this.getServerResolution(s);if(this.singleTile){if(r||!n&&!i.containsBounds(e)){if(t&&this.transitionEffect!=="resize"){this.removeBackBuffer()}if(!t||this.transitionEffect==="resize"){this.applyBackBuffer(o)}this.initSingleTile(e)}}else{r=r||!i.intersectsBounds(e,{worldBounds:this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent()});if(s!==o){e=this.map.calculateBounds(null,o);if(r){var u=o/s;this.transformDiv(u)}}else{this.div.style.width="100%";this.div.style.height="100%";this.div.style.left="0%";this.div.style.top="0%"}if(r){if(t&&this.transitionEffect==="resize"){this.applyBackBuffer(o)}this.initGriddedTiles(e)}else{this.moveGriddedTiles()}}}},getTileData:function(e){var t=null,n=e.lon,r=e.lat,i=this.grid.length;if(this.map&&i){var s=this.map.getResolution(),o=this.tileSize.w,u=this.tileSize.h,a=this.grid[0][0].bounds,f=a.left,l=a.top;if(n<f){if(this.map.baseLayer.wrapDateLine){var c=this.map.getMaxExtent().getWidth();var h=Math.ceil((f-n)/c);n+=c*h}}var p=(n-f)/(s*o);var d=(l-r)/(s*u);var v=Math.floor(p);var m=Math.floor(d);if(m>=0&&m<i){var g=this.grid[m][v];if(g){t={tile:g,i:Math.floor((p-v)*o),j:Math.floor((d-m)*u)}}}}return t},queueTileDraw:function(e){var t=e.object;if(!~OpenLayers.Util.indexOf(this.tileQueue,t)){this.tileQueue.push(t)}if(!this.tileQueueId){this.tileQueueId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.drawTileFromQueue,this),null,this.div)}return false},drawTileFromQueue:function(){if(this.tileQueue.length===0){this.clearTileQueue()}else{this.tileQueue.shift().draw(true)}},clearTileQueue:function(){OpenLayers.Animation.stop(this.tileQueueId);this.tileQueueId=null;this.tileQueue=[]},destroyTile:function(e){this.removeTileMonitoringHooks(e);e.destroy()},getServerResolution:function(e){e=e||this.map.getResolution();if(this.serverResolutions&&OpenLayers.Util.indexOf(this.serverResolutions,e)===-1){var t,n;for(t=this.serverResolutions.length-1;t>=0;t--){n=this.serverResolutions[t];if(n>e){e=n;break}}if(t===-1){throw"no appropriate resolution in serverResolutions"}}return e},getServerZoom:function(){var e=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,e):this.map.getZoomForResolution(e)+(this.zoomOffset||0)},transformDiv:function(e){this.div.style.width=100*e+"%";this.div.style.height=100*e+"%";var t=this.map.getSize();var n=parseInt(this.map.layerContainerDiv.style.left,10);var r=parseInt(this.map.layerContainerDiv.style.top,10);var i=(n-t.w/2)*(e-1);var s=(r-t.h/2)*(e-1);this.div.style.left=i+"%";this.div.style.top=s+"%"},getResolutionScale:function(){return parseInt(this.div.style.width,10)/100},applyBackBuffer:function(e){if(this.backBufferTimerId!==null){this.removeBackBuffer()}var t=this.backBuffer;if(!t){t=this.createBackBuffer();if(!t){return}this.div.insertBefore(t,this.div.firstChild);this.backBuffer=t;var n=this.grid[0][0].bounds;this.backBufferLonLat={lon:n.left,lat:n.top};this.backBufferResolution=this.gridResolution}var r=t.style;var i=this.backBufferResolution/e;r.width=100*i+"%";r.height=100*i+"%";var s=this.getViewPortPxFromLonLat(this.backBufferLonLat,e);var o=parseInt(this.map.layerContainerDiv.style.left,10);var u=parseInt(this.map.layerContainerDiv.style.top,10);t.style.left=Math.round(s.x-o)+"%";t.style.top=Math.round(s.y-u)+"%"},createBackBuffer:function(){var e;if(this.grid.length>0){e=document.createElement("div");e.id=this.div.id+"_bb";e.className="olBackBuffer";e.style.position="absolute";e.style.width="100%";e.style.height="100%";for(var t=0,n=this.grid.length;t<n;t++){for(var r=0,i=this.grid[t].length;r<i;r++){var s=this.grid[t][r].createBackBuffer();if(!s){continue}s.style.top=t*this.tileSize.h+"%";s.style.left=r*this.tileSize.w+"%";e.appendChild(s)}}}return e},removeBackBuffer:function(){if(this.backBuffer){this.div.removeChild(this.backBuffer);this.backBuffer=null;this.backBufferResolution=null;if(this.backBufferTimerId!==null){window.clearTimeout(this.backBufferTimerId);this.backBufferTimerId=null}}},moveByPx:function(e,t){if(!this.singleTile){this.moveGriddedTiles()}},setTileSize:function(e){if(this.singleTile){e=this.map.getSize();e.h=parseInt(e.h*this.ratio);e.w=parseInt(e.w*this.ratio)}OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[e])},getTilesBounds:function(){var e=null;var t=this.grid.length;if(t){var n=this.grid[t-1][0].bounds,r=this.grid[0].length*n.getWidth(),i=this.grid.length*n.getHeight();e=new OpenLayers.Bounds(n.left,n.bottom,n.left+r,n.bottom+i)}return e},initSingleTile:function(e){this.clearTileQueue();var t=e.getCenterLonLat();var n=e.getWidth()*this.ratio;var r=e.getHeight()*this.ratio;var i=new OpenLayers.Bounds(t.lon-n/2,t.lat-r/2,t.lon+n/2,t.lat+r/2);var s=this.map.getLayerPxFromLonLat({lon:i.left,lat:i.top});if(!this.grid.length){this.grid[0]=[]}var o=this.grid[0][0];if(!o){o=this.addTile(i,s);this.addTileMonitoringHooks(o);o.draw();this.grid[0][0]=o}else{o.moveTo(i,s)}this.removeExcessTiles(1,1);this.gridResolution=this.getServerResolution()},calculateGridLayout:function(e,t,n){var r=n*this.tileSize.w;var i=n*this.tileSize.h;var s=e.left-t.lon;var o=Math.floor(s/r)-this.buffer;var u=s/r-o;var a=-u*this.tileSize.w;var f=t.lon+o*r;var l=e.top-(t.lat+i);var c=Math.ceil(l/i)+this.buffer;var h=c-l/i;var p=-h*this.tileSize.h;var d=t.lat+c*i;return{tilelon:r,tilelat:i,tileoffsetlon:f,tileoffsetlat:d,tileoffsetx:a,tileoffsety:p}},getTileOrigin:function(){var e=this.tileOrigin;if(!e){var t=this.getMaxExtent();var n={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner];e=new OpenLayers.LonLat(t[n[0]],t[n[1]])}return e},initGriddedTiles:function(e){this.clearTileQueue();var t=this.map.getSize();var n=Math.ceil(t.h/this.tileSize.h)+Math.max(1,2*this.buffer);var r=Math.ceil(t.w/this.tileSize.w)+Math.max(1,2*this.buffer);var i=this.getTileOrigin();var s=this.getServerResolution();var o=this.calculateGridLayout(e,i,s);var u=Math.round(o.tileoffsetx);var a=Math.round(o.tileoffsety);var f=o.tileoffsetlon;var l=o.tileoffsetlat;var c=o.tilelon;var h=o.tilelat;var p=u;var d=f;var v=0;var m=parseInt(this.map.layerContainerDiv.style.left);var g=parseInt(this.map.layerContainerDiv.style.top);var y=[],b=this.map.getCenter();do{var w=this.grid[v++];if(!w){w=[];this.grid.push(w)}f=d;u=p;var E=0;do{var S=new OpenLayers.Bounds(f,l,f+c,l+h);var x=u;x-=m;var T=a;T-=g;var N=new OpenLayers.Pixel(x,T);var C=w[E++];if(!C){C=this.addTile(S,N);this.addTileMonitoringHooks(C);w.push(C)}else{C.moveTo(S,N,false)}var k=S.getCenterLonLat();y.push({tile:C,distance:Math.pow(k.lon-b.lon,2)+Math.pow(k.lat-b.lat,2)});f+=c;u+=this.tileSize.w}while(f<=e.right+c*this.buffer||E<r);l-=h;a+=this.tileSize.h}while(l>=e.bottom-h*this.buffer||v<n);this.removeExcessTiles(v,E);this.gridResolution=this.getServerResolution();y.sort(function(e,t){return e.distance-t.distance});for(var L=0,A=y.length;L<A;++L){y[L].tile.draw()}},getMaxExtent:function(){return this.maxExtent},addTile:function(e,t){var n=new this.tileClass(this,t,e,null,this.tileSize,this.tileOptions);n.events.register("beforedraw",this,this.queueTileDraw);return n},addTileMonitoringHooks:function(e){e.onLoadStart=function(){if(this.loading===false){this.loading=true;this.events.triggerEvent("loadstart")}this.events.triggerEvent("tileloadstart",{tile:e});this.numLoadingTiles++};e.onLoadEnd=function(){this.numLoadingTiles--;this.events.triggerEvent("tileloaded",{tile:e});if(this.tileQueue.length===0&&this.numLoadingTiles===0){this.loading=false;this.events.triggerEvent("loadend");if(this.backBuffer){this.backBufferTimerId=window.setTimeout(OpenLayers.Function.bind(this.removeBackBuffer,this),this.removeBackBufferDelay)}}};e.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:e})};e.events.on({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,loaderror:e.onLoadError,scope:this})},removeTileMonitoringHooks:function(e){e.unload();e.events.un({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,loaderror:e.onLoadError,scope:this})},moveGriddedTiles:function(e){if(!e&&!OpenLayers.Animation.isNative){if(this.moveTimerId!=null){window.clearTimeout(this.moveTimerId)}this.moveTimerId=window.setTimeout(this.deferMoveGriddedTiles,this.tileLoadingDelay);return}var t=this.buffer||1;var n=this.getResolutionScale();while(true){var r={x:this.grid[0][0].position.x*n+parseInt(this.div.style.left,10)+parseInt(this.map.layerContainerDiv.style.left),y:this.grid[0][0].position.y*n+parseInt(this.div.style.top,10)+parseInt(this.map.layerContainerDiv.style.top)};var i={w:this.tileSize.w*n,h:this.tileSize.h*n};if(r.x>-i.w*(t-1)){this.shiftColumn(true)}else if(r.x<-i.w*t){this.shiftColumn(false)}else if(r.y>-i.h*(t-1)){this.shiftRow(true)}else if(r.y<-i.h*t){this.shiftRow(false)}else{break}}},shiftRow:function(e){var t=e?0:this.grid.length-1;var n=this.grid;var r=n[t];var i=this.getServerResolution();var s=e?-this.tileSize.h:this.tileSize.h;var o=i*-s;var u=e?n.pop():n.shift();for(var a=0,f=r.length;a<f;a++){var l=r[a];var c=l.bounds.clone();var h=l.position.clone();c.bottom=c.bottom+o;c.top=c.top+o;h.y=h.y+s;u[a].moveTo(c,h)}if(e){n.unshift(u)}else{n.push(u)}},shiftColumn:function(e){var t=e?-this.tileSize.w:this.tileSize.w;var n=this.getServerResolution();var r=n*t;for(var i=0,s=this.grid.length;i<s;i++){var o=this.grid[i];var u=e?0:o.length-1;var a=o[u];var f=a.bounds.clone();var l=a.position.clone();f.left=f.left+r;f.right=f.right+r;l.x=l.x+t;var c=e?this.grid[i].pop():this.grid[i].shift();c.moveTo(f,l);if(e){o.unshift(c)}else{o.push(c)}}},removeExcessTiles:function(e,t){var n,r;while(this.grid.length>e){var i=this.grid.pop();for(n=0,r=i.length;n<r;n++){var s=i[n];this.destroyTile(s)}}for(n=0,r=this.grid.length;n<r;n++){while(this.grid[n].length>t){var i=this.grid[n];var s=i.pop();this.destroyTile(s)}}},onMapResize:function(){if(this.singleTile){this.clearGrid();this.setTileSize()}},getTileBounds:function(e){var t=this.maxExtent;var n=this.getResolution();var r=n*this.tileSize.w;var i=n*this.tileSize.h;var s=this.getLonLatFromViewPortPx(e);var o=t.left+r*Math.floor((s.lon-t.left)/r);var u=t.bottom+i*Math.floor((s.lat-t.bottom)/i);return new OpenLayers.Bounds(o,u,o+r,u+i)},CLASS_NAME:"OpenLayers.Layer.Grid"});OpenLayers.Layer.SphericalMercator={getExtent:function(){var e=null;if(this.sphericalMercator){e=this.map.calculateBounds()}else{e=OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)}return e},getLonLatFromViewPortPx:function(e){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(e){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];var e=156543.03390625;for(var t=0;t<=this.MAX_ZOOM_LEVEL;++t){this.RESOLUTIONS[t]=e/Math.pow(2,t)}this.units="m";this.projection=this.projection||"EPSG:900913"},forwardMercator:function(){var e=new OpenLayers.Projection("EPSG:4326");var t=new OpenLayers.Projection("EPSG:900913");return function(n,r){var i=OpenLayers.Projection.transform({x:n,y:r},e,t);return new OpenLayers.LonLat(i.x,i.y)}}(),inverseMercator:function(){var e=new OpenLayers.Projection("EPSG:4326");var t=new OpenLayers.Projection("EPSG:900913");return function(n,r){var i=OpenLayers.Projection.transform({x:n,y:r},t,e);return new OpenLayers.LonLat(i.x,i.y)}}()};OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:true,isBaseLayer:true,isFixed:true,pane:null,mapObject:null,initialize:function(e,t){OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(this.pane==null){this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane")}},destroy:function(){this.mapObject=null;this.pane=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(e){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width="100%";this.pane.style.height="100%";if(OpenLayers.BROWSER_NAME=="msie"){this.pane.style.background="url("+OpenLayers.Util.getImageLocation("blank.gif")+")"}if(this.isFixed){this.map.viewPortDiv.appendChild(this.pane)}else{this.map.layerContainerDiv.appendChild(this.pane)}this.loadMapObject();if(this.mapObject==null){this.loadWarningMessage()}},removeMap:function(e){if(this.pane&&this.pane.parentNode){this.pane.parentNode.removeChild(this.pane)}OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var e=this.map.getSize();var t=Math.min(e.w,300);var n=Math.min(e.h,200);var r=new OpenLayers.Size(t,n);var i=new OpenLayers.Pixel(e.w/2,e.h/2);var s=i.add(-r.w/2,-r.h/2);var o=OpenLayers.Util.createDiv(this.name+"_warning",s,r,null,null,null,"auto");o.style.padding="7px";o.style.backgroundColor="yellow";o.innerHTML=this.getWarningHTML();this.div.appendChild(o)},getWarningHTML:function(){return""},display:function(e){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display},setZIndex:function(e){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveByPx:function(e,t){OpenLayers.Layer.prototype.moveByPx.apply(this,arguments);if(this.dragPanMapObject){this.dragPanMapObject(e,-t)}else{this.moveTo(this.map.getCachedCenter())}},moveTo:function(e,t,n){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(this.mapObject!=null){var r=this.map.getCenter();var i=this.map.getZoom();if(r!=null){var s=this.getMapObjectCenter();var o=this.getOLLonLatFromMapObjectLonLat(s);var u=this.getMapObjectZoom();var a=this.getOLZoomFromMapObjectZoom(u);if(!r.equals(o)||i!=a){if(!t&&o&&this.dragPanMapObject&&this.smoothDragPan){var f=this.map.getViewPortPxFromLonLat(o);var l=this.map.getViewPortPxFromLonLat(r);this.dragPanMapObject(l.x-f.x,f.y-l.y)}else{var c=this.getMapObjectLonLatFromOLLonLat(r);var h=this.getMapObjectZoomFromOLZoom(i);this.setMapObjectCenter(c,h,n)}}}}},getLonLatFromViewPortPx:function(e){var t=null;if(this.mapObject!=null&&this.getMapObjectCenter()!=null){var n=this.getMapObjectPixelFromOLPixel(e);var r=this.getMapObjectLonLatFromMapObjectPixel(n);t=this.getOLLonLatFromMapObjectLonLat(r)}return t},getViewPortPxFromLonLat:function(e){var t=null;if(this.mapObject!=null&&this.getMapObjectCenter()!=null){var n=this.getMapObjectLonLatFromOLLonLat(e);var r=this.getMapObjectPixelFromMapObjectLonLat(n);t=this.getOLPixelFromMapObjectPixel(r)}return t},getOLLonLatFromMapObjectLonLat:function(e){var t=null;if(e!=null){var n=this.getLongitudeFromMapObjectLonLat(e);var r=this.getLatitudeFromMapObjectLonLat(e);t=new OpenLayers.LonLat(n,r)}return t},getMapObjectLonLatFromOLLonLat:function(e){var t=null;if(e!=null){t=this.getMapObjectLonLatFromLonLat(e.lon,e.lat)}return t},getOLPixelFromMapObjectPixel:function(e){var t=null;if(e!=null){var n=this.getXFromMapObjectPixel(e);var r=this.getYFromMapObjectPixel(e);t=new OpenLayers.Pixel(n,r)}return t},getMapObjectPixelFromOLPixel:function(e){var t=null;if(e!=null){t=this.getMapObjectPixelFromXY(e.x,e.y)}return t},CLASS_NAME:"OpenLayers.Layer.EventPane"});OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){var e=["minZoomLevel","maxZoomLevel","numZoomLevels"];for(var t=0,n=e.length;t<n;t++){var r=e[t];this[r]=this.options[r]!=null?this.options[r]:this.map[r]}if(this.minZoomLevel==null||this.minZoomLevel<this.MIN_ZOOM_LEVEL){this.minZoomLevel=this.MIN_ZOOM_LEVEL}var i;var s=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;if(this.options.numZoomLevels==null&&this.options.maxZoomLevel!=null||this.numZoomLevels==null&&this.maxZoomLevel!=null){i=this.maxZoomLevel-this.minZoomLevel+1}else{i=this.numZoomLevels}if(i!=null){this.numZoomLevels=Math.min(i,s)}else{this.numZoomLevels=s}this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(this.RESOLUTIONS!=null){var o=0;this.resolutions=[];for(var t=this.minZoomLevel;t<=this.maxZoomLevel;t++){this.resolutions[o++]=this.RESOLUTIONS[t]}this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(this.resolutions!=null){return OpenLayers.Layer.prototype.getResolution.apply(this,arguments)}else{var e=null;var t=this.map.getSize();var n=this.getExtent();if(t!=null&&n!=null){e=Math.max(n.getWidth()/t.w,n.getHeight()/t.h)}return e}},getExtent:function(){var e=this.map.getSize();var t=this.getLonLatFromViewPortPx({x:0,y:0});var n=this.getLonLatFromViewPortPx({x:e.w,y:e.h});if(t!=null&&n!=null){return new OpenLayers.Bounds(t.lon,n.lat,n.lon,t.lat)}else{return null}},getZoomForResolution:function(e){if(this.resolutions!=null){return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments)}else{var t=OpenLayers.Layer.prototype.getExtent.apply(this,[]);return this.getZoomForExtent(t)}},getOLZoomFromMapObjectZoom:function(e){var t=null;if(e!=null){t=e-this.minZoomLevel;if(this.map.baseLayer!==this){t=this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(t))}}return t},getMapObjectZoomFromOLZoom:function(e){var t=null;if(e!=null){t=e+this.minZoomLevel;if(this.map.baseLayer!==this){t=this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(t))}}return t},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"});OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,2145767211914062e-20,1072883605957031e-20,536441802978515e-20,268220901489257e-20,1341104507446289e-21,6.705522537231445e-7],type:null,wrapDateLine:true,sphericalMercator:false,version:null,initialize:function(e,t){t=t||{};if(!t.version){t.version=typeof GMap2==="function"?"2":"3"}var n=OpenLayers.Layer.Google["v"+t.version.replace(/\./g,"_")];if(n){OpenLayers.Util.applyDefaults(t,n)}else{throw"Unsupported Google Maps API version: "+t.version}OpenLayers.Util.applyDefaults(t,n.DEFAULTS);if(t.maxExtent){t.maxExtent=t.maxExtent.clone()}OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[e,t]);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,[e,t]);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters()}},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(e){var t=this.opacity==null?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments);this.setOpacity(t)},display:function(e){if(!this._dragging){this.setGMapVisibility(e)}OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},moveTo:function(e,t,n){this._dragging=n;OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments);delete this._dragging},setOpacity:function(e){if(e!==this.opacity){if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}this.opacity=e}if(this.getVisibility()){var t=this.getMapContainer();OpenLayers.Util.modifyDOMElement(t,null,null,null,null,null,null,e)}},destroy:function(){if(this.map){this.setGMapVisibility(false);var e=OpenLayers.Layer.Google.cache[this.map.id];if(e&&e.count<=1){this.removeGMapElements()}}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var e=OpenLayers.Layer.Google.cache[this.map.id];if(e){var t=this.mapObject&&this.getMapContainer();if(t&&t.parentNode){t.parentNode.removeChild(t)}var n=e.termsOfUse;if(n&&n.parentNode){n.parentNode.removeChild(n)}var r=e.poweredBy;if(r&&r.parentNode){r.parentNode.removeChild(r)}}},removeMap:function(e){if(this.visibility&&this.mapObject){this.setGMapVisibility(false)}var t=OpenLayers.Layer.Google.cache[e.id];if(t){if(t.count<=1){this.removeGMapElements();delete OpenLayers.Layer.Google.cache[e.id]}else{--t.count}}delete this.termsOfUse;delete this.poweredBy;delete this.mapObject;delete this.dragObject;OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(e){var t=null;if(e!=null){var n=e.getSouthWest();var r=e.getNorthEast();if(this.sphericalMercator){n=this.forwardMercator(n.lng(),n.lat());r=this.forwardMercator(r.lng(),r.lat())}else{n=new OpenLayers.LonLat(n.lng(),n.lat());r=new OpenLayers.LonLat(r.lng(),r.lat())}t=new OpenLayers.Bounds(n.lon,n.lat,r.lon,r.lat)}return t},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(e){return this.sphericalMercator?this.forwardMercator(e.lng(),e.lat()).lon:e.lng()},getLatitudeFromMapObjectLonLat:function(e){var t=this.sphericalMercator?this.forwardMercator(e.lng(),e.lat()).lat:e.lat();return t},getXFromMapObjectPixel:function(e){return e.x},getYFromMapObjectPixel:function(e){return e.y},CLASS_NAME:"OpenLayers.Layer.Google"});OpenLayers.Layer.Google.cache={};OpenLayers.Layer.Google.v2={termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){if(!this.type){this.type=G_NORMAL_MAP}var e,t,n;var r=OpenLayers.Layer.Google.cache[this.map.id];if(r){e=r.mapObject;t=r.termsOfUse;n=r.poweredBy;++r.count}else{var i=this.map.viewPortDiv;var s=document.createElement("div");s.id=this.map.id+"_GMap2Container";s.style.position="absolute";s.style.width="100%";s.style.height="100%";i.appendChild(s);try{e=new GMap2(s);t=s.lastChild;i.appendChild(t);t.style.zIndex="1100";t.style.right="";t.style.bottom="";t.className="olLayerGoogleCopyright";n=s.lastChild;i.appendChild(n);n.style.zIndex="1100";n.style.right="";n.style.bottom="";n.className="olLayerGooglePoweredBy gmnoprint"}catch(o){throw o}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:e,termsOfUse:t,poweredBy:n,count:1}}this.mapObject=e;this.termsOfUse=t;this.poweredBy=n;if(OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)===-1){this.mapObject.addMapType(this.type)}if(typeof e.getDragObject=="function"){this.dragObject=e.getDragObject()}else{this.dragPanMapObject=null}if(this.isBaseLayer===false){this.setGMapVisibility(this.div.style.display!=="none")}},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded()){this.mapObject.checkResize()}else{if(!this._resized){var e=this;var t=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(t);delete e._resized;e.mapObject.checkResize();e.moveTo(e.map.getCenter(),e.map.getZoom())})}this._resized=true}},setGMapVisibility:function(e){var t=OpenLayers.Layer.Google.cache[this.map.id];if(t){var n=this.mapObject.getContainer();if(e===true){this.mapObject.setMapType(this.type);n.style.display="";this.termsOfUse.style.left="";this.termsOfUse.style.display="";this.poweredBy.style.display="";t.displayed=this.id}else{if(t.displayed===this.id){delete t.displayed}if(!t.displayed){n.style.display="none";this.termsOfUse.style.display="none";this.termsOfUse.style.left="-9999px";this.poweredBy.style.display="none"}}}},getMapContainer:function(){return this.mapObject.getContainer()},getMapObjectBoundsFromOLBounds:function(e){var t=null;if(e!=null){var n=this.sphericalMercator?this.inverseMercator(e.bottom,e.left):new OpenLayers.LonLat(e.bottom,e.left);var r=this.sphericalMercator?this.inverseMercator(e.top,e.right):new OpenLayers.LonLat(e.top,e.right);t=new GLatLngBounds(new GLatLng(n.lat,n.lon),new GLatLng(r.lat,r.lon))}return t},setMapObjectCenter:function(e,t){this.mapObject.setCenter(e,t)},dragPanMapObject:function(e,t){this.dragObject.moveBy(new GSize(-e,t))},getMapObjectLonLatFromMapObjectPixel:function(e){return this.mapObject.fromContainerPixelToLatLng(e)},getMapObjectPixelFromMapObjectLonLat:function(e){return this.mapObject.fromLatLngToContainerPixel(e)},getMapObjectZoomFromMapObjectBounds:function(e){return this.mapObject.getBoundsZoomLevel(e)},getMapObjectLonLatFromLonLat:function(e,t){var n;if(this.sphericalMercator){var r=this.inverseMercator(e,t);n=new GLatLng(r.lat,r.lon)}else{n=new GLatLng(t,e)}return n},getMapObjectPixelFromXY:function(e,t){return new GPoint(e,t)}};OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:false,displayClass:"",title:"",autoActivate:false,active:null,handler:null,eventListeners:null,events:null,initialize:function(e){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,e);this.events=new OpenLayers.Events(this);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}},destroy:function(){if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy();this.events=null}this.eventListeners=null;if(this.handler){this.handler.destroy();this.handler=null}if(this.handlers){for(var e in this.handlers){if(this.handlers.hasOwnProperty(e)&&typeof this.handlers[e].destroy=="function"){this.handlers[e].destroy()}}this.handlers=null}if(this.map){this.map.removeControl(this);this.map=null}this.div=null},setMap:function(e){this.map=e;if(this.handler){this.handler.setMap(e)}},draw:function(e){if(this.div==null){this.div=OpenLayers.Util.createDiv(this.id);this.div.className=this.displayClass;if(!this.allowSelection){this.div.className+=" olControlNoSelect";this.div.setAttribute("unselectable","on",0);this.div.onselectstart=OpenLayers.Function.False}if(this.title!=""){this.div.title=this.title}}if(e!=null){this.position=e.clone()}this.moveTo(this.position);return this.div},moveTo:function(e){if(e!=null&&this.div!=null){this.div.style.left=e.x+"px";this.div.style.top=e.y+"px"}},activate:function(){if(this.active){return false}if(this.handler){this.handler.activate()}this.active=true;if(this.map){OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active")}this.events.triggerEvent("activate");return true},deactivate:function(){if(this.active){if(this.handler){this.handler.deactivate()}this.active=false;if(this.map){OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active")}this.events.triggerEvent("deactivate");return true}return false},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var e=[];if(this.map&&this.map.layers){for(var t=0,n=this.map.layers.length;t<n;t++){var r=this.map.layers[t];if(r.attribution&&r.getVisibility()){if(OpenLayers.Util.indexOf(e,r.attribution)===-1){e.push(r.attribution)}}}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:e.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"});OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:["mousedown","mouseup","click","dblclick","touchstart","touchmove","touchend","keydown"],startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(e){this.target=e;for(var t=this.events.length-1;t>=0;--t){this.target.register(this.events[t],this,this.buttonClick,{extension:true})}},destroy:function(){for(var e=this.events.length-1;e>=0;--e){this.target.unregister(this.events[e],this,this.buttonClick)}delete this.target},getPressedButton:function(e){var t=3,n;do{if(OpenLayers.Element.hasClass(e,"olButton")){n=e;break}e=e.parentNode}while(--t>0&&e);return n},buttonClick:function(e){var t=true,n=OpenLayers.Event.element(e);if(n&&(OpenLayers.Event.isLeftClick(e)||!~e.type.indexOf("mouse"))){var r=this.getPressedButton(n);if(r){if(e.type==="keydown"){switch(e.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:r});OpenLayers.Event.stop(e);t=false;break}}else if(this.startEvt){if(this.completeRegEx.test(e.type)){var i=OpenLayers.Util.pagePosition(r);this.target.triggerEvent("buttonclick",{buttonElement:r,buttonXY:{x:this.startEvt.clientX-i[0],y:this.startEvt.clientY-i[1]}})}if(this.cancelRegEx.test(e.type)){delete this.startEvt}OpenLayers.Event.stop(e);t=false}if(this.startRegEx.test(e.type)){this.startEvt=e;OpenLayers.Event.stop(e);t=false}}else{delete this.startEvt}}return t}});OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{roundedCorner:false,roundedCornerColor:"darkblue",layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:true,initialize:function(e){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.layerStates=[];if(this.roundedCorner){OpenLayers.Console.warn("roundedCorner option is deprecated")}},destroy:function(){this.clearLayersArray("base");this.clearLayersArray("data");this.map.events.un({buttonclick:this.onButtonClick,addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.events.unregister("buttonclick",this,this.onButtonClick);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(e){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});if(this.outsideViewport){this.events.attachToElement(this.div);this.events.register("buttonclick",this,this.onButtonClick)}else{this.map.events.register("buttonclick",this,this.onButtonClick)}},draw:function(){OpenLayers.Control.prototype.draw.apply(this);this.loadContents();if(!this.outsideViewport){this.minimizeControl()}this.redraw();return this.div},onButtonClick:function(e){var t=e.buttonElement;if(t===this.minimizeDiv){this.minimizeControl()}else if(t===this.maximizeDiv){this.maximizeControl()}else if(t._layerSwitcher===this.id){if(t["for"]){t=document.getElementById(t["for"])}if(!t.disabled){if(t.type=="radio"){t.checked=true;this.map.setBaseLayer(this.map.getLayer(t._layer))}else{t.checked=!t.checked;this.updateMap()}}}},clearLayersArray:function(e){this[e+"LayersDiv"].innerHTML="";this[e+"Layers"]=[]},checkRedraw:function(){var e=false;if(!this.layerStates.length||this.map.layers.length!=this.layerStates.length){e=true}else{for(var t=0,n=this.layerStates.length;t<n;t++){var r=this.layerStates[t];var i=this.map.layers[t];if(r.name!=i.name||r.inRange!=i.inRange||r.id!=i.id||r.visibility!=i.visibility){e=true;break}}}return e},redraw:function(){if(!this.checkRedraw()){return this.div}this.clearLayersArray("base");this.clearLayersArray("data");var e=false;var t=false;var n=this.map.layers.length;this.layerStates=new Array(n);for(var r=0;r<n;r++){var i=this.map.layers[r];this.layerStates[r]={name:i.name,visibility:i.visibility,inRange:i.inRange,id:i.id}}var s=this.map.layers.slice();if(!this.ascending){s.reverse()}for(var r=0,n=s.length;r<n;r++){var i=s[r];var o=i.isBaseLayer;if(i.displayInLayerSwitcher){if(o){t=true}else{e=true}var u=o?i==this.map.baseLayer:i.getVisibility();var a=document.createElement("input");a.id=this.id+"_input_"+i.name;a.name=o?this.id+"_baseLayers":i.name;a.type=o?"radio":"checkbox";a.value=i.name;a.checked=u;a.defaultChecked=u;a.className="olButton";a._layer=i.id;a._layerSwitcher=this.id;if(!o&&!i.inRange){a.disabled=true}var f=document.createElement("label");f["for"]=a.id;OpenLayers.Element.addClass(f,"labelSpan olButton");f._layer=i.id;f._layerSwitcher=this.id;if(!o&&!i.inRange){f.style.color="gray"}f.innerHTML=i.name;f.style.verticalAlign=o?"bottom":"baseline";var l=document.createElement("br");var c=o?this.baseLayers:this.dataLayers;c.push({layer:i,inputElem:a,labelSpan:f});var h=o?this.baseLayersDiv:this.dataLayersDiv;h.appendChild(a);h.appendChild(f);h.appendChild(l)}}this.dataLbl.style.display=e?"":"none";this.baseLbl.style.display=t?"":"none";return this.div},updateMap:function(){for(var e=0,t=this.baseLayers.length;e<t;e++){var n=this.baseLayers[e];if(n.inputElem.checked){this.map.setBaseLayer(n.layer,false)}}for(var e=0,t=this.dataLayers.length;e<t;e++){var n=this.dataLayers[e];n.layer.setVisibility(n.inputElem.checked)}},maximizeControl:function(e){this.div.style.width="";this.div.style.height="";this.showControls(false);if(e!=null){OpenLayers.Event.stop(e)}},minimizeControl:function(e){this.div.style.width="0px";this.div.style.height="0px";this.showControls(true);if(e!=null){OpenLayers.Event.stop(e)}},showControls:function(e){this.maximizeDiv.style.display=e?"":"none";this.minimizeDiv.style.display=e?"none":"";this.layersDiv.style.display=e?"none":""},loadContents:function(){this.layersDiv=document.createElement("div");this.layersDiv.id=this.id+"_layersDiv";OpenLayers.Element.addClass(this.layersDiv,"layersDiv");this.baseLbl=document.createElement("div");this.baseLbl.innerHTML=OpenLayers.i18n("Base Layer");OpenLayers.Element.addClass(this.baseLbl,"baseLbl");this.baseLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.baseLayersDiv,"baseLayersDiv");this.dataLbl=document.createElement("div");this.dataLbl.innerHTML=OpenLayers.i18n("Overlays");OpenLayers.Element.addClass(this.dataLbl,"dataLbl");this.dataLayersDiv=document.createElement("div");OpenLayers.Element.addClass(this.dataLayersDiv,"dataLayersDiv");if(this.ascending){this.layersDiv.appendChild(this.baseLbl);this.layersDiv.appendChild(this.baseLayersDiv);this.layersDiv.appendChild(this.dataLbl);this.layersDiv.appendChild(this.dataLayersDiv)}else{this.layersDiv.appendChild(this.dataLbl);this.layersDiv.appendChild(this.dataLayersDiv);this.layersDiv.appendChild(this.baseLbl);this.layersDiv.appendChild(this.baseLayersDiv)}this.div.appendChild(this.layersDiv);if(this.roundedCorner){OpenLayers.Rico.Corner.round(this.div,{corners:"tl bl",bgColor:"transparent",color:this.roundedCornerColor,blend:false});OpenLayers.Rico.Corner.changeOpacity(this.layersDiv,.75)}var e=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,null,e,"absolute");OpenLayers.Element.addClass(this.maximizeDiv,"maximizeDiv olButton");this.maximizeDiv.style.display="none";this.div.appendChild(this.maximizeDiv);var e=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,null,e,"absolute");OpenLayers.Element.addClass(this.minimizeDiv,"minimizeDiv olButton");this.minimizeDiv.style.display="none";this.div.appendChild(this.minimizeDiv)},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"});OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:true,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(e,t,n,r,i){this.url=t;this.extent=n;this.maxExtent=n;this.size=r;OpenLayers.Layer.prototype.initialize.apply(this,[e,i]);this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){if(this.tile){this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null}OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){if(e==null){e=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions())}e=OpenLayers.Layer.prototype.clone.apply(this,[e]);return e},setMap:function(e){if(this.options.maxResolution==null){this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w}OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(e,t,n){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var r=this.tile==null;if(t||r){this.setTileSize();var i=this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});if(r){this.tile=new OpenLayers.Tile.Image(this,i,this.extent,null,this.tileSize);this.addTileMonitoringHooks(this.tile)}else{this.tile.size=this.tileSize.clone();this.tile.position=i.clone()}this.tile.draw()}},setTileSize:function(){var e=this.extent.getWidth()/this.map.getResolution();var t=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(e,t)},addTileMonitoringHooks:function(e){e.onLoadStart=function(){this.events.triggerEvent("loadstart")};e.events.register("loadstart",this,e.onLoadStart);e.onLoadEnd=function(){this.events.triggerEvent("loadend")};e.events.register("loadend",this,e.onLoadEnd);e.events.register("unload",this,e.onLoadEnd)},removeTileMonitoringHooks:function(e){e.unload();e.events.un({loadstart:e.onLoadStart,loadend:e.onLoadEnd,unload:e.onLoadEnd,scope:this})},setUrl:function(e){this.url=e;this.tile.draw()},getURL:function(e){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"});OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:false,evt:null,initialize:function(e,t,n){OpenLayers.Util.extend(this,n);this.control=e;this.callbacks=t;var r=this.map||e.map;if(r){this.setMap(r)}this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(e){this.map=e},checkModifiers:function(e){if(this.keyMask==null){return true}var t=(e.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(e.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(e.altKey?OpenLayers.Handler.MOD_ALT:0);return t==this.keyMask},activate:function(){if(this.active){return false}var e=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var t=0,n=e.length;t<n;t++){if(this[e[t]]){this.register(e[t],this[e[t]])}}this.active=true;return true},deactivate:function(){if(!this.active){return false}var e=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var t=0,n=e.length;t<n;t++){if(this[e[t]]){this.unregister(e[t],this[e[t]])}}this.active=false;return true},callback:function(e,t){if(e&&this.callbacks[e]){this.callbacks[e].apply(this.control,t)}},register:function(e,t){this.map.events.registerPriority(e,this,t);this.map.events.registerPriority(e,this,this.setEvent)},unregister:function(e,t){this.map.events.unregister(e,this,t);this.map.events.unregister(e,this,this.setEvent)},setEvent:function(e){this.evt=e;return true},destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:false,stopDown:true,dragging:false,touch:false,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:false,documentEvents:null,initialize:function(e,t,n){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(this.documentDrag===true){var r=this;this._docMove=function(e){r.mousemove({xy:{x:e.clientX,y:e.clientY},element:document})};this._docUp=function(e){r.mouseup({xy:{x:e.clientX,y:e.clientY}})}}},dragstart:function(e){var t=true;this.dragging=false;if(this.checkModifiers(e)&&(OpenLayers.Event.isLeftClick(e)||OpenLayers.Event.isSingleTouch(e))){this.started=true;this.start=e.xy;this.last=e.xy;OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown");this.down(e);this.callback("down",[e.xy]);OpenLayers.Event.stop(e);if(!this.oldOnselectstart){this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True}document.onselectstart=OpenLayers.Function.False;t=!this.stopDown}else{this.started=false;this.start=null;this.last=null}return t},dragmove:function(e){this.lastMoveEvt=e;if(this.started&&!this.timeoutId&&(e.xy.x!=this.last.x||e.xy.y!=this.last.y)){if(this.documentDrag===true&&this.documentEvents){if(e.element===document){this.adjustXY(e);this.setEvent(e)}else{this.removeDocumentEvents()}}if(this.interval>0){this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)}this.dragging=true;this.move(e);this.callback("move",[e.xy]);if(!this.oldOnselectstart){this.oldOnselectstart=document.onselectstart;document.onselectstart=OpenLayers.Function.False}this.last=e.xy}return true},dragend:function(e){if(this.started){if(this.documentDrag===true&&this.documentEvents){this.adjustXY(e);this.removeDocumentEvents()}var t=this.start!=this.last;this.started=false;this.dragging=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(e);this.callback("up",[e.xy]);if(t){this.callback("done",[e.xy])}document.onselectstart=this.oldOnselectstart}return true},down:function(e){},move:function(e){},up:function(e){},out:function(e){},mousedown:function(e){return this.dragstart(e)},touchstart:function(e){if(!this.touch){this.touch=true;this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,mousemove:this.mousemove,click:this.click,scope:this})}return this.dragstart(e)},mousemove:function(e){return this.dragmove(e)},touchmove:function(e){return this.dragmove(e)},removeTimeout:function(){this.timeoutId=null;if(this.dragging){this.mousemove(this.lastMoveEvt)}},mouseup:function(e){return this.dragend(e)},touchend:function(e){e.xy=this.last;return this.dragend(e)},mouseout:function(e){if(this.started&&OpenLayers.Util.mouseLeft(e,this.map.viewPortDiv)){if(this.documentDrag===true){this.addDocumentEvents()}else{var t=this.start!=this.last;this.started=false;this.dragging=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(e);this.callback("out",[]);if(t){this.callback("done",[e.xy])}if(document.onselectstart){document.onselectstart=this.oldOnselectstart}}}return true},click:function(e){return this.start==this.last},activate:function(){var e=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragging=false;e=true}return e},deactivate:function(){var e=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.touch=false;this.started=false;this.dragging=false;this.start=null;this.last=null;e=true;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")}return e},adjustXY:function(e){var t=OpenLayers.Util.pagePosition(this.map.viewPortDiv);e.xy.x-=t[0];e.xy.y-=t[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown");this.documentEvents=true;OpenLayers.Event.observe(document,"mousemove",this._docMove);OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown");this.documentEvents=false;OpenLayers.Event.stopObserving(document,"mousemove",this._docMove);OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"});OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(e,t,n){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);if(this.dragHandler){this.dragHandler.destroy();this.dragHandler=null}},setMap:function(e){OpenLayers.Handler.prototype.setMap.apply(this,arguments);if(this.dragHandler){this.dragHandler.setMap(e)}},startBox:function(e){this.callback("start",[]);this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999});this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE["Popup"]-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(e){var t=this.dragHandler.start.x;var n=this.dragHandler.start.y;var r=Math.abs(t-e.x);var i=Math.abs(n-e.y);var s=this.getBoxOffsets();this.zoomBox.style.width=r+s.width+1+"px";this.zoomBox.style.height=i+s.height+1+"px";this.zoomBox.style.left=(e.x<t?t-r-s.left:t-s.left)+"px";this.zoomBox.style.top=(e.y<n?n-i-s.top:n-s.top)+"px"},endBox:function(e){var t;if(Math.abs(this.dragHandler.start.x-e.x)>5||Math.abs(this.dragHandler.start.y-e.y)>5){var n=this.dragHandler.start;var r=Math.min(n.y,e.y);var i=Math.max(n.y,e.y);var s=Math.min(n.x,e.x);var o=Math.max(n.x,e.x);t=new OpenLayers.Bounds(s,i,o,r)}else{t=this.dragHandler.start.clone()}this.removeBox();this.callback("done",[t])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.zoomBox=null;this.boxOffsets=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragHandler.activate();return true}else{return false}},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){if(this.dragHandler.deactivate()){if(this.zoomBox){this.removeBox()}}return true}else{return false}},getBoxOffsets:function(){if(!this.boxOffsets){var e=document.createElement("div");e.style.position="absolute";e.style.border="1px solid black";e.style.width="3px";document.body.appendChild(e);var t=e.clientWidth==3;document.body.removeChild(e);var n=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width"));var r=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width"));var i=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width"));var s=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:n,right:r,top:i,bottom:s,width:t===false?n+r:0,height:t===false?i+s:0}}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"});OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:false,keyMask:null,alwaysZoom:false,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(e){if(e instanceof OpenLayers.Bounds){var t;if(!this.out){var n=this.map.getLonLatFromPixel({x:e.left,y:e.bottom});var r=this.map.getLonLatFromPixel({x:e.right,y:e.top});t=new OpenLayers.Bounds(n.lon,n.lat,r.lon,r.lat)}else{var i=Math.abs(e.right-e.left);var s=Math.abs(e.top-e.bottom);var o=Math.min(this.map.size.h/s,this.map.size.w/i);var u=this.map.getExtent();var a=this.map.getLonLatFromPixel(e.getCenterPixel());var f=a.lon-u.getWidth()/2*o;var l=a.lon+u.getWidth()/2*o;var c=a.lat-u.getHeight()/2*o;var h=a.lat+u.getHeight()/2*o;t=new OpenLayers.Bounds(f,c,l,h)}var p=this.map.getZoom();this.map.zoomToExtent(t);if(p==this.map.getZoom()&&this.alwaysZoom==true){this.map.zoomTo(p+(this.out?-1:1))}}else{if(!this.out){this.map.setCenter(this.map.getLonLatFromPixel(e),this.map.getZoom()+1)}else{this.map.setCenter(this.map.getLonLatFromPixel(e),this.map.getZoom()-1)}}},CLASS_NAME:"OpenLayers.Control.ZoomBox"});OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:false,interval:1,documentDrag:false,kinetic:null,enableKinetic:false,kineticInterval:10,draw:function(){if(this.enableKinetic){var e={interval:this.kineticInterval};if(typeof this.enableKinetic==="object"){e=OpenLayers.Util.extend(e,this.enableKinetic)}this.kinetic=new OpenLayers.Kinetic(e)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},{interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){if(this.kinetic){this.kinetic.begin()}},panMap:function(e){if(this.kinetic){this.kinetic.update(e)}this.panned=true;this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:true,animate:false})},panMapDone:function(e){if(this.panned){var t=null;if(this.kinetic){t=this.kinetic.end(e)}this.map.pan(this.handler.last.x-e.x,this.handler.last.y-e.y,{dragging:!!t,animate:false});if(t){var n=this;this.kinetic.move(t,function(e,t,r){n.map.pan(e,t,{dragging:!r,animate:false})})}this.panned=false}},CLASS_NAME:"OpenLayers.Control.DragPan"});OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:true,initialize:function(e,t,n){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(e){if(!this.map||!this.checkModifiers(e)){return}var t=false;var n=false;var r=false;var i=OpenLayers.Event.element(e);while(i!=null&&!r&&!t){if(!t){try{if(i.currentStyle){o=i.currentStyle["overflow"]}else{var s=document.defaultView.getComputedStyle(i,null);var o=s.getPropertyValue("overflow")}t=o&&o=="auto"||o=="scroll"}catch(u){}}if(!n){for(var a=0,f=this.map.layers.length;a<f;a++){if(i==this.map.layers[a].div||i==this.map.layers[a].pane){n=true;break}}}r=i==this.map.div;i=i.parentNode}if(!t&&r){if(n){var l=0;if(!e){e=window.event}if(e.wheelDelta){l=e.wheelDelta/120;if(window.opera&&window.opera.version()<9.2){l=-l}}else if(e.detail){l=-e.detail/3}this.delta=this.delta+l;if(this.interval){window.clearTimeout(this._timeoutId);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(e)},this),this.interval)}else{this.wheelZoom(e)}}OpenLayers.Event.stop(e)}},wheelZoom:function(e){var t=this.delta;this.delta=0;if(t){if(this.mousePosition){e.xy=this.mousePosition}if(!e.xy){e.xy=this.map.getPixelFromLonLat(this.map.getCenter())}if(t<0){this.callback("down",[e,this.cumulative?t:-1])}else{this.callback("up",[e,this.cumulative?t:1])}}},mousemove:function(e){this.mousePosition=e.xy},activate:function(e){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var t=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",t);OpenLayers.Event.observe(window,"mousewheel",t);OpenLayers.Event.observe(document,"mousewheel",t);return true}else{return false}},deactivate:function(e){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var t=this.wheelListener;OpenLayers.Event.stopObserving(window,"DOMMouseScroll",t);OpenLayers.Event.stopObserving(window,"mousewheel",t);OpenLayers.Event.stopObserving(document,"mousewheel",t);return true}else{return false}},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:true,"double":false,pixelTolerance:0,dblclickTolerance:13,stopSingle:false,stopDouble:false,timerId:null,touch:false,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(e){if(!this.touch){this.unregisterMouseListeners();this.touch=true}this.down=this.getEventInfo(e);this.last=this.getEventInfo(e);return true},touchmove:function(e){this.last=this.getEventInfo(e);return true},touchend:function(e){if(this.down){e.xy=this.last.xy;e.lastTouches=this.last.touches;this.handleSingle(e);this.down=null}return true},unregisterMouseListeners:function(){this.map.events.un({mousedown:this.mousedown,mouseup:this.mouseup,click:this.click,dblclick:this.dblclick,scope:this})},mousedown:function(e){this.down=this.getEventInfo(e);this.last=this.getEventInfo(e);return true},mouseup:function(e){var t=true;if(this.checkModifiers(e)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(e)){t=this.rightclick(e)}return t},rightclick:function(e){if(this.passesTolerance(e)){if(this.rightclickTimerId!=null){this.clearTimer();this.callback("dblrightclick",[e]);return!this.stopDouble}else{var t=this["double"]?OpenLayers.Util.extend({},e):this.callback("rightclick",[e]);var n=OpenLayers.Function.bind(this.delayedRightCall,this,t);this.rightclickTimerId=window.setTimeout(n,this.delay)}}return!this.stopSingle},delayedRightCall:function(e){this.rightclickTimerId=null;if(e){this.callback("rightclick",[e])}},click:function(e){if(!this.last){this.last=this.getEventInfo(e)}this.handleSingle(e);return!this.stopSingle},dblclick:function(e){this.handleDouble(e);return!this.stopDouble},handleDouble:function(e){if(this.passesDblclickTolerance(e)){if(this["double"]){this.callback("dblclick",[e])}this.clearTimer()}},handleSingle:function(e){if(this.passesTolerance(e)){if(this.timerId!=null){if(this.last.touches&&this.last.touches.length===1){if(this["double"]){OpenLayers.Event.stop(e)}this.handleDouble(e)}if(!this.last.touches||this.last.touches.length!==2){this.clearTimer()}}else{this.first=this.getEventInfo(e);var t=this.single?OpenLayers.Util.extend({},e):null;this.queuePotentialClick(t)}}},queuePotentialClick:function(e){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,e),this.delay)},passesTolerance:function(e){var t=true;if(this.pixelTolerance!=null&&this.down&&this.down.xy){t=this.pixelTolerance>=this.down.xy.distanceTo(e.xy);if(t&&this.touch&&this.down.touches.length===this.last.touches.length){for(var n=0,r=this.down.touches.length;n<r;++n){if(this.getTouchDistance(this.down.touches[n],this.last.touches[n])>this.pixelTolerance){t=false;break}}}}return t},getTouchDistance:function(e,t){return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))},passesDblclickTolerance:function(e){var t=true;if(this.down&&this.first){t=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance}return t},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null}if(this.rightclickTimerId!=null){window.clearTimeout(this.rightclickTimerId);this.rightclickTimerId=null}},delayedCall:function(e){this.timerId=null;if(e){this.callback("click",[e])}},getEventInfo:function(e){var t;if(e.touches){var n=e.touches.length;t=new Array(n);var r;for(var i=0;i<n;i++){r=e.touches[i];t[i]={clientX:r.clientX,clientY:r.clientY}}}return{xy:e.xy,touches:t}},deactivate:function(){var e=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();this.down=null;this.first=null;this.last=null;this.touch=false;e=true}return e},CLASS_NAME:"OpenLayers.Handler.Click"});OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:false,zoomBox:null,zoomBoxEnabled:true,zoomWheelEnabled:true,mouseWheelOptions:null,handleRightClicks:false,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:true,initialize:function(e){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();if(this.dragPan){this.dragPan.destroy()}this.dragPan=null;if(this.zoomBox){this.zoomBox.destroy()}this.zoomBox=null;if(this.pinchZoom){this.pinchZoom.destroy()}this.pinchZoom=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();if(this.zoomWheelEnabled){this.handlers.wheel.activate()}this.handlers.click.activate();if(this.zoomBoxEnabled){this.zoomBox.activate()}if(this.pinchZoom){this.pinchZoom.activate()}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.pinchZoom){this.pinchZoom.deactivate()}this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){if(this.handleRightClicks){this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False}var e={click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick};var t={"double":true,stopDouble:true};this.handlers.click=new OpenLayers.Handler.Click(this,e,t);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions);if(OpenLayers.Control.PinchZoom){this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))}},defaultClick:function(e){if(e.lastTouches&&e.lastTouches.length==2){this.map.zoomOut()}},defaultDblClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(t,this.map.zoom+1)},defaultDblRightClick:function(e){var t=this.map.getLonLatFromViewPortPx(e.xy);this.map.setCenter(t,this.map.zoom-1)},wheelChange:function(e,t){var n=this.map.getZoom();var r=this.map.getZoom()+Math.round(t);r=Math.max(r,0);r=Math.min(r,this.map.getNumZoomLevels());if(r===n){return}var i=this.map.getSize();var s=i.w/2-e.xy.x;var o=e.xy.y-i.h/2;var u=this.map.baseLayer.getResolutionForZoom(r);var a=this.map.getLonLatFromPixel(e.xy);var f=new OpenLayers.LonLat(a.lon+s*u,a.lat+o*u);this.map.setCenter(f,r)},wheelUp:function(e,t){this.wheelChange(e,t||1)},wheelDown:function(e,t){this.wheelChange(e,t||-1)},disableZoomBox:function(){this.zoomBoxEnabled=false;this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=true;if(this.active){this.zoomBox.activate()}},disableZoomWheel:function(){this.zoomWheelEnabled=false;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=true;if(this.active){this.handlers.wheel.activate()}},CLASS_NAME:"OpenLayers.Control.Navigation"});OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:true,encodeBBOX:false,noMagic:false,yx:{},initialize:function(e,t,n,r){var i=[];n=OpenLayers.Util.upperCaseObject(n);if(parseFloat(n.VERSION)>=1.3&&!n.EXCEPTIONS){n.EXCEPTIONS="INIMAGE"}i.push(e,t,n,r);OpenLayers.Layer.Grid.prototype.initialize.apply(this,i);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(!this.noMagic&&this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if(r==null||!r.isBaseLayer){this.isBaseLayer=false}if(this.params.FORMAT=="image/jpeg"){this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"}}},clone:function(e){if(e==null){e=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())}e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e]);return e},reverseAxisOrder:function(){var e=this.projection.getCode();return parseFloat(this.params.VERSION)>=1.3&&!!(this.yx[e]||OpenLayers.Projection.defaults[e].yx)},getURL:function(e){e=this.adjustBounds(e);var t=this.getImageSize();var n={};var r=this.reverseAxisOrder();n.BBOX=this.encodeBBOX?e.toBBOX(null,r):e.toArray(r);n.WIDTH=t.w;n.HEIGHT=t.h;var i=this.getFullRequestString(n);return i},mergeNewParams:function(e){var t=OpenLayers.Util.upperCaseObject(e);var n=[t];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,n)},getFullRequestString:function(e,t){var n=this.map.getProjectionObject();var r=this.projection&&this.projection.equals(n)?this.projection.getCode():n.getCode();var i=r=="none"?null:r;if(parseFloat(this.params.VERSION)>=1.3){this.params.CRS=i}else{this.params.SRS=i}if(typeof this.params.TRANSPARENT=="boolean"){e.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE"}return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:true,initialize:function(e,t){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style["select"]),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style["temporary"]),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(e instanceof OpenLayers.Style){this.styles["default"]=e;this.styles["select"]=e;this.styles["temporary"]=e;this.styles["delete"]=e}else if(typeof e=="object"){for(var n in e){if(e[n]instanceof OpenLayers.Style){this.styles[n]=e[n]}else if(typeof e[n]=="object"){this.styles[n]=new OpenLayers.Style(e[n])}else{this.styles["default"]=new OpenLayers.Style(e);this.styles["select"]=new OpenLayers.Style(e);this.styles["temporary"]=new OpenLayers.Style(e);this.styles["delete"]=new OpenLayers.Style(e);break}}}OpenLayers.Util.extend(this,t)},destroy:function(){for(var e in this.styles){this.styles[e].destroy()}this.styles=null},createSymbolizer:function(e,t){if(!e){e=new OpenLayers.Feature.Vector}if(!this.styles[t]){t="default"}e.renderIntent=t;var n={};if(this.extendDefault&&t!="default"){n=this.styles["default"].createSymbolizer(e)}return OpenLayers.Util.extend(n,this.styles[t].createSymbolizer(e))},addUniqueValueRules:function(e,t,n,r){var i=[];for(var s in n){i.push(new OpenLayers.Rule({symbolizer:n[s],context:r,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:t,value:s})}))}this.styles[e].addRules(i)},CLASS_NAME:"OpenLayers.StyleMap"});OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:false,isFixed:false,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:true,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:false,ratio:1,initialize:function(e,t){OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(!this.renderer||!this.renderer.supported()){this.assignRenderer()}if(!this.renderer||!this.renderer.supported()){this.renderer=null;this.displayError()}if(!this.styleMap){this.styleMap=new OpenLayers.StyleMap}this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies){for(var n=0,r=this.strategies.length;n<r;n++){this.strategies[n].setLayer(this)}}},destroy:function(){if(this.strategies){var e,t,n;for(t=0,n=this.strategies.length;t<n;t++){e=this.strategies[t];if(e.autoDestroy){e.destroy()}}this.strategies=null}if(this.protocol){if(this.protocol.autoDestroy){this.protocol.destroy()}this.protocol=null}this.destroyFeatures();this.features=null;this.selectedFeatures=null;this.unrenderedFeatures=null;if(this.renderer){this.renderer.destroy()}this.renderer=null;this.geometryType=null;this.drawn=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(e){if(e==null){e=new OpenLayers.Layer.Vector(this.name,this.getOptions())}e=OpenLayers.Layer.prototype.clone.apply(this,[e]);var t=this.features;var n=t.length;var r=new Array(n);for(var i=0;i<n;++i){r[i]=t[i].clone()}e.features=r;return e},refresh:function(e){if(this.calculateInRange()&&this.visibility){this.events.triggerEvent("refresh",e)}},assignRenderer:function(){for(var e=0,t=this.renderers.length;e<t;e++){var n=this.renderers[e];var r=typeof n=="function"?n:OpenLayers.Renderer[n];if(r&&r.prototype.supported()){this.renderer=new r(this.div,this.rendererOptions);break}}},displayError:function(){if(this.reportError){OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))}},setMap:function(e){OpenLayers.Layer.prototype.setMap.apply(this,arguments);if(!this.renderer){this.map.removeLayer(this)}else{this.renderer.map=this.map;var t=this.map.getSize();t.w=t.w*this.ratio;t.h=t.h*this.ratio;this.renderer.setSize(t)}},afterAdd:function(){if(this.strategies){var e,t,n;for(t=0,n=this.strategies.length;t<n;t++){e=this.strategies[t];if(e.autoActivate){e.activate()}}}},removeMap:function(e){this.drawn=false;if(this.strategies){var t,n,r;for(n=0,r=this.strategies.length;n<r;n++){t=this.strategies[n];if(t.autoActivate){t.deactivate()}}}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);var e=this.map.getSize();e.w=e.w*this.ratio;e.h=e.h*this.ratio;this.renderer.setSize(e)},moveTo:function(e,t,n){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var r=true;if(!n){this.renderer.root.style.visibility="hidden";var i=this.map.getSize(),s=i.w,o=i.h,u=s/2*this.ratio-s/2,a=o/2*this.ratio-o/2;u+=parseInt(this.map.layerContainerDiv.style.left,10);u=-Math.round(u);a+=parseInt(this.map.layerContainerDiv.style.top,10);a=-Math.round(a);this.div.style.left=u+"px";this.div.style.top=a+"px";var f=this.map.getExtent().scale(this.ratio);r=this.renderer.setExtent(f,t);this.renderer.root.style.visibility="visible";if(OpenLayers.IS_GECKO===true){this.div.scrollLeft=this.div.scrollLeft}if(!t&&r){for(var l in this.unrenderedFeatures){var c=this.unrenderedFeatures[l];this.drawFeature(c)}}}if(!this.drawn||t||!r){this.drawn=true;var c;for(var l=0,h=this.features.length;l<h;l++){this.renderer.locked=l!==h-1;c=this.features[l];this.drawFeature(c)}}},display:function(e){OpenLayers.Layer.prototype.display.apply(this,arguments);var t=this.div.style.display;if(t!=this.renderer.root.style.display){this.renderer.root.style.display=t}},addFeatures:function(e,t){if(!OpenLayers.Util.isArray(e)){e=[e]}var n=!t||!t.silent;if(n){var r={features:e};var i=this.events.triggerEvent("beforefeaturesadded",r);if(i===false){return}e=r.features}var s=[];for(var o=0,u=e.length;o<u;o++){if(o!=e.length-1){this.renderer.locked=true}else{this.renderer.locked=false}var a=e[o];if(this.geometryType&&!(a.geometry instanceof this.geometryType)){throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME)}a.layer=this;if(!a.style&&this.style){a.style=OpenLayers.Util.extend({},this.style)}if(n){if(this.events.triggerEvent("beforefeatureadded",{feature:a})===false){continue}this.preFeatureInsert(a)}s.push(a);this.features.push(a);this.drawFeature(a);if(n){this.events.triggerEvent("featureadded",{feature:a});this.onFeatureInsert(a)}}if(n){this.events.triggerEvent("featuresadded",{features:s})}},removeFeatures:function(e,t){if(!e||e.length===0){return}if(e===this.features){return this.removeAllFeatures(t)}if(!OpenLayers.Util.isArray(e)){e=[e]}if(e===this.selectedFeatures){e=e.slice()}var n=!t||!t.silent;if(n){this.events.triggerEvent("beforefeaturesremoved",{features:e})}for(var r=e.length-1;r>=0;r--){if(r!=0&&e[r-1].geometry){this.renderer.locked=true}else{this.renderer.locked=false}var i=e[r];delete this.unrenderedFeatures[i.id];if(n){this.events.triggerEvent("beforefeatureremoved",{feature:i})}this.features=OpenLayers.Util.removeItem(this.features,i);i.layer=null;if(i.geometry){this.renderer.eraseFeatures(i)}if(OpenLayers.Util.indexOf(this.selectedFeatures,i)!=-1){OpenLayers.Util.removeItem(this.selectedFeatures,i)}if(n){this.events.triggerEvent("featureremoved",{feature:i})}}if(n){this.events.triggerEvent("featuresremoved",{features:e})}},removeAllFeatures:function(e){var t=!e||!e.silent;var n=this.features;if(t){this.events.triggerEvent("beforefeaturesremoved",{features:n})}var r;for(var i=n.length-1;i>=0;i--){r=n[i];if(t){this.events.triggerEvent("beforefeatureremoved",{feature:r})}r.layer=null;if(t){this.events.triggerEvent("featureremoved",{feature:r})}}this.renderer.clear();this.features=[];this.unrenderedFeatures={};this.selectedFeatures=[];if(t){this.events.triggerEvent("featuresremoved",{features:n})}},destroyFeatures:function(e,t){var n=e==undefined;if(n){e=this.features}if(e){this.removeFeatures(e,t);for(var r=e.length-1;r>=0;r--){e[r].destroy()}}},drawFeature:function(e,t){if(!this.drawn){return}if(typeof t!="object"){if(!t&&e.state===OpenLayers.State.DELETE){t="delete"}var n=t||e.renderIntent;t=e.style||this.style;if(!t){t=this.styleMap.createSymbolizer(e,n)}}var r=this.renderer.drawFeature(e,t);if(r===false||r===null){this.unrenderedFeatures[e.id]=e}else{delete this.unrenderedFeatures[e.id]}},eraseFeatures:function(e){this.renderer.eraseFeatures(e)},getFeatureFromEvent:function(e){if(!this.renderer){throw new Error("getFeatureFromEvent called on layer with no "+"renderer. This usually means you destroyed a "+"layer, but not some handler which is associated "+"with it.")}var t=null;var n=this.renderer.getFeatureIdFromEvent(e);if(n){if(typeof n==="string"){t=this.getFeatureById(n)}else{t=n}}return t},getFeatureBy:function(e,t){var n=null;for(var r=0,i=this.features.length;r<i;++r){if(this.features[r][e]==t){n=this.features[r];break}}return n},getFeatureById:function(e){return this.getFeatureBy("id",e)},getFeatureByFid:function(e){return this.getFeatureBy("fid",e)},getFeaturesByAttribute:function(e,t){var n,r,i=this.features.length,s=[];for(n=0;n<i;n++){r=this.features[n];if(r&&r.attributes){if(r.attributes[e]===t){s.push(r)}}}return s},onFeatureInsert:function(e){},preFeatureInsert:function(e){},getDataExtent:function(){var e=null;var t=this.features;if(t&&t.length>0){var n=null;for(var r=0,i=t.length;r<i;r++){n=t[r].geometry;if(n){if(e===null){e=new OpenLayers.Bounds}e.extend(n.getBounds())}}}return e},CLASS_NAME:"OpenLayers.Layer.Vector"});OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,sphericalMercator:false,zoomOffset:0,serverResolutions:null,initialize:function(e,t,n){if(n&&n.sphericalMercator||this.sphericalMercator){n=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},n)}OpenLayers.Layer.Grid.prototype.initialize.apply(this,[e||this.name,t||this.url,{},n])},clone:function(e){if(e==null){e=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions())}e=OpenLayers.Layer.Grid.prototype.clone.apply(this,[e]);return e},getURL:function(e){var t=this.getXYZ(e);var n=this.url;if(OpenLayers.Util.isArray(n)){var r=""+t.x+t.y+t.z;n=this.selectUrl(r,n)}return OpenLayers.String.format(n,t)},getXYZ:function(e){var t=this.getServerResolution();var n=Math.round((e.left-this.maxExtent.left)/(t*this.tileSize.w));var r=Math.round((this.maxExtent.top-e.top)/(t*this.tileSize.h));var i=this.getServerZoom();if(this.wrapDateLine){var s=Math.pow(2,i);n=(n%s+s)%s}return{x:n,y:r,z:i}},setMap:function(e){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom)}},CLASS_NAME:"OpenLayers.Layer.XYZ"});OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],attribution:"Data CC-By-SA by <a href='http://openstreetmap.org/'>OpenStreetMap</a>",sphericalMercator:true,wrapDateLine:true,tileOptions:null,initialize:function(e,t,n){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments);this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options&&this.options.tileOptions)},clone:function(e){if(e==null){e=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions())}e=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[e]);return e},CLASS_NAME:"OpenLayers.Layer.OSM"});OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:true,hitOverflow:0,canvas:null,features:null,pendingRedraw:false,cachedSymbolBounds:{},initialize:function(e,t){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement("canvas");this.container.appendChild(this.root);this.canvas=this.root.getContext("2d");this.features={};if(this.hitDetection){this.hitCanvas=document.createElement("canvas");this.hitContext=this.hitCanvas.getContext("2d")}},setExtent:function(){OpenLayers.Renderer.prototype.setExtent.apply(this,arguments);return false},eraseGeometry:function(e,t){this.eraseFeatures(this.features[t][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(e){this.size=e.clone();var t=this.root;t.style.width=e.w+"px";t.style.height=e.h+"px";t.width=e.w;t.height=e.h;this.resolution=null;if(this.hitDetection){var n=this.hitCanvas;n.style.width=e.w+"px";n.style.height=e.h+"px";n.width=e.w;n.height=e.h}},drawFeature:function(e,t){var n;if(e.geometry){t=this.applyDefaultSymbolizer(t||e.style);var r=e.geometry.getBounds();var i;if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){i=this.map.getMaxExtent()}var s=r&&r.intersectsBounds(this.extent,{worldBounds:i});n=t.display!=="none"&&!!r&&s;if(n){this.features[e.id]=[e,t]}else{delete this.features[e.id]}this.pendingRedraw=true}if(this.pendingRedraw&&!this.locked){this.redraw();this.pendingRedraw=false}return n},drawGeometry:function(e,t,n){var r=e.CLASS_NAME;if(r=="OpenLayers.Geometry.Collection"||r=="OpenLayers.Geometry.MultiPoint"||r=="OpenLayers.Geometry.MultiLineString"||r=="OpenLayers.Geometry.MultiPolygon"){for(var i=0;i<e.components.length;i++){this.drawGeometry(e.components[i],t,n)}return}switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":this.drawPoint(e,t,n);break;case"OpenLayers.Geometry.LineString":this.drawLineString(e,t,n);break;case"OpenLayers.Geometry.LinearRing":this.drawLinearRing(e,t,n);break;case"OpenLayers.Geometry.Polygon":this.drawPolygon(e,t,n);break;default:break}},drawExternalGraphic:function(e,t,n){var r=new Image;if(t.graphicTitle){r.title=t.graphicTitle}var i=t.graphicWidth||t.graphicHeight;var s=t.graphicHeight||t.graphicWidth;i=i?i:t.pointRadius*2;s=s?s:t.pointRadius*2;var o=t.graphicXOffset!=undefined?t.graphicXOffset:-(.5*i);var u=t.graphicYOffset!=undefined?t.graphicYOffset:-(.5*s);var a=t.graphicOpacity||t.fillOpacity;var f=function(){if(!this.features[n]){return}var t=this.getLocalXY(e);var f=t[0];var l=t[1];if(!isNaN(f)&&!isNaN(l)){var c=f+o|0;var h=l+u|0;var p=this.canvas;p.globalAlpha=a;var d=OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);p.drawImage(r,c*d,h*d,i*d,s*d);if(this.hitDetection){this.setHitContextStyle("fill",n);this.hitContext.fillRect(c,h,i,s)}}};r.onload=OpenLayers.Function.bind(f,this);r.src=t.externalGraphic},drawNamedSymbol:function(e,t,n){var r,i,s,o,u,a,f,l;var c;var h=Math.PI/180;var p=OpenLayers.Renderer.symbol[t.graphicName];if(!p){throw new Error(t.graphicName+" is not a valid symbol name")}if(!p.length||p.length<2)return;var d=this.getLocalXY(e);var v=d[0];var m=d[1];if(isNaN(v)||isNaN(m))return;this.canvas.lineCap="round";this.canvas.lineJoin="round";if(this.hitDetection){this.hitContext.lineCap="round";this.hitContext.lineJoin="round"}if(t.graphicName in this.cachedSymbolBounds){a=this.cachedSymbolBounds[t.graphicName]}else{a=new OpenLayers.Bounds;for(u=0;u<p.length;u+=2){a.extend(new OpenLayers.LonLat(p[u],p[u+1]))}this.cachedSymbolBounds[t.graphicName]=a}this.canvas.save();if(this.hitDetection){this.hitContext.save()}this.canvas.translate(v,m);if(this.hitDetection){this.hitContext.translate(v,m)}l=h*t.rotation;if(!isNaN(l)){this.canvas.rotate(l);if(this.hitDetection){this.hitContext.rotate(l)}}f=2*t.pointRadius/Math.max(a.getWidth(),a.getHeight());this.canvas.scale(f,f);if(this.hitDetection){this.hitContext.scale(f,f)}s=a.getCenterLonLat().lon;o=a.getCenterLonLat().lat;this.canvas.translate(-s,-o);if(this.hitDetection){this.hitContext.translate(-s,-o)}c=t.strokeWidth;t.strokeWidth=c/f;if(t.fill!==false){this.setCanvasStyle("fill",t);this.canvas.beginPath();for(u=0;u<p.length;u=u+2){r=p[u];i=p[u+1];if(u==0)this.canvas.moveTo(r,i);this.canvas.lineTo(r,i)}this.canvas.closePath();this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",n,t);this.hitContext.beginPath();for(u=0;u<p.length;u=u+2){r=p[u];i=p[u+1];if(u==0)this.canvas.moveTo(r,i);this.hitContext.lineTo(r,i)}this.hitContext.closePath();this.hitContext.fill()}}if(t.stroke!==false){this.setCanvasStyle("stroke",t);this.canvas.beginPath();for(u=0;u<p.length;u=u+2){r=p[u];i=p[u+1];if(u==0)this.canvas.moveTo(r,i);this.canvas.lineTo(r,i)}this.canvas.closePath();this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",n,t,f);this.hitContext.beginPath();for(u=0;u<p.length;u=u+2){r=p[u];i=p[u+1];if(u==0)this.hitContext.moveTo(r,i);this.hitContext.lineTo(r,i)}this.hitContext.closePath();this.hitContext.stroke()}}t.strokeWidth=c;this.canvas.restore();if(this.hitDetection){this.hitContext.restore()}this.setCanvasStyle("reset")},setCanvasStyle:function(e,t){if(e==="fill"){this.canvas.globalAlpha=t["fillOpacity"];this.canvas.fillStyle=t["fillColor"]}else if(e==="stroke"){this.canvas.globalAlpha=t["strokeOpacity"];this.canvas.strokeStyle=t["strokeColor"];this.canvas.lineWidth=t["strokeWidth"]}else{this.canvas.globalAlpha=0;this.canvas.lineWidth=1}},featureIdToHex:function(e){var t=Number(e.split("_").pop())+1;if(t>=16777216){this.hitOverflow=t-16777215;t=t%16777216+1}var n="000000"+t.toString(16);var r=n.length;n="#"+n.substring(r-6,r);return n},setHitContextStyle:function(e,t,n,r){var i=this.featureIdToHex(t);if(e=="fill"){this.hitContext.globalAlpha=1;this.hitContext.fillStyle=i}else if(e=="stroke"){this.hitContext.globalAlpha=1;this.hitContext.strokeStyle=i;if(typeof r==="undefined"){this.hitContext.lineWidth=n.strokeWidth+2}else{if(!isNaN(r)){this.hitContext.lineWidth=n.strokeWidth+2/r}}}else{this.hitContext.globalAlpha=0;this.hitContext.lineWidth=1}},drawPoint:function(e,t,n){if(t.graphic!==false){if(t.externalGraphic){this.drawExternalGraphic(e,t,n)}else if(t.graphicName&&t.graphicName!="circle"){this.drawNamedSymbol(e,t,n)}else{var r=this.getLocalXY(e);var i=r[0];var s=r[1];if(!isNaN(i)&&!isNaN(s)){var o=Math.PI*2;var u=t.pointRadius;if(t.fill!==false){this.setCanvasStyle("fill",t);this.canvas.beginPath();this.canvas.arc(i,s,u,0,o,true);this.canvas.fill();if(this.hitDetection){this.setHitContextStyle("fill",n,t);this.hitContext.beginPath();this.hitContext.arc(i,s,u,0,o,true);this.hitContext.fill()}}if(t.stroke!==false){this.setCanvasStyle("stroke",t);this.canvas.beginPath();this.canvas.arc(i,s,u,0,o,true);this.canvas.stroke();if(this.hitDetection){this.setHitContextStyle("stroke",n,t);this.hitContext.beginPath();this.hitContext.arc(i,s,u,0,o,true);this.hitContext.stroke()}this.setCanvasStyle("reset")}}}}},drawLineString:function(e,t,n){t=OpenLayers.Util.applyDefaults({fill:false},t);this.drawLinearRing(e,t,n)},drawLinearRing:function(e,t,n){if(t.fill!==false){this.setCanvasStyle("fill",t);this.renderPath(this.canvas,e,t,n,"fill");if(this.hitDetection){this.setHitContextStyle("fill",n,t);this.renderPath(this.hitContext,e,t,n,"fill")}}if(t.stroke!==false){this.setCanvasStyle("stroke",t);this.renderPath(this.canvas,e,t,n,"stroke");if(this.hitDetection){this.setHitContextStyle("stroke",n,t);this.renderPath(this.hitContext,e,t,n,"stroke")}}this.setCanvasStyle("reset")},renderPath:function(e,t,n,r,i){var s=t.components;var o=s.length;e.beginPath();var u=this.getLocalXY(s[0]);var a=u[0];var f=u[1];if(!isNaN(a)&&!isNaN(f)){e.moveTo(u[0],u[1]);for(var l=1;l<o;++l){var c=this.getLocalXY(s[l]);e.lineTo(c[0],c[1])}if(i==="fill"){e.fill()}else{e.stroke()}}},drawPolygon:function(e,t,n){var r=e.components;var i=r.length;this.drawLinearRing(r[0],t,n);for(var s=1;s<i;++s){this.canvas.globalCompositeOperation="destination-out";if(this.hitDetection){this.hitContext.globalCompositeOperation="destination-out"}this.drawLinearRing(r[s],OpenLayers.Util.applyDefaults({stroke:false,fillOpacity:1},t),n);this.canvas.globalCompositeOperation="source-over";if(this.hitDetection){this.hitContext.globalCompositeOperation="source-over"}this.drawLinearRing(r[s],OpenLayers.Util.applyDefaults({fill:false},t),n)}},drawText:function(e,t){var n=this.getLocalXY(e);this.setCanvasStyle("reset");this.canvas.fillStyle=t.fontColor;this.canvas.globalAlpha=t.fontOpacity||1;var r=[t.fontStyle?t.fontStyle:"normal","normal",t.fontWeight?t.fontWeight:"normal",t.fontSize?t.fontSize:"1em",t.fontFamily?t.fontFamily:"sans-serif"].join(" ");var i=t.label.split("\n");var s=i.length;if(this.canvas.fillText){this.canvas.font=r;this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[0]]||"center";this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[t.labelAlign[1]]||"middle";var o=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];if(o==null){o=-.5}var u=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;n[1]+=u*o*(s-1);for(var a=0;a<s;a++){if(t.labelOutlineWidth){this.canvas.save();this.canvas.strokeStyle=t.labelOutlineColor;this.canvas.lineWidth=t.labelOutlineWidth;this.canvas.strokeText(i[a],n[0],n[1]+u*a+1);this.canvas.restore()}this.canvas.fillText(i[a],n[0],n[1]+u*a)}}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=r;var f=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[0]];if(f==null){f=-.5}var o=OpenLayers.Renderer.Canvas.LABEL_FACTOR[t.labelAlign[1]];if(o==null){o=-.5}var u=this.canvas.mozMeasureText("xx");n[1]+=u*(1+o*s);for(var a=0;a<s;a++){var l=n[0]+f*this.canvas.mozMeasureText(i[a]);var c=n[1]+a*u;this.canvas.translate(l,c);this.canvas.mozDrawText(i[a]);this.canvas.translate(-l,-c)}}this.setCanvasStyle("reset")},getLocalXY:function(e){var t=this.getResolution();var n=this.extent;var r=(e.x-this.featureDx)/t+ -n.left/t;var i=n.top/t-e.y/t;return[r,i]},clear:function(){var e=this.root.height;var t=this.root.width;this.canvas.clearRect(0,0,t,e);this.features={};if(this.hitDetection){this.hitContext.clearRect(0,0,t,e)}},getFeatureIdFromEvent:function(e){var t,n;if(this.hitDetection&&this.root.style.display!=="none"){if(!this.map.dragging){var r=e.xy;var i=r.x|0;var s=r.y|0;var o=this.hitContext.getImageData(i,s,1,1).data;if(o[3]===255){var u=o[2]+256*(o[1]+256*o[0]);if(u){t="OpenLayers.Feature.Vector_"+(u-1+this.hitOverflow);try{n=this.features[t][0]}catch(a){}}}}}return n},eraseFeatures:function(e){if(!OpenLayers.Util.isArray(e)){e=[e]}for(var t=0;t<e.length;++t){delete this.features[e[t].id]}this.redraw()},redraw:function(){if(!this.locked){var e=this.root.height;var t=this.root.width;this.canvas.clearRect(0,0,t,e);if(this.hitDetection){this.hitContext.clearRect(0,0,t,e)}var n=[];var r,i,s;var o=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent();for(var u in this.features){if(!this.features.hasOwnProperty(u)){continue}r=this.features[u][0];i=r.geometry;this.calculateFeatureDx(i.getBounds(),o);s=this.features[u][1];this.drawGeometry(i,s,r.id);if(s.label){n.push([r,s])}}var a;for(var f=0,l=n.length;f<l;++f){a=n[f];this.drawText(a[0].geometry.getCentroid(),a[1])}}},CLASS_NAME:"OpenLayers.Renderer.Canvas"});OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"};OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1};OpenLayers.Renderer.Canvas.drawImageScaleFactor=null;OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15e3,translationParameters:null,symbolMetrics:null,initialize:function(e){if(!this.supported()){return}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments);this.translationParameters={x:0,y:0};this.symbolMetrics={}},supported:function(){var e="http://www.w3.org/TR/SVG11/feature#";return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(e+"SVG","1.1")||document.implementation.hasFeature(e+"BasicStructure","1.1"))},inValidRange:function(e,t,n){var r=e+(n?0:this.translationParameters.x);var i=t+(n?0:this.translationParameters.y);return r>=-this.MAX_PIXEL&&r<=this.MAX_PIXEL&&i>=-this.MAX_PIXEL&&i<=this.MAX_PIXEL},setExtent:function(e,t){var n=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var r=this.getResolution(),i=-e.left/r,s=e.top/r;if(t){this.left=i;this.top=s;var o="0 0 "+this.size.w+" "+this.size.h;this.rendererRoot.setAttributeNS(null,"viewBox",o);this.translate(this.xOffset,0);return true}else{var u=this.translate(i-this.left+this.xOffset,s-this.top);if(!u){this.setExtent(e,true)}return n&&u}},translate:function(e,t){if(!this.inValidRange(e,t,true)){return false}else{var n="";if(e||t){n="translate("+e+","+t+")"}this.root.setAttributeNS(null,"transform",n);this.translationParameters={x:e,y:t};return true}},setSize:function(e){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,"width",this.size.w);this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(e,t){var n=null;switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":if(t.externalGraphic){n="image"}else if(this.isComplexSymbol(t.graphicName)){n="svg"}else{n="circle"}break;case"OpenLayers.Geometry.Rectangle":n="rect";break;case"OpenLayers.Geometry.LineString":n="polyline";break;case"OpenLayers.Geometry.LinearRing":n="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":n="path";break;default:break}return n},setStyle:function(e,t,n){t=t||e._style;n=n||e._options;var r=parseFloat(e.getAttributeNS(null,"r"));var i=1;var s;if(e._geometryClass=="OpenLayers.Geometry.Point"&&r){e.style.visibility="";if(t.graphic===false){e.style.visibility="hidden"}else if(t.externalGraphic){s=this.getPosition(e);if(t.graphicTitle){e.setAttributeNS(null,"title",t.graphicTitle);var o=e.getElementsByTagName("title");if(o.length>0){o[0].firstChild.textContent=t.graphicTitle}else{var u=this.nodeFactory(null,"title");u.textContent=t.graphicTitle;e.appendChild(u)}}if(t.graphicWidth&&t.graphicHeight){e.setAttributeNS(null,"preserveAspectRatio","none")}var a=t.graphicWidth||t.graphicHeight;var f=t.graphicHeight||t.graphicWidth;a=a?a:t.pointRadius*2;f=f?f:t.pointRadius*2;var l=t.graphicXOffset!=undefined?t.graphicXOffset:-(.5*a);var c=t.graphicYOffset!=undefined?t.graphicYOffset:-(.5*f);var h=t.graphicOpacity||t.fillOpacity;e.setAttributeNS(null,"x",(s.x+l).toFixed());e.setAttributeNS(null,"y",(s.y+c).toFixed());e.setAttributeNS(null,"width",a);e.setAttributeNS(null,"height",f);e.setAttributeNS(this.xlinkns,"href",t.externalGraphic);e.setAttributeNS(null,"style","opacity: "+h);e.onclick=OpenLayers.Renderer.SVG.preventDefault}else if(this.isComplexSymbol(t.graphicName)){var p=t.pointRadius*3;var d=p*2;var v=this.importSymbol(t.graphicName);s=this.getPosition(e);i=this.symbolMetrics[v.id][0]*3/d;var m=e.parentNode;var g=e.nextSibling;if(m){m.removeChild(e)}e.firstChild&&e.removeChild(e.firstChild);e.appendChild(v.firstChild.cloneNode(true));e.setAttributeNS(null,"viewBox",v.getAttributeNS(null,"viewBox"));e.setAttributeNS(null,"width",d);e.setAttributeNS(null,"height",d);e.setAttributeNS(null,"x",s.x-p);e.setAttributeNS(null,"y",s.y-p);if(g){m.insertBefore(e,g)}else if(m){m.appendChild(e)}}else{e.setAttributeNS(null,"r",t.pointRadius)}var y=t.rotation;if((y!==undefined||e._rotation!==undefined)&&s){e._rotation=y;y|=0;if(e.nodeName!=="svg"){e.setAttributeNS(null,"transform","rotate("+y+" "+s.x+" "+s.y+")")}else{var b=this.symbolMetrics[v.id];e.firstChild.setAttributeNS(null,"transform","rotate("+y+" "+b[1]+" "+b[2]+")")}}}if(n.isFilled){e.setAttributeNS(null,"fill",t.fillColor);e.setAttributeNS(null,"fill-opacity",t.fillOpacity)}else{e.setAttributeNS(null,"fill","none")}if(n.isStroked){e.setAttributeNS(null,"stroke",t.strokeColor);e.setAttributeNS(null,"stroke-opacity",t.strokeOpacity);e.setAttributeNS(null,"stroke-width",t.strokeWidth*i);e.setAttributeNS(null,"stroke-linecap",t.strokeLinecap||"round");e.setAttributeNS(null,"stroke-linejoin","round");t.strokeDashstyle&&e.setAttributeNS(null,"stroke-dasharray",this.dashStyle(t,i))}else{e.setAttributeNS(null,"stroke","none")}if(t.pointerEvents){e.setAttributeNS(null,"pointer-events",t.pointerEvents)}if(t.cursor!=null){e.setAttributeNS(null,"cursor",t.cursor)}return e},dashStyle:function(e,t){var n=e.strokeWidth*t;var r=e.strokeDashstyle;switch(r){case"solid":return"none";case"dot":return[1,4*n].join();case"dash":return[4*n,4*n].join();case"dashdot":return[4*n,4*n,1,4*n].join();case"longdash":return[8*n,4*n].join();case"longdashdot":return[8*n,4*n,1,4*n].join();default:return OpenLayers.String.trim(r).replace(/\s+/g,",")}},createNode:function(e,t){var n=document.createElementNS(this.xmlns,e);if(t){n.setAttributeNS(null,"id",t)}return n},nodeTypeCompare:function(e,t){return t==e.nodeName},createRenderRoot:function(){var e=this.nodeFactory(this.container.id+"_svgRoot","svg");e.style.display="block";return e},createRoot:function(e){return this.nodeFactory(this.container.id+e,"g")},createDefs:function(){var e=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(e);return e},drawPoint:function(e,t){return this.drawCircle(e,t,1)},drawCircle:function(e,t,n){var r=this.getResolution();var i=(t.x-this.featureDx)/r+this.left;var s=this.top-t.y/r;if(this.inValidRange(i,s)){e.setAttributeNS(null,"cx",i);e.setAttributeNS(null,"cy",s);e.setAttributeNS(null,"r",n);return e}else{return false}},drawLineString:function(e,t){var n=this.getComponentsString(t.components);if(n.path){e.setAttributeNS(null,"points",n.path);return n.complete?e:null}else{return false}},drawLinearRing:function(e,t){var n=this.getComponentsString(t.components);if(n.path){e.setAttributeNS(null,"points",n.path);return n.complete?e:null}else{return false}},drawPolygon:function(e,t){var n="";var r=true;var i=true;var s,o;for(var u=0,a=t.components.length;u<a;u++){n+=" M";s=this.getComponentsString(t.components[u].components," ");o=s.path;if(o){n+=" "+o;i=s.complete&&i}else{r=false}}n+=" z";if(r){e.setAttributeNS(null,"d",n);e.setAttributeNS(null,"fill-rule","evenodd");return i?e:null}else{return false}},drawRectangle:function(e,t){var n=this.getResolution();var r=(t.x-this.featureDx)/n+this.left;var i=this.top-t.y/n;if(this.inValidRange(r,i)){e.setAttributeNS(null,"x",r);e.setAttributeNS(null,"y",i);e.setAttributeNS(null,"width",t.width/n);e.setAttributeNS(null,"height",t.height/n);return e}else{return false}},drawText:function(e,t,n){var r=!!t.labelOutlineWidth;if(r){var i=OpenLayers.Util.extend({},t);i.fontColor=i.labelOutlineColor;i.fontStrokeColor=i.labelOutlineColor;i.fontStrokeWidth=t.labelOutlineWidth;delete i.labelOutlineWidth;this.drawText(e,i,n)}var s=this.getResolution();var o=(n.x-this.featureDx)/s+this.left;var u=n.y/s-this.top;var a=r?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX;var f=this.nodeFactory(e+a,"text");f.setAttributeNS(null,"x",o);f.setAttributeNS(null,"y",-u);if(t.fontColor){f.setAttributeNS(null,"fill",t.fontColor)}if(t.fontStrokeColor){f.setAttributeNS(null,"stroke",t.fontStrokeColor)}if(t.fontStrokeWidth){f.setAttributeNS(null,"stroke-width",t.fontStrokeWidth)}if(t.fontOpacity){f.setAttributeNS(null,"opacity",t.fontOpacity)}if(t.fontFamily){f.setAttributeNS(null,"font-family",t.fontFamily)}if(t.fontSize){f.setAttributeNS(null,"font-size",t.fontSize)}if(t.fontWeight){f.setAttributeNS(null,"font-weight",t.fontWeight)}if(t.fontStyle){f.setAttributeNS(null,"font-style",t.fontStyle)}if(t.labelSelect===true){f.setAttributeNS(null,"pointer-events","visible");f._featureId=e}else{f.setAttributeNS(null,"pointer-events","none")}var l=t.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;f.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[l[0]]||"middle");if(OpenLayers.IS_GECKO===true){f.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[l[1]]||"central")}var c=t.label.split("\n");var h=c.length;while(f.childNodes.length>h){f.removeChild(f.lastChild)}for(var p=0;p<h;p++){var d=this.nodeFactory(e+a+"_tspan_"+p,"tspan");if(t.labelSelect===true){d._featureId=e;d._geometry=n;d._geometryClass=n.CLASS_NAME}if(OpenLayers.IS_GECKO===false){d.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[l[1]]||"-35%")}d.setAttribute("x",o);if(p==0){var v=OpenLayers.Renderer.SVG.LABEL_VFACTOR[l[1]];if(v==null){v=-.5}d.setAttribute("dy",v*(h-1)+"em")}else{d.setAttribute("dy","1em")}d.textContent=c[p]===""?" ":c[p];if(!d.parentNode){f.appendChild(d)}}if(!f.parentNode){this.textRoot.appendChild(f)}},getComponentsString:function(e,t){var n=[];var r=true;var i=e.length;var s=[];var o,u;for(var a=0;a<i;a++){u=e[a];n.push(u);o=this.getShortString(u);if(o){s.push(o)}else{if(a>0){if(this.getShortString(e[a-1])){s.push(this.clipLine(e[a],e[a-1]))}}if(a<i-1){if(this.getShortString(e[a+1])){s.push(this.clipLine(e[a],e[a+1]))}}r=false}}return{path:s.join(t||","),complete:r}},clipLine:function(e,t){if(t.equals(e)){return""}var n=this.getResolution();var r=this.MAX_PIXEL-this.translationParameters.x;var i=this.MAX_PIXEL-this.translationParameters.y;var s=(t.x-this.featureDx)/n+this.left;var o=this.top-t.y/n;var u=(e.x-this.featureDx)/n+this.left;var a=this.top-e.y/n;var f;if(u<-r||u>r){f=(a-o)/(u-s);u=u<0?-r:r;a=o+(u-s)*f}if(a<-i||a>i){f=(u-s)/(a-o);a=a<0?-i:i;u=s+(a-o)*f}return u+","+a},getShortString:function(e){var t=this.getResolution();var n=(e.x-this.featureDx)/t+this.left;var r=this.top-e.y/t;if(this.inValidRange(n,r)){return n+","+r}else{return false}},getPosition:function(e){return{x:parseFloat(e.getAttributeNS(null,"cx")),y:parseFloat(e.getAttributeNS(null,"cy"))}},importSymbol:function(e){if(!this.defs){this.defs=this.createDefs()}var t=this.container.id+"-"+e;var n=document.getElementById(t);if(n!=null){return n}var r=OpenLayers.Renderer.symbol[e];if(!r){throw new Error(e+" is not a valid symbol name")}var i=this.nodeFactory(t,"symbol");var s=this.nodeFactory(null,"polygon");i.appendChild(s);var o=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);var u=[];var a,f;for(var l=0;l<r.length;l=l+2){a=r[l];f=r[l+1];o.left=Math.min(o.left,a);o.bottom=Math.min(o.bottom,f);o.right=Math.max(o.right,a);o.top=Math.max(o.top,f);u.push(a,",",f)}s.setAttributeNS(null,"points",u.join(" "));var c=o.getWidth();var h=o.getHeight();var p=[o.left-c,o.bottom-h,c*3,h*3];i.setAttributeNS(null,"viewBox",p.join(" "));this.symbolMetrics[t]=[Math.max(c,h),o.getCenterLonLat().lon,o.getCenterLonLat().lat];this.defs.appendChild(i);return i},getFeatureIdFromEvent:function(e){var t=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!t){var n=e.target;t=n.parentNode&&n!=this.rendererRoot?n.parentNode._featureId:undefined}return t},CLASS_NAME:"OpenLayers.Renderer.SVG"});OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"};OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1};OpenLayers.Renderer.SVG.preventDefault=function(e){e.preventDefault&&e.preventDefault()};OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(e){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y);OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.map){this.map.events.unregister("buttonclick",this,this.onButtonClick)}this.removeButtons();this.buttons=null;this.position=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(e){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(e){OpenLayers.Control.prototype.draw.apply(this,arguments);e=this.position;this.buttons=[];var t={w:18,h:18};var n=new OpenLayers.Pixel(e.x+t.w/2,e.y);this._addButton("panup","north-mini.png",n,t);e.y=n.y+t.h;this._addButton("panleft","west-mini.png",e,t);this._addButton("panright","east-mini.png",e.add(t.w,0),t);this._addButton("pandown","south-mini.png",n.add(0,t.h*2),t);this._addButton("zoomin","zoom-plus-mini.png",n.add(0,t.h*3+5),t);this._addButton("zoomworld","zoom-world-mini.png",n.add(0,t.h*4+5),t);this._addButton("zoomout","zoom-minus-mini.png",n.add(0,t.h*5+5),t);return this.div},_addButton:function(e,t,n,r){var i=OpenLayers.Util.getImageLocation(t);var s=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+e,n,r,i,"absolute");s.style.cursor="pointer";this.div.appendChild(s);s.action=e;s.className="olButton";this.buttons.push(s);return s},_removeButton:function(e){this.div.removeChild(e);OpenLayers.Util.removeItem(this.buttons,e)},removeButtons:function(){for(var e=this.buttons.length-1;e>=0;--e){this._removeButton(this.buttons[e])}},onButtonClick:function(e){var t=e.buttonElement;switch(t.action){case"panup":this.map.pan(0,-this.getSlideFactor("h"));break;case"pandown":this.map.pan(0,this.getSlideFactor("h"));break;case"panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case"panright":this.map.pan(this.getSlideFactor("w"),0);break;case"zoomin":this.map.zoomIn();break;case"zoomout":this.map.zoomOut();break;case"zoomworld":this.map.zoomToMaxExtent();break}},getSlideFactor:function(e){return this.slideRatio?this.map.getSize()[e]*this.slideRatio:this.slideFactor},CLASS_NAME:"OpenLayers.Control.PanZoom"});OpenLayers.Control.PanZoom.X=4;OpenLayers.Control.PanZoom.Y=4;OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(e,t,n,r){this.url=e;this.size=t||{w:20,h:20};this.offset=n||{x:-(this.size.w/2),y:-(this.size.h/2)};this.calculateOffset=r;var i=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(i)},destroy:function(){this.erase();OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild);this.imageDiv.innerHTML="";this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(e){if(e!=null){this.size=e}this.draw()},setUrl:function(e){if(e!=null){this.url=e}this.draw()},draw:function(e){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute");this.moveTo(e);return this.imageDiv},erase:function(){if(this.imageDiv!=null&&this.imageDiv.parentNode!=null){OpenLayers.Element.remove(this.imageDiv)}},setOpacity:function(e){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,e)},moveTo:function(e){if(e!=null){this.px=e}if(this.imageDiv!=null){if(this.px==null){this.display(false)}else{if(this.calculateOffset){this.offset=this.calculateOffset(this.size)}OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})}}},display:function(e){this.imageDiv.style.display=e?"":"none"},isDrawn:function(){var e=this.imageDiv&&this.imageDiv.parentNode&&this.imageDiv.parentNode.nodeType!=11;return e},CLASS_NAME:"OpenLayers.Icon"});OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(e,t){this.lonlat=e;var n=t?t:OpenLayers.Marker.defaultIcon();if(this.icon==null){this.icon=n}else{this.icon.url=n.url;this.icon.size=n.size;this.icon.offset=n.offset;this.icon.calculateOffset=n.calculateOffset}this.events=new OpenLayers.Events(this,this.icon.imageDiv)},destroy:function(){this.erase();this.map=null;this.events.destroy();this.events=null;if(this.icon!=null){this.icon.destroy();this.icon=null}},draw:function(e){return this.icon.draw(e)},erase:function(){if(this.icon!=null){this.icon.erase()}},moveTo:function(e){if(e!=null&&this.icon!=null){this.icon.moveTo(e)}this.lonlat=this.map.getLonLatFromLayerPx(e)},isDrawn:function(){var e=this.icon&&this.icon.isDrawn();return e},onScreen:function(){var e=false;if(this.map){var t=this.map.getExtent();e=t.containsLonLat(this.lonlat)}return e},inflate:function(e){if(this.icon){this.icon.setSize({w:this.icon.size.w*e,h:this.icon.size.h*e})}},setOpacity:function(e){this.icon.setOpacity(e)},setUrl:function(e){this.icon.setUrl(e)},display:function(e){this.icon.display(e)},CLASS_NAME:"OpenLayers.Marker"});OpenLayers.Marker.defaultIcon=function(){return new OpenLayers.Icon(OpenLayers.Util.getImageLocation("marker.png"),{w:21,h:25},{x:-10.5,y:-25})};OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:false,initialize:function(e){OpenLayers.Util.extend(this,e);this.options=e},destroy:function(){},read:function(e){throw new Error("Read not implemented.")},write:function(e){throw new Error("Write not implemented.")},CLASS_NAME:"OpenLayers.Format"});OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:false,nativeJSON:function(){return!!(window.JSON&&typeof JSON.parse=="function"&&typeof JSON.stringify=="function")}(),read:function(json,filter){var object;if(this.nativeJSON){object=JSON.parse(json,filter)}else try{if(/^[\],:{}\s]*$/.test(json.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){object=eval("("+json+")");if(typeof filter==="function"){function walk(e,t){if(t&&typeof t==="object"){for(var n in t){if(t.hasOwnProperty(n)){t[n]=walk(n,t[n])}}}return filter(e,t)}object=walk("",object)}}}catch(e){}if(this.keepData){this.data=object}return object},write:function(e,t){this.pretty=!!t;var n=null;var r=typeof e;if(this.serialize[r]){try{n=!this.pretty&&this.nativeJSON?JSON.stringify(e):this.serialize[r].apply(this,[e])}catch(i){OpenLayers.Console.error("Trouble serializing: "+i)}}return n},writeIndent:function(){var e=[];if(this.pretty){for(var t=0;t<this.level;++t){e.push(this.indent)}}return e.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(e){if(e==null){return"null"}if(e.constructor==Date){return this.serialize.date.apply(this,[e])}if(e.constructor==Array){return this.serialize.array.apply(this,[e])}var t=["{"];this.level+=1;var n,r,i;var s=false;for(n in e){if(e.hasOwnProperty(n)){r=OpenLayers.Format.JSON.prototype.write.apply(this,[n,this.pretty]);i=OpenLayers.Format.JSON.prototype.write.apply(this,[e[n],this.pretty]);if(r!=null&&i!=null){if(s){t.push(",")}t.push(this.writeNewline(),this.writeIndent(),r,":",this.writeSpace(),i);s=true}}}this.level-=1;t.push(this.writeNewline(),this.writeIndent(),"}");return t.join("")},array:function(e){var t;var n=["["];this.level+=1;for(var r=0,i=e.length;r<i;++r){t=OpenLayers.Format.JSON.prototype.write.apply(this,[e[r],this.pretty]);if(t!=null){if(r>0){n.push(",")}n.push(this.writeNewline(),this.writeIndent(),t)}}this.level-=1;n.push(this.writeNewline(),this.writeIndent(),"]");return n.join("")},string:function(e){var t={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(/["\\\x00-\x1f]/.test(e)){return'"'+e.replace(/([\x00-\x1f\\"])/g,function(e,n){var r=t[n];if(r){return r}r=n.charCodeAt();return"\\u00"+Math.floor(r/16).toString(16)+(r%16).toString(16)})+'"'}return'"'+e+'"'},number:function(e){return isFinite(e)?String(e):"null"},"boolean":function(e){return String(e)},date:function(e){function t(e){return e<10?"0"+e:e}return'"'+e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"});OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(e,t){var n=null;var r=t&&t.mutual;var i,s,o,u,a;var f=[];var l=[e];for(var c=0,h=this.components.length;c<h;++c){s=this.components[c];u=false;for(var p=0;p<l.length;++p){i=s.split(l[p],t);if(i){if(r){o=i[0];for(var d=0,v=o.length;d<v;++d){if(d===0&&f.length){f[f.length-1].addComponent(o[d])}else{f.push(new OpenLayers.Geometry.MultiLineString([o[d]]))}}u=true;i=i[1]}if(i.length){i.unshift(p,1);Array.prototype.splice.apply(l,i);break}}}if(!u){if(f.length){f[f.length-1].addComponent(s.clone())}else{f=[new OpenLayers.Geometry.MultiLineString(s.clone())]}}}if(f&&f.length>1){u=true}else{f=[]}if(l&&l.length>1){a=true}else{l=[]}if(u||a){if(r){n=[f,l]}else{n=l}}return n},splitWith:function(e,t){var n=null;var r=t&&t.mutual;var i,s,o,u,a,f,l;if(e instanceof OpenLayers.Geometry.LineString){l=[];f=[e];for(var c=0,h=this.components.length;c<h;++c){a=false;s=this.components[c];for(var p=0;p<f.length;++p){i=f[p].split(s,t);if(i){if(r){o=i[0];if(o.length){o.unshift(p,1);Array.prototype.splice.apply(f,o);p+=o.length-2}i=i[1];if(i.length===0){i=[s.clone()]}}for(var d=0,v=i.length;d<v;++d){if(d===0&&l.length){l[l.length-1].addComponent(i[d])}else{l.push(new OpenLayers.Geometry.MultiLineString([i[d]]))}}a=true}}if(!a){if(l.length){l[l.length-1].addComponent(s.clone())}else{l=[new OpenLayers.Geometry.MultiLineString([s.clone()])]}}}}else{n=e.split(this)}if(f&&f.length>1){u=true}else{f=[]}if(l&&l.length>1){a=true}else{l=[]}if(u||a){if(r){n=[f,l]}else{n=l}}return n},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"});OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:false,read:function(e,t,n){t=t?t:"FeatureCollection";var r=null;var i=null;if(typeof e=="string"){i=OpenLayers.Format.JSON.prototype.read.apply(this,[e,n])}else{i=e}if(!i){OpenLayers.Console.error("Bad JSON: "+e)}else if(typeof i.type!="string"){OpenLayers.Console.error("Bad GeoJSON - no type: "+e)}else if(this.isValidType(i,t)){switch(t){case"Geometry":try{r=this.parseGeometry(i)}catch(s){OpenLayers.Console.error(s)}break;case"Feature":try{r=this.parseFeature(i);r.type="Feature"}catch(s){OpenLayers.Console.error(s)}break;case"FeatureCollection":r=[];switch(i.type){case"Feature":try{r.push(this.parseFeature(i))}catch(s){r=null;OpenLayers.Console.error(s)}break;case"FeatureCollection":for(var o=0,u=i.features.length;o<u;++o){try{r.push(this.parseFeature(i.features[o]))}catch(s){r=null;OpenLayers.Console.error(s)}}break;default:try{var a=this.parseGeometry(i);r.push(new OpenLayers.Feature.Vector(a))}catch(s){r=null;OpenLayers.Console.error(s)}}break}}return r},isValidType:function(e,t){var n=false;switch(t){case"Geometry":if(OpenLayers.Util.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],e.type)==-1){OpenLayers.Console.error("Unsupported geometry type: "+e.type)}else{n=true}break;case"FeatureCollection":n=true;break;default:if(e.type==t){n=true}else{OpenLayers.Console.error("Cannot convert types from "+e.type+" to "+t)}}return n},parseFeature:function(e){var t,n,r,i;r=e.properties?e.properties:{};i=e.geometry&&e.geometry.bbox||e.bbox;try{n=this.parseGeometry(e.geometry)}catch(s){throw s}t=new OpenLayers.Feature.Vector(n,r);if(i){t.bounds=OpenLayers.Bounds.fromArray(i)}if(e.id){t.fid=e.id}return t},parseGeometry:function(e){if(e==null){return null}var t,n=false;if(e.type=="GeometryCollection"){if(!OpenLayers.Util.isArray(e.geometries)){throw"GeometryCollection must have geometries array: "+e}var r=e.geometries.length;var i=new Array(r);for(var s=0;s<r;++s){i[s]=this.parseGeometry.apply(this,[e.geometries[s]])}t=new OpenLayers.Geometry.Collection(i);n=true}else{if(!OpenLayers.Util.isArray(e.coordinates)){throw"Geometry must have coordinates array: "+e}if(!this.parseCoords[e.type.toLowerCase()]){throw"Unsupported geometry type: "+e.type}try{t=this.parseCoords[e.type.toLowerCase()].apply(this,[e.coordinates])}catch(o){throw o}}if(this.internalProjection&&this.externalProjection&&!n){t.transform(this.externalProjection,this.internalProjection)}return t},parseCoords:{point:function(e){if(this.ignoreExtraDims==false&&e.length!=2){throw"Only 2D points are supported: "+e}return new OpenLayers.Geometry.Point(e[0],e[1])},multipoint:function(e){var t=[];var n=null;for(var r=0,i=e.length;r<i;++r){try{n=this.parseCoords["point"].apply(this,[e[r]])}catch(s){throw s}t.push(n)}return new OpenLayers.Geometry.MultiPoint(t)},linestring:function(e){var t=[];var n=null;for(var r=0,i=e.length;r<i;++r){try{n=this.parseCoords["point"].apply(this,[e[r]])}catch(s){throw s}t.push(n)}return new OpenLayers.Geometry.LineString(t)},multilinestring:function(e){var t=[];var n=null;for(var r=0,i=e.length;r<i;++r){try{n=this.parseCoords["linestring"].apply(this,[e[r]])}catch(s){throw s}t.push(n)}return new OpenLayers.Geometry.MultiLineString(t)},polygon:function(e){var t=[];var n,r;for(var i=0,s=e.length;i<s;++i){try{r=this.parseCoords["linestring"].apply(this,[e[i]])}catch(o){throw o}n=new OpenLayers.Geometry.LinearRing(r.components);t.push(n)}return new OpenLayers.Geometry.Polygon(t)},multipolygon:function(e){var t=[];var n=null;for(var r=0,i=e.length;r<i;++r){try{n=this.parseCoords["polygon"].apply(this,[e[r]])}catch(s){throw s}t.push(n)}return new OpenLayers.Geometry.MultiPolygon(t)},box:function(e){if(e.length!=2){throw"GeoJSON box coordinates must have 2 elements"}return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(e[0][0],e[0][1]),new OpenLayers.Geometry.Point(e[1][0],e[0][1]),new OpenLayers.Geometry.Point(e[1][0],e[1][1]),new OpenLayers.Geometry.Point(e[0][0],e[1][1]),new OpenLayers.Geometry.Point(e[0][0],e[0][1])])])}},write:function(e,t){var n={type:null};if(OpenLayers.Util.isArray(e)){n.type="FeatureCollection";var r=e.length;n.features=new Array(r);for(var i=0;i<r;++i){var s=e[i];if(!s instanceof OpenLayers.Feature.Vector){var o="FeatureCollection only supports collections "+"of features: "+s;throw o}n.features[i]=this.extract.feature.apply(this,[s])}}else if(e.CLASS_NAME.indexOf("OpenLayers.Geometry")==0){n=this.extract.geometry.apply(this,[e])}else if(e instanceof OpenLayers.Feature.Vector){n=this.extract.feature.apply(this,[e]);if(e.layer&&e.layer.projection){n.crs=this.createCRSObject(e)}}return OpenLayers.Format.JSON.prototype.write.apply(this,[n,t])},createCRSObject:function(e){var t=e.layer.projection.toString();var n={};if(t.match(/epsg:/i)){var r=parseInt(t.substring(t.indexOf(":")+1));if(r==4326){n={type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}}else{n={type:"name",properties:{name:"EPSG:"+r}}}}return n},extract:{feature:function(e){var t=this.extract.geometry.apply(this,[e.geometry]);var n={type:"Feature",properties:e.attributes,geometry:t};if(e.fid!=null){n.id=e.fid}return n},geometry:function(e){if(e==null){return null}if(this.internalProjection&&this.externalProjection){e=e.clone();e.transform(this.internalProjection,this.externalProjection)}var t=e.CLASS_NAME.split(".")[2];var n=this.extract[t.toLowerCase()].apply(this,[e]);var r;if(t=="Collection"){r={type:"GeometryCollection",geometries:n}}else{r={type:t,coordinates:n}}return r},point:function(e){return[e.x,e.y]},multipoint:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n){t.push(this.extract.point.apply(this,[e.components[n]]))}return t},linestring:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n){t.push(this.extract.point.apply(this,[e.components[n]]))}return t},multilinestring:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n){t.push(this.extract.linestring.apply(this,[e.components[n]]))}return t},polygon:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n){t.push(this.extract.linestring.apply(this,[e.components[n]]))}return t},multipolygon:function(e){var t=[];for(var n=0,r=e.components.length;n<r;++n){t.push(this.extract.polygon.apply(this,[e.components[n]]))}return t},collection:function(e){var t=e.components.length;var n=new Array(t);for(var r=0;r<t;++r){n[r]=this.extract.geometry.apply(this,[e.components[r]])}return n}},CLASS_NAME:"OpenLayers.Format.GeoJSON"});OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:true,projection:"EPSG:900913"},animationEnabled:true,loadMapObject:function(){if(!this.type){this.type=google.maps.MapTypeId.ROADMAP}var e;var t=OpenLayers.Layer.Google.cache[this.map.id];if(t){e=t.mapObject;++t.count}else{var n=this.map.viewPortDiv;var r=document.createElement("div");r.id=this.map.id+"_GMapContainer";r.style.position="absolute";r.style.width="100%";r.style.height="100%";n.appendChild(r);var i=this.map.getCenter();e=new google.maps.Map(r,{center:i?new google.maps.LatLng(i.lat,i.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||0,mapTypeId:this.type,disableDefaultUI:true,keyboardShortcuts:false,draggable:false,disableDoubleClickZoom:true,scrollwheel:false,streetViewControl:false});t={mapObject:e,count:1};OpenLayers.Layer.Google.cache[this.map.id]=t;this.repositionListener=google.maps.event.addListenerOnce(e,"center_changed",OpenLayers.Function.bind(this.repositionMapElements,this))}this.mapObject=e;this.setGMapVisibility(this.visibility)},repositionMapElements:function(){google.maps.event.trigger(this.mapObject,"resize");var e=this.mapObject.getDiv().firstChild;if(!e||e.childNodes.length<3){this.repositionTimer=window.setTimeout(OpenLayers.Function.bind(this.repositionMapElements,this),250);return false}var t=OpenLayers.Layer.Google.cache[this.map.id];var n=this.map.viewPortDiv;for(var r=e.children.length-1;r>=0;--r){if(e.children[r].style.zIndex==1000001){var i=e.children[r];n.appendChild(i);i.style.zIndex="1100";i.style.bottom="";i.className="olLayerGoogleCopyright olLayerGoogleV3";i.style.display="";t.termsOfUse=i}if(e.children[r].style.zIndex==1e6){var s=e.children[r];n.appendChild(s);s.style.zIndex="1100";s.style.bottom="";s.className="olLayerGooglePoweredBy olLayerGoogleV3 gmnoprint";s.style.display="";t.poweredBy=s}if(e.children[r].style.zIndex==10000002){n.appendChild(e.children[r])}}this.setGMapVisibility(this.visibility)},onMapResize:function(){if(this.visibility){google.maps.event.trigger(this.mapObject,"resize")}else{var e=OpenLayers.Layer.Google.cache[this.map.id];if(!e.resized){var t=this;google.maps.event.addListenerOnce(this.mapObject,"tilesloaded",function(){google.maps.event.trigger(t.mapObject,"resize");t.moveTo(t.map.getCenter(),t.map.getZoom());delete e.resized})}e.resized=true}},setGMapVisibility:function(e){var t=OpenLayers.Layer.Google.cache[this.map.id];if(t){var n=this.type;var r=this.map.layers;var i;for(var s=r.length-1;s>=0;--s){i=r[s];if(i instanceof OpenLayers.Layer.Google&&i.visibility===true&&i.inRange===true){n=i.type;e=true;break}}var o=this.mapObject.getDiv();if(e===true){this.mapObject.setMapTypeId(n);o.style.left="";if(t.termsOfUse&&t.termsOfUse.style){t.termsOfUse.style.left="";t.termsOfUse.style.display="";t.poweredBy.style.display=""}t.displayed=this.id}else{delete t.displayed;o.style.left="-9999px";if(t.termsOfUse&&t.termsOfUse.style){t.termsOfUse.style.display="none";t.termsOfUse.style.left="-9999px";t.poweredBy.style.display="none"}}}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(e){var t=null;if(e!=null){var n=this.sphericalMercator?this.inverseMercator(e.bottom,e.left):new OpenLayers.LonLat(e.bottom,e.left);var r=this.sphericalMercator?this.inverseMercator(e.top,e.right):new OpenLayers.LonLat(e.top,e.right);t=new google.maps.LatLngBounds(new google.maps.LatLng(n.lat,n.lon),new google.maps.LatLng(r.lat,r.lon))}return t},getMapObjectLonLatFromMapObjectPixel:function(e){var t=this.map.getSize();var n=this.getLongitudeFromMapObjectLonLat(this.mapObject.center);var r=this.getLatitudeFromMapObjectLonLat(this.mapObject.center);var i=this.map.getResolution();var s=e.x-t.w/2;var o=e.y-t.h/2;var u=new OpenLayers.LonLat(n+s*i,r-o*i);if(this.wrapDateLine){u=u.wrapDateLine(this.maxExtent)}return this.getMapObjectLonLatFromLonLat(u.lon,u.lat)},getMapObjectPixelFromMapObjectLonLat:function(e){var t=this.getLongitudeFromMapObjectLonLat(e);var n=this.getLatitudeFromMapObjectLonLat(e);var r=this.map.getResolution();var i=this.map.getExtent();return this.getMapObjectPixelFromXY(1/r*(t-i.left),1/r*(i.top-n))},setMapObjectCenter:function(e,t){if(this.animationEnabled===false&&t!=this.mapObject.zoom){var n=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,"idle",function(){n.style.visibility=""});n.style.visibility="hidden"}this.mapObject.setOptions({center:e,zoom:t})},getMapObjectZoomFromMapObjectBounds:function(e){return this.mapObject.getBoundsZoomLevel(e)},getMapObjectLonLatFromLonLat:function(e,t){var n;if(this.sphericalMercator){var r=this.inverseMercator(e,t);n=new google.maps.LatLng(r.lat,r.lon)}else{n=new google.maps.LatLng(t,e)}return n},getMapObjectPixelFromXY:function(e,t){return new google.maps.Point(e,t)},destroy:function(){if(this.repositionListener){google.maps.event.removeListener(this.repositionListener)}if(this.repositionTimer){window.clearTimeout(this.repositionTimer)}OpenLayers.Layer.Google.prototype.destroy.apply(this,arguments)}};OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:false,markers:null,drawn:false,initialize:function(e,t){OpenLayers.Layer.prototype.initialize.apply(this,arguments);this.markers=[]},destroy:function(){this.clearMarkers();this.markers=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(e){if(e!=this.opacity){this.opacity=e;for(var t=0,n=this.markers.length;t<n;t++){this.markers[t].setOpacity(this.opacity)}}},moveTo:function(e,t,n){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(t||!this.drawn){for(var r=0,i=this.markers.length;r<i;r++){this.drawMarker(this.markers[r])}this.drawn=true}},addMarker:function(e){this.markers.push(e);if(this.opacity<1){e.setOpacity(this.opacity)}if(this.map&&this.map.getExtent()){e.map=this.map;this.drawMarker(e)}},removeMarker:function(e){if(this.markers&&this.markers.length){OpenLayers.Util.removeItem(this.markers,e);e.erase()}},clearMarkers:function(){if(this.markers!=null){while(this.markers.length>0){this.removeMarker(this.markers[0])}}},drawMarker:function(e){var t=this.map.getLayerPxFromLonLat(e.lonlat);if(t==null){e.display(false)}else{if(!e.isDrawn()){var n=e.draw(t);this.div.appendChild(n)}else if(e.icon){e.icon.moveTo(t)}}},getDataExtent:function(){var e=null;if(this.markers&&this.markers.length>0){var e=new OpenLayers.Bounds;for(var t=0,n=this.markers.length;t<n;t++){var r=this.markers[t];e.extend(r.lonlat)}}return e},CLASS_NAME:"OpenLayers.Layer.Markers"});OpenLayers.Util.OSM={};OpenLayers.Util.OSM.MISSING_TILE_URL="http://www.openstreetmap.org/openlayers/img/404.png";OpenLayers.Util.OSM.originalOnImageLoadError=OpenLayers.Util.onImageLoadError;OpenLayers.Util.onImageLoadError=function(){if(this.src.match(/^http:\/\/[abc]\.[a-z]+\.openstreetmap\.org\//)){this.src=OpenLayers.Util.OSM.MISSING_TILE_URL}else if(this.src.match(/^http:\/\/[def]\.tah\.openstreetmap\.org\//)){}else{OpenLayers.Util.OSM.originalOnImageLoadError}};OpenLayers.Layer.OSM.Mapnik=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(e,t){var n=["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"];t=OpenLayers.Util.extend({numZoomLevels:19,buffer:0,transitionEffect:"resize"},t);var r=[e,n,t];OpenLayers.Layer.OSM.prototype.initialize.apply(this,r)},CLASS_NAME:"OpenLayers.Layer.OSM.Mapnik"});OpenLayers.Layer.OSM.Osmarender=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(e,t){var n=["http://a.tah.openstreetmap.org/Tiles/tile/${z}/${x}/${y}.png","http://b.tah.openstreetmap.org/Tiles/tile/${z}/${x}/${y}.png","http://c.tah.openstreetmap.org/Tiles/tile/${z}/${x}/${y}.png"];t=OpenLayers.Util.extend({numZoomLevels:18,buffer:0,transitionEffect:"resize"},t);var r=[e,n,t];OpenLayers.Layer.OSM.prototype.initialize.apply(this,r)},CLASS_NAME:"OpenLayers.Layer.OSM.Osmarender"});OpenLayers.Layer.OSM.CycleMap=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(e,t){var n=["http://a.tile.opencyclemap.org/cycle/${z}/${x}/${y}.png","http://b.tile.opencyclemap.org/cycle/${z}/${x}/${y}.png","http://c.tile.opencyclemap.org/cycle/${z}/${x}/${y}.png"];t=OpenLayers.Util.extend({numZoomLevels:19,buffer:0,transitionEffect:"resize"},t);var r=[e,n,t];OpenLayers.Layer.OSM.prototype.initialize.apply(this,r)},CLASS_NAME:"OpenLayers.Layer.OSM.CycleMap"});OpenLayers.Layer.OSM.TransportMap=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(e,t){var n=["http://a.tile2.opencyclemap.org/transport/${z}/${x}/${y}.png","http://b.tile2.opencyclemap.org/transport/${z}/${x}/${y}.png","http://c.tile2.opencyclemap.org/transport/${z}/${x}/${y}.png"];t=OpenLayers.Util.extend({numZoomLevels:19,buffer:0,transitionEffect:"resize"},t);var r=[e,n,t];OpenLayers.Layer.OSM.prototype.initialize.apply(this,r)},CLASS_NAME:"OpenLayers.Layer.OSM.TransportMap"});window.Utils={getEvent:function(e){switch(e){case"hover":return"mouseover mouseout";break;case"click":return"click";break;default:return null}},getUsedImageType:function(){return"png"},preLoadLayerImages:function(e){for(var t in e){var n=new Image;n.src=e[t]}},merge:function(e,t){for(var n in t){for(var r in e){if(n===r){e[r]=t[n]}else{e[n]=t[n]}}}return e},getElementDimensions:function(e,t){var n;n=oxMap.Utils.merge({w:e.offsetWidth,h:e.offsetHeight},oxMap.GMap.Util.getElementPosition(e));if(t){return n[t]}return n},delObject:function(e,t){try{if(t){delete t[e]}else{delete window[e]}}catch(n){if(t){t[e]=undefined}else{window[e]=undefined}}}};window.OSM={configuration:{wms:"OSM",type:"Mapnik",mapID:"oxMap-area",zoomWheelEnable:true,mapMarkerEvent:"click"},osmOptions:{controls:[new OpenLayers.Control.Attribution],projection:new OpenLayers.Projection("EPSG:4326"),units:"degrees",allOverlays:true,theme:configuration.cssPath?configuration.cssPath:null},map:null,wmsLayer:null,wms:{OSM:{Osmarender:new OpenLayers.Layer.OSM.Osmarender,Mapnik:new OpenLayers.Layer.OSM.Mapnik,ROADMAP:new OpenLayers.Layer.Google("Google Streets",{numZoomLevels:20})}},tt:null,Render:function(){var e=oxMap.OSM,t=e.configuration,n,r,i=[],s;t=oxMap.Utils.merge(e.configuration,oxMap.cfg);if(t.imagePath){OpenLayers.ImgPath=t.imagePath}n=t.type.split(",");r=n.length;if(!n||r<1){new Error("wms",t.wms+" "+t.type,true);return false}e.osmOptions.controls=e.osmOptions.controls.concat(new oxMap.OSM.Controls(t.mapControls.split(",")));for(var o=0;o<r;o+=1){i.push(e.wms[t.wms][n[o]])}oxMap.OSM.map=new OpenLayers.Map(t.mapID,e.osmOptions);oxMap.OSM.map.addLayers(i);oxMap.OSM.map.setCenter(oxMap.OSM.LonLat([t.center.lon,t.center.lat]),t.startLevel);if(t.customMap&&t.customMap.bounds){oxMap.OSM.map.setOptions(oxMap.Utils.merge(oxMap.OSM.map.options,{restrictedExtent:oxMap.OSM.Util.createBoundObject(t.customMap.bounds,"WGS84")}))}oxMap.OSM.map.events.on({zoomend:function(){if(oxMap.OSM.tt){oxMap.OSM.tt.parentNode.removeChild(oxMap.OSM.tt);oxMap.OSM.tt=null}if(t.sector){if(oxMap.OSM.map.getZoom()<=t.sector.onZoomLevel){oxMap.OSM.Sector.setup()}else{oxMap.OSM.Sector.clearSector()}}}});oxMap.OSM.configuration.size=oxMap.OSM.map.getSize();oxMap.OSM.wmsLayer=i;oxMap.data=rawdata||function(){new Error("data",null,true)}()},Controls:function(e){var t,n=e.length,r=[],i,s;for(t=0;t<n;t+=1){if(e[t]==="Navigation"){s=oxMap.OSM.configuration.zoomWheelEnable?{type:OpenLayers.Control.TYPE_TOGGLE,defaultDblClick:function(e){return},zoomWheelEnabled:true,mouseWheelOptions:{cumulative:false,interval:210}}:{defaultDblClick:function(e){return},zoomWheelEnabled:false};i=new OpenLayers.Control.Navigation(s)}else{i=new OpenLayers.Control[e[t]]}r.push(i)}return r},LonLat:function(e){if(e.length===2){return(new OpenLayers.LonLat(e[0],e[1])).transform(oxMap.OSM.Util.transformer.WGS84,oxMap.OSM.Util.transformer.map())}return false},Util:{transformer:{"null":null,WGS84:new OpenLayers.Projection("EPSG:4326"),OSM:new OpenLayers.Projection("EPSG:4326"),GMap:new OpenLayers.Projection("EPSG:900913"),map:function(){return oxMap.OSM.map.getProjectionObject()}},createIcon:function(e){var t=e[0],n=new OpenLayers.Size(e[1],e[2]),r=new OpenLayers.Pixel(e[3],e[4]);return new OpenLayers.Icon(t,n,r)},createBoundObject:function(e,t){var n=e.w,r=e.s,i=e.e,s=e.n,o=this,e=new OpenLayers.Bounds;e.extend(new OpenLayers.LonLat(n,r));e.extend(new OpenLayers.LonLat(i,s));if(t){e.transform(o.transformer[t],o.transformer.map())}return e},getCenter:function(){if(arguments.length!==4){return false}for(var e=0,t=arguments.length;e<t;e+=1){arguments[e]=arguments[e]*1}var n=arguments[0]+(arguments[2]-arguments[0])/2,r=arguments[1]+(arguments[3]-arguments[1])/2;return oxMap.OSM.LonLat([n,r])}}};window.CDmap=function(e){var t=oxMap.OSM.CDmap,n={type:"Image"},r=oxMap.Utils.getUsedImageType(),i=0,s;t.customMapLayer=function(){var e=t.customZoomLevel[0]?n[r][0]:null;return new OpenLayers.Layer.Image("customMapLayer",e,oxMap.OSM.Util.createBoundObject(n.bounds,"WGS84"),new OpenLayers.Size(n.size.w,n.size.h),{isBaseLayer:false,opacity:1,displayOutsideMaxExtent:false,alwaysInRange:true})};t.mapControl=function(){oxMap.OSM.map.events.on({zoomend:t.customZoomControl})};t.customZoomControl=function(){var e=this.getZoom();if(e>=t.zoomLevel[i]){i+=1}else{i-=1}if(i>=0&&i<=s){if(t.customZoomLevel[i]){oxMap.OSM.wmsLayer[0].setVisibility(false);t.customMapLayer.setUrl(n[r][i])}else{oxMap.OSM.wmsLayer[0].setVisibility(true);t.customMapLayer.setUrl(null)}}else if(i>s){oxMap.OSM.map.zoomTo(t.zoomLevel[s]);i=s}else{oxMap.OSM.map.zoomTo(t.zoomLevel[0]);i=0}};t.zoomLevel=[];t.customZoomLevel=[];t.setup=function(){var e,o,u;if(!oxMap.cfg.customMap){new Error("custom",null,oxMap.cfg.error);return false}n=oxMap.Utils.merge(n,oxMap.cfg.customMap);if(n.imageType&&n.imageType==="png"){r="png"}oxMap.Utils.preLoadLayerImages(n[r]);u=oxMap.cfg.startLevel;for(e=0,o=oxMap.cfg.numZoomLevels;e<o;e+=1){t.zoomLevel[e]=u+e;t.customZoomLevel[e]=false}s=t.zoomLevel.length;for(e=0,o=s;e<o;e+=1){if(t.zoomLevel[e]==n.startLevel){i=e}}for(e=i,o=i+n.numZoomLevels;e<o;e+=1){t.customZoomLevel[e]=true}i=0;t.mapControl();t.customMapLayer=t.customMapLayer();oxMap.OSM.wmsLayer[0].setVisibility(false);oxMap.OSM.map.addLayer(t.customMapLayer)}()};window.Marker=function(e){var e=oxMap.data,t,n,r,i,s,o=null,u=null,a=[],f=oxMap.OSM.Marker;f.setMarkerByCategory=function(e){for(var s in e){u=e[s];if(!u.data){continue}t=new OpenLayers.Layer.Markers(s);if(u.icon){i=oxMap.OSM.Util.createIcon(u.icon)}for(var o in u.data){var l=u.data[o],c=i.clone();r=oxMap.OSM.LonLat(l.coors);n=new OpenLayers.Marker(r,c);n.name=o;n.category=s;if(l.url){if(l.target){n.urlTarget=l.target}n.goToUrl=l.url;a.push(n)}c.imageDiv.getElementsByTagName("img")[0].setAttribute("class","oxMap-tooltip-icon");c.imageDiv.setAttribute("class","oxMap-tooltip");c.imageDiv.setAttribute("data-catID",s);c.imageDiv.setAttribute("data-name",o);t.addMarker(n)}oxMap.OSM.markerList.push(t)}oxMap.OSM.map.addLayers(oxMap.OSM.markerList);if(a.length>0){f.setSpecialUrl(a)}};f.setSpecialUrl=function(e){function s(e){var n=e.icon.imageDiv.getElementsByTagName("img")[0];e.icon.imageDiv.innerHTMl="";i=t.cloneNode(true);i.setAttribute("href",e.goToUrl);if(e.urlTarget){i.setAttribute("target",e.urlTarget)}i.appendChild(n);e.icon.imageDiv.appendChild(i)}var t=document.createElement("a"),n,r,i;t.setAttribute("class","oxMap-markerLink");if(e.length){for(r=0,n=e.length;r<n;r+=1){s(e[r])}}else{s(e)}return true};f.setup=function(){oxMap.OSM.markerList=[];OpenLayers.Marker.prototype.name="";OpenLayers.Marker.prototype.category="";OpenLayers.Marker.prototype.goToUrl=null;OpenLayers.Marker.prototype.urlTarget=null;f.setMarkerByCategory(e)}()};window.Tooltip=function(e){function f(e,t,n,r,i){var s=e+i+n;return(s<o[r]?t+i:t-n)+"px"}var t=null,n=null,r,i,s,o=oxMap.OSM.configuration.size,u=oxMap.OSM.configuration.mapMarkerEvent,a=oxMap.OSM.Tooltip;a.show=function(e,r,i,s){var o=document.createElement("div"),u=r.parentNode,a=r.getAttribute("data-name"),l=r.getAttribute("data-catID"),c=oxMap.data[l]["data"][a];o.setAttribute("class","oxTextLayer");t=oxMap.OSM.tt;if(t){t.parentNode.removeChild(t);oxMap.OSM.tt=t=null;n.style.zIndex=n.getAttribute("data-z");if(e.type==="mouseout"||n.id==u.id){return true}return true}if(c.desc){oxMap.OSM.tt=t=o;n=u;o.innerHTML=c.desc;o.style.visibility="hidden";u.setAttribute("data-z",u.style.zIndex);u.style.zIndex=1e5;u.appendChild(o);o.style.left=f(s.x,i.x,o.offsetWidth,"w",i.offsetX);o.style.top=f(s.y,i.y,o.offsetHeight,"h",i.offsetY);o.style.visibility="visible"}};a.setup=function(){if(!u){new Error("event",null,oxMap.cfg.error);u="click"}i=oxMap.Utils.getEvent(u).split(/\s/);r=i[0];if(r==="click"){s=oxMap.OSM.map.div.getElementsByTagName("a");for(var e=0,t=s.length;e<t;e+=1){var n=s[e].getAttribute("class");if(n){if(n.match(/oxMap-markerLink/)){s[e].removeAttribute("href")}}}}for(var e=0,t=i.length;e<t;e+=1){oxMap.OSM.map.events.register(i[e],oxMap.OSM.map,function(e){e=e||window.event;var t=e.target||e.srcElement,n=t.parentNode,r=n.getAttribute("class");if(r&&!r.match(/oxMap-tooltip/)){n=n.parentNode}if(t.nodeName.toUpperCase()==="IMG"&&t.getAttribute("class").match(/oxMap-tooltip-icon/)){a.show(e,n,{x:n.offsetLeft,y:n.offsetTop,offsetX:t.offsetWidth,offsetY:t.offsetHeight},this.events.getMousePosition(e))}else{return false}})}}()};window.Filter=function(){function r(e){var t,r=n.length,i=0;for(;r--;){if(n[r].name===e&&!n[r].checked){return false}}return true}function i(e,t,n){var r=e.length,i;for(;r--;){for(i=t.marker.length;i--;){if(e[r]["name"]===t.marker[i]){e[r]["icon"]["imageDiv"].style.display=n?"block":"none"}}}}var e=oxMap.OSM.Filter,t={wrapper:"oxMap-filter-module",items:"oxMap-filter-item",getDataByAjax:false},n=function(){var e=document.getElementById(t.wrapper);return e.getElementsByTagName("input")}();e.filterStack=[];e.sortMarkerByCategory=function(e){var t=[],n=e.length,r;for(;n--;){r=e[n].split(/:/);if(t.length===0){t.push({cat:r[0],marker:[r[1]]});continue}for(var i=0;i<t.length;i+=1){if(t.length<0||t[i]["cat"]!==r[0]){t.push({cat:r[0],marker:[]})}t[i]["marker"].push(r[1])}}return t};e.filterOnMap=function(t){var n=t.checked?true:false,r=oxMap.OSM.map.getLayersByName(t.name)[0],s,o,u,a;r.setVisibility(n);if(r.oxType&&r.oxType==="route"){s=e.sortMarkerByCategory(r.oxMarkerList);o=s.length;for(;o--;){r=oxMap.OSM.map.getLayersByName(s[o]["cat"]);i(r[0]["markers"],s[o],n)}}};e.getDataByAjax=function(){};e.setup=function(){t=oxMap.Utils.merge(t,oxMap.OSM.configuration.filter);var n=document.getElementById(t.wrapper),r=t.items,i;if(!n){new Error("filter",null,true);return false}i=n.getElementsByTagName("input");for(var s=0,o=i.length;s<o;s+=1){var u=i[s].getAttribute("class");if(u.match(new RegExp(r))){e.filterOnMap(i[s]);e.filterStack.push(i[s])}}n.onchange=function(t){t=t||window.event;var n=t.target||t.srcElement;e.filterOnMap(n)}}()};window.Route=function(){var e=oxMap.OSM.Route,t={defaultStyle:{strokeWidth:1,strokeColor:"#000"}};e.createRoute=function(){var e=t.data.features,n=e.length,r,i,s,o,u,a=[];for(;n--;){i=[];s=e[n]["geometry"]["coordinates"];o=e[n]["properties"]["style"];r=new OpenLayers.Layer.Vector(e[n]["properties"]["name"]);for(var f=0,l=s.length;f<l;f+=1){u=oxMap.OSM.LonLat(s[f]);u=new OpenLayers.Geometry.Point(u.lon,u.lat);i.push(u)}r.oxType="route";r.oxMarkerList=e[n]["properties"]["markerList"];r.addFeatures([new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(i),null,{strokeWidth:o["strokeWidth"]?o["strokeWidth"]:t.defaultStyle.strokeWidth,strokeColor:o["strokeColor"]?o["strokeColor"]:t.defaultStyle.strokeColor})]);a.push(r)}oxMap.OSM.map.addLayers(a)};e.setup=function(){if(!oxMap.OSM.configuration.route){new Error("config","OSM.Route",true);return false}if(!oxMap.OSM.configuration.route.data){new Error("route",null,true);return false}OpenLayers.Layer.prototype.oxType;OpenLayers.Layer.prototype.oxMarkerList;t=oxMap.Utils.merge(t,oxMap.OSM.configuration.route);e.createRoute()}()};window.oxMap={cfg:{language:"en",wms:null,modules:null,error:false},wms:["OSM","GMap"],addModule:function(){var e,t=this;for(var n=0,r=arguments.length;n<r;n+=1){e=arguments[n];oxMap[t.wms][e]=window[e];oxMap[t.wms][e]["scope"]=oxMap[t.wms];oxMap.Utils.delObject(e)}return true},runModule:function(e,t){oxMap[this.wms][e].call(t);return true},checkWms:function(){var e=false;for(var t=0,n=oxMap.wms.length;t<n;t+=1){e=oxMap.wms[t]===oxMap.cfg.wms?true:e}if(!e){new Error("wms",oxMap.cfg.wms,oxMap.cfg.error);return false}oxMap.wms=oxMap.cfg.wms;oxMap.Utils.delObject("wms",oxMap.cfg);return true},getWms:function(){return this.wms},initModules:function(){var e,t=oxMap.getWms();oxMap[t]=window[t];oxMap.Utils.delObject("wms");oxMap.runModule("Render");for(var n=0,r=oxMap.cfg.modules.length;n<r;n+=1){e=oxMap.cfg.modules[n].split(".");if(e[0]!==t){new Error("module",oxMap.cfg.modules[n],oxMap.cfg.error);continue}if(e[1]==="Base"){oxMap.addModule.apply(this,["Marker","Tooltip"]);oxMap.runModule("Marker");oxMap.runModule("Tooltip")}else{if(!window[e[1]]){new Error("file",t+"."+e[1],oxMap.cfg.error);continue}oxMap.addModule.apply(this,[e[1]]);oxMap.runModule(e[1]);oxMap.Utils.delObject(e[1])}}},setup:function(){oxMap.Utils=Utils;oxMap.Utils.delObject("Utils");oxMap.Utils.merge(oxMap.cfg,this);oxMap.cfg.modules=oxMap.cfg.modules.split(",");for(var e=0,t=oxMap.cfg.modules.length;e<t;e+=1){if(oxMap.cfg.modules[e]==="Error"){oxMap.cfg.error=true;oxMap.cfg.modules.splice(e,1);break}}if(oxMap.checkWms()){oxMap.initModules()}}}